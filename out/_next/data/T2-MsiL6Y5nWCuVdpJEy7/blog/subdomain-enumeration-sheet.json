{"pageProps":{"post":{"path":"blog/subdomain-enumeration-sheet","title":"Subdomain enumeration cheatsheet for pentesters","subtitle":"find everything *.target.tld has to offer","published":true,"datePublished":1631383870315,"tags":["ctf","subdomain","web","enumeration","cheatsheet","hacking"],"description":"Subdomain enumeration cheatsheet for pentesters","canonicalUrl":"https://dev.lwlx.xyz/blog/subdomain-enumeration-sheet","author":"lwlx","authorPhoto":"/profile","authorTwitter":"0x0000005","bannerPhoto":"/default","thumbnailPhoto":"/default.jpg","content":"\n\n# **Subdomains Enumeration**\n\n## **Summary**\n\n- Enumerate Subdomains\n    - Subbrute\n    - KnockPy\n    - GoogleDorks\n    - EyeWitness\n    - Sublist3r\n    - Subfinder\n    - Findomain\n    - Aquatone\n    - AltDNS\n    - MassDNS\n    - Nmap\n\n## **Enumerate all subdomains (scope is *.domain.tld)**\n\n### **Using Subbrute**\n\n`git clone https://github.com/TheRook/subbrute\npython subbrute.py domain.example.com`\n\n### **Using KnockPy with Daniel Miessler’s SecLists for subdomain \"/Discover/DNS\"**\n\n`git clone https://github.com/guelfoweb/knock\ngit clone https://github.com/danielmiessler/SecLists.git\nknockpy domain.com -w subdomains-top1mil-110000.txt`\n\nUsing EyeWitness and Nmap scans from the KnockPy and enumall scans\n\n`git clone https://github.com/ChrisTruncer/EyeWitness.git\n./setup/setup.sh\n./EyeWitness.py -f filename -t optionaltimeout --open (Optional)\n./EyeWitness -f urls.txt --web\n./EyeWitness -x urls.xml -t 8 --headless\n./EyeWitness -f rdp.txt --rdp`\n\n### **Using Google Dorks and Google Transparency Report**\n\nYou need to include subdomains ;) [https://www.google.com/transparencyreport/https/ct/?hl=en-US#domain=[DOMAIN]g&incl_exp=true&incl_sub=true](https://www.google.com/transparencyreport/https/ct/?hl=en-US#domain=%5BDOMAIN%5Dg&incl_exp=true&incl_sub=true)\n\n`site:*.domain.com -www\nsite:domain.com filetype:pdf\nsite:domain.com inurl:'&'\nsite:domain.com inurl:login,register,upload,logout,redirect,redir,goto,admin\nsite:domain.com ext:php,asp,aspx,jsp,jspa,txt,swf\nsite:*.*.domain.com`\n\n### **Using Sublist3r**\n\n`To enumerate subdomains of specific domain and show the results in realtime:\npython sublist3r.py -v -d example.com\n\nTo enumerate subdomains and enable the bruteforce module:\npython sublist3r.py -b -d example.com\n\nTo enumerate subdomains and use specific engines such Google, Yahoo and Virustotal engines\npython sublist3r.py -e google,yahoo,virustotal -d example.com\n\npython sublist3r.py -b -d example.com`\n\n### **Using Subfinder**\n\n`go get github.com/subfinder/subfinder\n./Subfinder/subfinder --set-config PassivetotalUsername='USERNAME',PassivetotalKey='KEY'\n./Subfinder/subfinder --set-config RiddlerEmail=\"EMAIL\",RiddlerPassword=\"PASSWORD\"\n./Subfinder/subfinder --set-config CensysUsername=\"USERNAME\",CensysSecret=\"SECRET\"\n./Subfinder/subfinder --set-config SecurityTrailsKey='KEY'\n./Subfinder/subfinder -d example.com -o /tmp/results_subfinder.txt`\n\n### **Using Findomain**\n\n`$ wget https://github.com/Edu4rdSHL/findomain/releases/latest/download/findomain-linux\n$ chmod +x findomain-linux\n$ findomain_spyse_token=\"YourAccessToken\"\n$ findomain_virustotal_token=\"YourAccessToken\" \n$ findomain_fb_token=\"YourAccessToken\" \n$ ./findomain-linux -t example.com -o`\n\n### **Using Aquatone Go**\n\n`# Subfinder version\n./Subfinder/subfinder -d $1 -r 8.8.8.8,1.1.1.1 -nW -o /tmp/subresult$1\ncat /tmp/subresult$1 | ./Aquatone/aquatone -ports large -out /tmp/aquatone$1\n\n# Amass version\n./Amass/amass -active -brute -o /tmp/hosts.txt -d $1\ncat /tmp/hosts.txt | ./Aquatone/aquatone -ports large -out /tmp/aquatone$1`\n\n### **Using AltDNS**\n\nIt's recommended to use massdns in order to resolve the result of `AltDNS`\n\n`WORDLIST_PERMUTATION=\"./Altdns/words.txt\"\npython2.7 ./Altdns/altdns.py -i /tmp/inputdomains.txt -o /tmp/out.txt -w $WORDLIST_PERMUTATION`\n\nAlternatively you can use [goaltdns](https://github.com/subfinder/goaltdns)\n\n### **Using MassDNS**\n\n`DNS_RESOLVERS=\"./resolvers.txt\"\ncat /tmp/results_subfinder.txt | massdns -r $DNS_RESOLVERS -t A -o S -w /tmp/results_subfinder_resolved.txt`\n\n### **Using Nmap**\n\n`nmap -sn --script hostmap-crtsh host_to_scan.tld`\n"}},"__N_SSG":true}