{"pageProps":{"post":{"path":"blog/htb-not-art-challenge","title":"HTB write up for the Not Art[HARD] challenge","subtitle":"stegonagraphy is easy?","published":true,"datePublished":1643383870315,"tags":["ctf","writeup","hackthebox","NotArt","htb","stego"],"description":"write up for the Not Art[HARD] challenge","canonicalUrl":"https://dev.lwlx.xyz/blog/htb-not-art-challenge","author":"lwlx","authorPhoto":"/profile","authorTwitter":"0x0000005","bannerPhoto":"/htb/notart/htb-not-art","thumbnailPhoto":"/htb/notart/htb-not-art-thumb.jpg","content":"\nThis is my Write Up for the \"Not Art\" Stego challenge from Hack The Box.\n# Not Art\n\nWe Recvied a PNG file called not_art.png\n\n![not_art.png](/htb/notart/not_art.png)\n\nWe already know there is something hidden in this image so lets start with basic stego tools to analyze if we have hidden content.\n\nsteghide & foremost:\n\n```bash\nsteghide info not_art.png \nsteghide: the file format of the file \"not_art.png\" is not supported.\n                                                                                                                                            \n└─$ foremost -i not_art.png                                                                                                             1 ⨯\nProcessing: not_art.png\n```\n\nnothing so lets check further:\n\n```bash\n└─$ strings not_art.png      \nIHDR\nJIDATx\nO2~tt\nkNB(\nB([W\n3\"qV\n!.'!\nBf-#\neG=1w\n&=1{Rl4\n-Tg~\n+,:\nk22s\n(;-A\n3fM!\nLjb&\n=bNB(\nB([O}-;\n>;m];\n9eNB(\nIEND\n```\n\n```bash\n└─$ exiftool not_art.png                                                                                                              127 ⨯\nExifTool Version Number         : 12.39\nFile Name                       : not_art.png\nDirectory                       : .\nFile Size                       : 2.1 KiB\nFile Modification Date/Time     : 2018:06:20 19:04:12+02:00\nFile Access Date/Time           : 2022:01:25 14:00:23+01:00\nFile Inode Change Date/Time     : 2022:01:25 14:00:21+01:00\nFile Permissions                : -rw-rw-r--\nFile Type                       : PNG\nFile Type Extension             : png\nMIME Type                       : image/png\nImage Width                     : 300\nImage Height                    : 300\nBit Depth                       : 8\nColor Type                      : RGB\nCompression                     : Deflate/Inflate\nFilter                          : Adaptive\nInterlace                       : Noninterlaced\nImage Size                      : 300x300\nMegapixels                      : 0.090\n```\n\n```bash\nzsteg -a not_art.png  \nb1,r,lsb,xy         .. file: , OEM-ID \"\\003\\377\", Bytes/sector 3840, sectors/cluster 252, sectors 65280 (volumes <=32 MB), Media descriptor 0xff, sectors/FAT 240, sectors/track 0, FAT (12 bit by descriptor)                                                                          \nb2,b,lsb,xy         .. file: Matlab v4 mat-file (little endian) , numeric, rows 0, columns 0\nb2,b,msb,xy         .. file: Matlab v4 mat-file (little endian) , numeric, rows 0, columns 0\nb6,r,lsb,xy         .. file: AIX core file fulldump\nb1,rgb,lsb,xy,prime .. text: \"lHR&I\\\"Z$\"\nb1,rgb,msb,xy,prime .. text: \"D&IlIK\\\"i\\\"I)6\"\nb3,r,lsb,xy,prime   .. file: MPEG ADTS, AAC, v4 Main, 96 kHz\nb4,g,lsb,xy,prime   .. file: Common Data Format (Version 2.5 or earlier) data\nb4,g,msb,xy,prime   .. file: Common Data Format (Version 2.5 or earlier) data\nb5,g,lsb,xy,prime   .. file: AIX core file\nb8,b,lsb,xy,prime   .. file: Matlab v4 mat-file (little endian) \\300\\300\\377\\377\\377\\300\\300\\300\\300, numeric, rows 3233857728, columns 3233808384, imaginary                                                                                                                           \nb1,g,msb,yx         .. file: dBase III DBT, next free block index 1072693248, block length 64512, 1st item \"\\001\"\nb2,b,lsb,yx         .. file: Matlab v4 mat-file (little endian) \\377\\377\\360, numeric, rows 251658240, columns 65535, imaginary\nb2,b,msb,yx         .. file: Matlab v4 mat-file (little endian) \\377\\377\\017, numeric, rows 4026531840, columns 65535, imaginary\nb5,b,lsb,yx         .. file: Matlab v4 mat-file (little endian) \\377\\377\\377\\377\\377, numeric, rows 0, columns 0\nb5,b,msb,yx         .. file: Matlab v4 mat-file (little endian) \\377\\377\\377\\377\\377, numeric, rows 0, columns 0\nb6,r,lsb,yx         .. file: AIX core file fulldump\nb6,g,lsb,yx         .. file: Matlab v4 mat-file (little endian) \\377\\377\\360, numeric, rows 0, columns 0, imaginary\nb6,g,msb,yx         .. file: Matlab v4 mat-file (little endian) \\377\\377\\017, numeric, rows 0, columns 0, imaginary\nb7,b,lsb,yx         .. file: Matlab v4 mat-file (little endian) @\\201\\002\\004\\010\\020?\\377\\377\\377\\377\\377\\377\\377\\377, numeric, rows 0, columns 0                                                                                                                                      \nb8,b,lsb,yx         .. file: Matlab v4 mat-file (little endian) , numeric, rows 0, columns 0\nb1,rgb,msb,yx,prime .. file: TeX font metric data\nb2,r,msb,yx,prime   .. file: DOS 2.0-3.2 backed up file \\017\\003\nb3,r,lsb,yx,prime   .. file: MPEG ADTS, AAC, v4 Main, 96 kHz\nb4,r,msb,yx,prime   .. file: , Bytes/sector 3840, root entries 15, Media descriptor 0xff, sectors/FAT 255, sectors/track 0, heads 15, FAT (12 bit by descriptor)                                                                                                                        \nb8,b,lsb,yx,prime   .. file: Matlab v4 mat-file (little endian) \\300\\300\\377\\377, numeric, rows 0, columns 4294951104, imaginary\nb3,r,lsb,XY         .. file: AIX core file\nb3,g,lsb,XY         .. file: AIX core file\nb4,r,lsb,XY         .. file: Matlab v4 mat-file (little endian) , numeric, rows 4294967040, columns 65535\nb6,b,lsb,XY         .. file: AIX core file fulldump\nb3,b,lsb,XY,prime   .. file: MPEG ADTS, AAC, v4 Main, 96 kHz, stereo + center\nb4,r,lsb,XY,prime   .. file: Common Data Format (Version 2.5 or earlier) data\nb4,r,msb,XY,prime   .. file: Common Data Format (Version 2.5 or earlier) data\nb4,g,lsb,XY,prime   .. file: Common Data Format (Version 2.5 or earlier) data\nb4,g,msb,XY,prime   .. file: Common Data Format (Version 2.5 or earlier) data\nb8,g,lsb,XY,prime   .. file: Matlab v4 mat-file (little endian) \\300\\300\\377\\377, numeric, rows 4294967295, columns 0, imaginary\nb3,r,lsb,YX         .. file: AIX core file\nb6,g,lsb,YX         .. file: Matlab v4 mat-file (little endian) \\377\\377\\360, numeric, rows 0, columns 0, imaginary\nb6,g,msb,YX         .. file: Matlab v4 mat-file (little endian) \\377\\377\\017, numeric, rows 0, columns 0, imaginary\nb6,b,lsb,YX         .. file: AIX core file fulldump\nb7,g,lsb,YX         .. file: Matlab v4 mat-file (little endian) \\377\\377\\377\\377\\377\\377\\340@\\201\\002\\004\\010\\020 @\\377\\377\\377\\377\\377\\377\\377\\377\\376\\004\\010\\020 @\\201\\002\\004, numeric, rows 0, columns 0                                                                           \nb7,g,msb,YX         .. file: Matlab v4 mat-file (little endian) \\377\\377\\377\\377\\377\\377\\007\\002\\201@ \\020\\010\\004\\002\\377\\377\\377\\377\\377\\377\\377\\377\\177 \\020\\010\\004\\002\\201@ , numeric, rows 0, columns 0                                                                           \nb8,g,lsb,YX         .. file: Matlab v4 mat-file (little endian) , numeric, rows 0, columns 0\nb8,g,msb,YX         .. file: Matlab v4 mat-file (little endian) , numeric, rows 0, columns 0\nb1,rgb,msb,YX,prime .. text: \"-!%&6l2\\t%\"\nb3,b,lsb,YX,prime   .. file: MPEG ADTS, AAC, v4 Main, 96 kHz\nb4,r,lsb,YX,prime   .. file: Common Data Format (Version 2.5 or earlier) data\nb4,r,msb,YX,prime   .. file: Common Data Format (Version 2.5 or earlier) data\nb6,g,lsb,YX,prime   .. file: Matlab v4 mat-file (little endian) \\377\\374\\017\\300, numeric, rows 4043243520, columns 3238002432\nb6,g,msb,YX,prime   .. file: Matlab v4 mat-file (little endian) \\377?\\360\\003, numeric, rows 268369920, columns 67108608\nb2,r,lsb,Xy         .. file: AIX core file\nb4,bgr,msb,Xy       .. file: MPEG ADTS, AAC, v4 Main, 48 kHz, surround + side\nb6,g,lsb,Xy         .. file: AIX core file fulldump\nb6,b,lsb,Xy         .. file: AIX core file fulldump\nb6,bgr,lsb,Xy       .. file: MPEG ADTS, AAC, v4 Main, surround + side\nb7,bgr,lsb,Xy       .. file: MPEG ADTS, layer II, v1, 48 kHz, Monaural\nb1,bgr,lsb,Xy,prime .. text: \"I\\\"Ki$q%)\"\nb3,g,lsb,Xy,prime   .. file: MPEG ADTS, AAC, v4 Main, 96 kHz\nb3,b,lsb,Xy,prime   .. file: MPEG ADTS, AAC, v4 Main, 96 kHz\nb4,r,lsb,Xy,prime   .. file: Common Data Format (Version 2.5 or earlier) data\nb4,r,msb,Xy,prime   .. file: Common Data Format (Version 2.5 or earlier) data\nb4,g,lsb,Xy,prime   .. file: , Bytes/sector 3840, sectors/cluster 255, reserved sectors 4095, FATs 255, root entries 240, sectors 61455 (volumes <=32 MB), Media descriptor 0xff, sectors/FAT 65535, sectors/track 65535, hidden sectors 4042326015, sectors 4278255360 (volumes > 32 MB), dos < 4.0 BootSector (0), FAT (12 bit by descriptor)                                                                                     \nb4,bgr,msb,Xy,prime .. file: MPEG ADTS, AAC, v4 Main, 48 kHz, surround + side\nb6,r,lsb,Xy,prime   .. file: AIX core file\nb6,bgr,lsb,Xy,prime .. file: MPEG ADTS, AAC, v4 Main, surround + side\nb7,bgr,lsb,Xy,prime .. file: MPEG ADTS, layer II, v1, 48 kHz, Monaural\nb4,bgr,msb,yX       .. file: MPEG ADTS, AAC, v4 Main, 48 kHz, surround + side\nb5,r,lsb,yX         .. file: Matlab v4 mat-file (little endian) \\377\\377\\377\\377\\377, numeric, rows 0, columns 0\nb5,r,msb,yX         .. file: Matlab v4 mat-file (little endian) \\377\\377\\377\\377\\377, numeric, rows 0, columns 0\nb6,g,lsb,yX         .. file: AIX core file fulldump\nb6,b,lsb,yX         .. file: AIX core file fulldump\nb6,bgr,lsb,yX       .. file: MPEG ADTS, AAC, v4 Main, surround + side\nb7,r,lsb,yX         .. file: Matlab v4 mat-file (little endian) @\\201\\002\\004\\010\\020?\\377\\377\\377\\377\\377\\377\\377\\377, numeric, rows 0, columns 0                                                                                                                                      \nb7,bgr,lsb,yX       .. file: MPEG ADTS, layer II, v1, 48 kHz, Monaural\nb8,r,lsb,yX         .. file: Matlab v4 mat-file (little endian) , numeric, rows 0, columns 0\nb1,bgr,lsb,yX,prime .. <wbStego size=24795, data=\"\\x99\\\"II$-\\xB7\\x01&%\"..., even=false, enc=\"wbStego 2.x/3.x\", mix=true, controlbyte=\"\\xD8\">\nb3,g,lsb,yX,prime   .. file: MPEG ADTS, AAC, v4 Main, 96 kHz, stereo + center\nb3,b,lsb,yX,prime   .. file: MPEG ADTS, AAC, v4 Main, 96 kHz, stereo + center\nb4,g,lsb,yX,prime   .. file: , Bytes/sector 3840, sectors/cluster 255, reserved sectors 240, root entries 61455, sectors 61455 (volumes <=32 MB), Media descriptor 0xff, sectors/FAT 255, sectors/track 0, heads 15, hidden sectors 4026593295, sectors 4278190080 (volumes > 32 MB), physical drive 0xf0, dos < 4.0 BootSector (0), FAT (12 bit by descriptor)                                                                     \nb4,bgr,msb,yX,prime .. file: MPEG ADTS, AAC, v4 Main, 48 kHz, surround + side\nb5,r,lsb,yX,prime   .. file: Matlab v4 mat-file (little endian) \\377\\300, numeric, rows 4030660608, columns 0, imaginary\nb5,r,msb,yX,prime   .. file: Matlab v4 mat-file (little endian) \\377\\003, numeric, rows 268173312, columns 0, imaginary\nb6,r,lsb,yX,prime   .. file: Matlab v4 mat-file (little endian) \\377\\374, numeric, rows 251658240, columns 255\nb6,r,msb,yX,prime   .. file: Matlab v4 mat-file (little endian) \\377?, numeric, rows 4026531840, columns 255\nb6,bgr,lsb,yX,prime .. file: MPEG ADTS, AAC, v4 Main, surround + side\nb7,bgr,lsb,yX,prime .. file: MPEG ADTS, layer II, v1, 48 kHz, Monaural\nb2,g,lsb,xY         .. file: Matlab v4 mat-file (little endian) \\377\\377\\377\\377\\377, numeric, rows 4294967040, columns 65535, imaginary\nb2,g,msb,xY         .. file: Matlab v4 mat-file (little endian) \\377\\377\\377\\377\\377, numeric, rows 4294967040, columns 65535, imaginary\nb3,r,lsb,xY         .. file: Matlab v4 mat-file (little endian) \\377\\377\\360, numeric, rows 0, columns 0\nb3,r,msb,xY         .. file: Matlab v4 mat-file (little endian) \\377\\377\\017, numeric, rows 0, columns 0\nb3,b,lsb,xY         .. file: AIX core file fulldump\nb6,g,lsb,xY         .. file: Matlab v4 mat-file (little endian) \\377\\377\\377\\377\\377\\377\\377\\377\\377\\377, numeric, rows 0, columns 0, imaginary                                                                                                                                         \nb6,g,msb,xY         .. file: Matlab v4 mat-file (little endian) \\377\\377\\377\\377\\377\\377\\377\\377\\377\\377, numeric, rows 0, columns 0, imaginary                                                                                                                                         \nb7,r,lsb,xY         .. file: Matlab v4 mat-file (little endian) @\\201\\002\\004\\010\\020, numeric, rows 0, columns 0\nb8,r,lsb,xY         .. file: Matlab v4 mat-file (little endian) , numeric, rows 0, columns 0\nb1,r,lsb,xY,prime   .. file: raw G3 (Group 3) FAX, byte-padded\nb6,r,lsb,xY,prime   .. file: Matlab v4 mat-file (little endian) \\377\\374, numeric, rows 0, columns 1056964608, imaginary\nb6,r,msb,xY,prime   .. file: Matlab v4 mat-file (little endian) \\377?, numeric, rows 0, columns 4227858432, imaginary\nb2,r,lsb,Yx         .. file: AIX core file\nb6,g,lsb,Yx         .. file: Matlab v4 mat-file (little endian) \\377\\377\\360, numeric, rows 0, columns 0, imaginary\nb6,g,msb,Yx         .. file: Matlab v4 mat-file (little endian) \\377\\377\\017, numeric, rows 0, columns 0, imaginary\nb6,b,lsb,Yx         .. file: AIX core file fulldump\nb3,b,lsb,Yx,prime   .. file: MPEG ADTS, AAC, v4 Main, 96 kHz\nb4,r,lsb,Yx,prime   .. file: Common Data Format (Version 2.5 or earlier) data\nb4,r,msb,Yx,prime   .. file: Common Data Format (Version 2.5 or earlier) data\nb4,g,lsb,Yx,prime   .. file: Matlab v4 mat-file (little endian) \\360\\377\\377\\017\\377, numeric, rows 255, columns 16715520, imaginary\nb6,r,lsb,Yx,prime   .. file: AIX core file\n[!] possible image block size is 10x10, downscaling may be necessary\n```\n\nso except for zsteg nothing seems to have found anything of interest. having a closer look at zsteg also reveals there seems to be nothing of use.\n\n## hidden in plain sight\n\nSo we have a very special image here, its a spiral of blocks of colors, they also seem to be repeating, maybe there is some conversion going on from rgb → ascii, lets check that.\n\nextracting the color codes yields us a pattern:\n\n```bash\n[(255, 192, 0), (0, 255, 192), (192, 255, 0), (255, 255, 192), (255, 0, 0), ... ]\n```\n\nit seems there are only three possible options per color: 192, 255 or 0. so really we are looking at a base3 encoded data.\n\nif we convert the first few bytes to base3 we get a series of numbers, if we convert those to ascii we get the following: \n\n**Substitute 0, 192, 255 to 0, 1, 2**\n\n**Concatenate the values to get a 3-digits number (BASE 3)**\n\n**Convert the 3 digits number into base 10 number**\n\n```bash\n21 = u\n7 = g\n15 = o\n25 = y\n18 = r\n```\n\nif you have played a few CTF’s you might be able to tell that “ugo” is “HTB” in ROT13, so lets see what happens if we apply a ROT 13 to the whole text after base3 conversion.\n\n```bash\n21 h\n7 t\n15 b\n25 l\n18 e\n19 f\n7 t\n16 c\n8 u\n5 r\n25 l\n12 y\n15 b\n5 r\n14 a\n16 c\n```\n\nWell this seems to be it! here we got our plaintext flag, now we just need to convert it, i guess.\n\nhtbleftcurlybracketuppercaseiunderscorelowercasetuppercaseolowercaseluppercasedunderscorelowercaseyuppercaseolowercaseuunderscoreuppercasetlowerc.....owercaseruppercasetunderscorelowercasenuppercaseolowercaserunderscoreuppercaseplowercaseiuppercaseelowercasetexclamationmarkexclamationmarkrightcurlybracketeof\n\n`HTB{SORRY I DONT PUBLISH FLAGS}`\n\nyay got em!"}},"__N_SSG":true}