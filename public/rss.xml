<?xml version="1.0" encoding="UTF-8"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title><![CDATA[dev.lwlx.xyz]]></title><description><![CDATA[Dev / Sec / Ops ]]></description><link>https://dev.lwlx.xyz</link><image><url>https://dev.lwlx.xyz/icon.png</url><title>dev.lwlx.xyz</title><link>https://dev.lwlx.xyz</link></image><generator>RSS for Node</generator><lastBuildDate>Thu, 29 Oct 2020 15:35:13 GMT</lastBuildDate><atom:link href="https://dev.lwlx.xyz/rss.xml" rel="self" type="application/rss+xml"/><pubDate>Tue, 27 Oct 2020 04:00:00 GMT</pubDate><copyright><![CDATA[2020 Dominik (lwlx) Feger]]></copyright><language><![CDATA[en]]></language><managingEditor><![CDATA[lwlx@lwlx.xyz]]></managingEditor><webMaster><![CDATA[lwlx@lwlx.xyz]]></webMaster><ttl>60</ttl><item><title><![CDATA[Getting consistent Encryption in Node / PHP / Browser and openSSL]]></title><description><![CDATA[<p>I recently was tasked to find a solution for encrypting data in different places and to be able to decrypt them all in a browser during runtime.</p>
<p>Surprisingly, it was much harder than expected since there was so little documentation around this online. What was available were a few code only examples, so I was forced to do R&amp;D and just try all implementations and compare the in- &amp; outputs</p>
<p>Given the lack of a decent out-of-the-box solution, I worry that many developers are settling for easy to use, insecure, solutions which place limits on the security and flexibility of your project. Security should be easy to use and accessible.</p>
<blockquote>
  <p>Clone the repo here to get started with this setup: <a href="https://gist.github.com/Lawlez/88e04e3541cc0608c953a118b86bfc1a">https://gist.github.com/Lawlez/88e04e3541cc0608c953a118b86bfc1a</a></p>
</blockquote>
<p>Let's quickly run through each implementation:</p>
<h3 id="usingnodejscryptomodule">Using Node JS Crypto module</h3>
<p>Node Provides a nice <code>crypto</code>  implementation. It's documentation is rather sparse, but this is what i ended up with by using:</p>
<ul>
<li><code>crypto.randomBytes()</code></li>
<li><code>crypto.createCipheriv()</code></li>
<li><code>crypto.createDecipheriv()</code></li>
</ul>
<pre><code class="javascript language-javascript">const crypto = require('crypto')

/**********************************************************************
*
*        DECRYPTION MODULE FOR USE INSIDE NODE.JS                     *
*
***********************************************************************/

const encryption = (data = 'TestString {} Héllöüä') =&gt; {

    const secretPhrase = crypto.randomBytes(16).toString('hex')
    const salt = crypto.randomBytes(128 / 8).toString('hex')
    //here we generate the key and give it back as a string, we use 100k iterations
    //as suggested in best practices
    //We can use the key multiple times to encrypt multiple things(-30GB), we just cant use
    //the same initialization vector twice
    //the key for aes-256 needs to be 256 bits which equals 32 bytes or 32 characters
    const configKey = crypto.pbkdf2Sync(secretPhrase, salt, 100000, 32, 'sha256').toString('hex').substr(0, 32)
    //create unique IV for each encryption, the key can be reused. IV needs to always be 16 bytes
    const IV = crypto.randomBytes(16)

    //create ciphers for each encryption using the shared key and the unuique IV
    const projectConfigCipher = crypto.createCipheriv('aes-256-cbc', configKey, IV.toString('hex').substr(0,16)

    //encripting the storage location using the prepared cipher
    const encrypted = Buffer.concat([configStorageCipher.update(
        'STORAGE', 'utf8'
    ), configStorageCipher.final()]).toString('hex')

    return encrypted

}
</code></pre>
<h3 id="usingbrowserifyaessnodecryptolikeimplementationinsidethebrowser">Using browserify-aes's node crypto like implementation inside the Browser</h3>
<p>Inside the browser, we cannot use Nodes.js built-in modules. Using <code>browserify-aes</code> we can use a node-like crypto implementation, which uses the same syntax as the node implementation. In my use case, I only need to decipher in the browser, this means I don’t have to worry about a true random key generation or ciphering.</p>
<pre><code class="js language-js">import crypto from 'browserify-aes'

/**********************************************************************
*
*        DECRYPTION MODULE FOR USE IN BROWSER DURING RUNTIME          *
*
***********************************************************************/
const decrypt = hash =&gt; {
    const hash = hash.data
    //get IV from input, make sure its no longer than 16 bytes
    const IV = hash.IV

    //ein neuer cipher wird vorbereitet, mittels aes256, unserem 256 bit KEY und dem config IV
    const decipher = crypto.createDecipheriv(
        'aes256',
        process.env.APP_CONFIG_KEY.substr(0, 32),
       IV,
    )

    //der hash wird nun decrypted mittels dem zuvor erstellten cipher
    const decrypted = Buffer.concat([decipher.update(
         Buffer.from(hash, 'hex'),
     ), decipher.final()]).toString()

   return JSON.parse(decrypted)
}
</code></pre>
<h3 id="encryptiondecryptionmoduleforphp7usingopenssl">ENCRYPTION &amp; DECRYPTION MODULE FOR PHP7+ USING OPENSSL</h3>
<p>In PHP 7 we make use of the <code>openssl_encrypt</code> implementation to encrypt an utf8 string and finally encode it with <code>base64_encode</code>.
For decryption we also make use of the official openssl implementation <code>openssl_decrypt</code>, before decrypting we need to decode using <code>base64_decode</code>.</p>
<pre><code class="php language-php">/**********************************************************************
*
*        ENCRYPTION &amp; DECRYPTION MODULE FOR PHP7+ USING OPENSSL       *
*
***********************************************************************/

class AESEncryption {

    //key length should be 256 bits for aes 256 this means we use a string with 32 bytes
    public static $key = "5f08e0ec585393a8e2ca8f0a1a0ae752";

     //iv length should be always be 128 bit / 16 bytes
    public static $iv = "05d387e7f773035a";

     // The AES uses a block size of sixteen octets (128 bits)
    public static $Method = 'AES-256-CBC';

    /**
      * use the AES to encrypt plaintext data and return a base 64 string
     *
     * $key
     */
    public static function encrypt($cleartext,$key = ''){

        $key = empty($key) ? self::$key : $key;

        $encrypted = openssl_encrypt($cleartext, self::$Method, $key, OPENSSL_RAW_DATA, self::$iv);

        return base64_encode($encrypted);

    }

    /**
      * use the AES to decrypt a base 64 string into plaintext
     *
     * $key
     */
    public static function decrypt($encrypted,$key = ''){

        $key = empty($key) ? self::$key : $key;

        $encrypted = base64_decode($encrypted);

        $decrypted = openssl_decrypt($encrypted, self::$Method, $key, OPENSSL_RAW_DATA, self::$iv);

        return trim($decrypted);
    }
}
</code></pre>
<h3 id="usingopensslforuseincli">Using openssl for use in CLI</h3>
<p>Inside of a Command Line Interface we use <code>openssl</code> do en- or decrypt data.</p>
<p>for node/browserify to be able to decrypt it we need to add the <code>-nosalt</code> option, which disables salting the data.</p>
<pre><code class="bash language-bash">#########################################################################################
#                                                                                       #
#               ENCRYPTION FOR CLI IN / MACOS / LINUX / WINDOWS                         #
#                                                                                       #
#########################################################################################

#encrypt with key &amp; IV but no salt
cat config.json | openssl aes-256-cbc -iv $(cat iv)  -K $(cat key) -A -nosalt -base64

#decrypt with key IV and base64
echo "encryptedString" | openssl aes-256-cbc -d -iv $(cat iv)  -K $(cat key) -base64 -A
</code></pre>
<h2 id="finalsolution">final solution</h2>
<p>…</p>]]></description><link>https://dev.lwlx.xyz/blog/blog/consistent-x-device-encryption</link><guid isPermaLink="true">https://dev.lwlx.xyz/blog/blog/consistent-x-device-encryption</guid><category><![CDATA[encryption]]></category><category><![CDATA[decryption]]></category><category><![CDATA[openssl]]></category><category><![CDATA[nodejs]]></category><category><![CDATA[php]]></category><dc:creator><![CDATA[lwlx]]></dc:creator><pubDate>Thu, 29 Oct 2020 10:26:43 GMT</pubDate></item><item><title><![CDATA[A Collection of useful Security and DevOps tools.]]></title><description><![CDATA[<h1 id="sicktools">sickTools</h1>
<p>a collection of useful, special, or just cool tools to use and try to get more done in less time.</p>
<ul>
<li><code>- [ ] ([tool name](&lt;link&gt;)|tested|new|deprecated|active): &lt;description&gt;</code></li>
</ul>
<h2 id="appsectools">AppSec Tools</h2>
<ul>
<li>[x] <a href="https://github.com/CISOfy/lynis">lynis</a> | active |: Security auditing tool for Linux, macOS, and UNIX-based systems</li>
<li>[ ] <a href="https://github.com/nomasters/killcord">killcord</a> | new |: a censorship resistant deadman's switch</li>
<li>[x] <a href="https://github.com/zaproxy/zaproxy">OWASP ZAP</a> | active |: autodetect security vulnerabilities in your web applications while developing and testing your applications</li>
<li>[ ] <a href="https://github.com/Cisco-Talos/clamav-faq">ClamAV</a> | new |: open source antivirus engine for detecting trojans, viruses, malware &amp; other malicious threats.</li>
</ul>
<h2 id="automationtools">Automation Tools</h2>
<ul>
<li>[ ]</li>
</ul>
<h2 id="developertools">developer Tools</h2>
<ul>
<li>[x] <a href="https://github.com/ipfs/js-ipfs">(js-) IPFS</a> | active |: A peer-to-peer hypermedia protocol
designed to make the web faster, safer, and more open.</li>
<li>[ ] <a href="https://github.com/ml5js/ml5-library">ML5.js</a> | tested |: Friendly &amp; easy to use machine learning for the web!</li>
<li>[ ] <a href="https://github.com/tensorflow">TensorFlow</a> | new |: Open Source Machine Learning Framework (With extensive docs and big community)</li>
<li>[ ] <a href="https://github.com/denoland/deno">deno</a> | testing |: Deno aims to provide a productive and secure scripting environment for the modern programmer. It is built on top of V8, Rust, and TypeScript.</li>
<li>[x] <a href="https://github.com/pnpm/pnpm">PNPM</a> | testing |: Faster, disk space efficient package manager, with good monorepo support.</li>
<li>[ ] <a href="https://verdaccio.org/">verdaccio</a> | new |: A lightweight open source private npm proxy registry</li>
<li>[ ] <a href="https://github.com/caprover/caprover">caprover</a> | new |: Easiest app/database deployment platform and webserver package for your NodeJS, Python, PHP, Ruby, Go applications. No Docker, nginx knowledge required!</li>
</ul>
<h2 id="misctools">misc Tools</h2>
<ul>
<li>[x] <a href="https://thehackerblog.com/galvanizer/">Chrome Galvanizer</a> | tested |: Harden your Chrome browser via enterprise policy.</li>
<li>[ ] <a href="https://github.com/mandatoryprogrammer/CursedChrome">Cursed Chrome</a> | new |: Chrome-extension implant that turns victim Chrome browsers into fully-functional HTTP proxies, allowing you to browse sites as your victims.</li>
<li>[x] <a href="https://github.com/nmap/nmap">NMAP</a> | active |: The #1 network scanner &amp; mapper</li>
<li>[x] <a href="https://github.com/vulnersCom/nmap-vulners">nmap-vulners</a> | active |: extension to NMAP that chekcs for more known vulns</li>
<li>[ ] <a href="https://github.com/lesspass/lesspass">lesspass</a> | new |: stateless open source password manager</li>
<li>[ ] <a href="https://grantproxy.com/">GrantProxy</a> | new |: Turn your web browser into a magic proxy server in one click.</li>
<li>[ ] <a href="https://github.com/ohmyzsh/ohmyzsh">ohmyzsh</a> | new |: A delightful community-driven framework for managing your zsh configuration. Includes 200+ plugins</li>
</ul>
<h1 id="sickguides">sickGuides</h1>
<p>a collection of useful guides or tutorials to stay safe.</p>
<h2 id="securityguides">Security Guides</h2>
<ul>
<li>[x] <a href="https://cheatsheetseries.owasp.org/">OWASP Cheat Sheets</a> | active |: These cheat sheets were created by various application security professionals who have expertise in specific topics.</li>
<li>[ ] <a href="https://portswigger.net/web-security/cross-site-scripting/cheat-sheet">PortSwigger XSS CheatSheet</a> | active |: An extensive list of known XSS vulns, sortable and searchable</li>
</ul>
<h2 id="devguides">Dev Guides</h2>
<ul>
<li>[ ] <a href="https://htmlhead.dev/">HTMLHEAD.dev</a> : A free guide to HTML5 <head> elements</li>
<li>[ ] <a href="https://css-tricks.com/snippets/css/a-guide-to-flexbox/">CSS FlexBox Cheatsheet</a> | active |: the only CSS flexbox cheatsheet you'll need</li>
<li>[x] <a href="https://devdocs.io/">DevDocs.io</a> | active |: Huge, fast, searchable reporsitory for dev documentation, from java to docker, from rust to WordPress.</li>
<li>[ ] <a href="https://blog.bitsrc.io/how-to-set-up-a-private-npm-registry-locally-1065e6790796">Set Up a Private NPM Registry Locally</a> | tested |: using verdaccio to setup local NPM registry.</li>
<li>[ ] <a href="https://www.codegrepper.com/index.php">Grepper</a> | new |: Accrue code answers to common coding problems, find code answers without thinking - using Greppers “code problem” search engine.</li>
</ul>
<h3 id="sources">Sources</h3>
<ul>
<li><a href="https://owasp.org/"><code>OWASP</code></a> — The Open Source Web Application Security Protocol</li>
<li><a href="https://github.com/mandatoryprogrammer/"><code>Matthew Bryant</code></a> — XSSHunter / chrome galvanizer</li>
<li><a href="https://skills.rendered.ch"><code>lwlx</code></a> — lwlx</li>
</ul>
<h2 id="license">License</h2>
<p><a href="LICENSE">The MIT License</a>.</p>]]></description><link>https://dev.lwlx.xyz/blog/blog/Sick-Security-and-Dev-Tools</link><guid isPermaLink="true">https://dev.lwlx.xyz/blog/blog/Sick-Security-and-Dev-Tools</guid><category><![CDATA[tools]]></category><category><![CDATA[devtools]]></category><category><![CDATA[security]]></category><category><![CDATA[javascript]]></category><category><![CDATA[devops]]></category><dc:creator><![CDATA[lwlx]]></dc:creator><pubDate>Thu, 29 Oct 2020 10:26:43 GMT</pubDate></item></channel></rss>